import{$ as Ye,A as wp,Aa as xs,B as Wn,C as _p,D as bp,E as Ep,F as Ic,G as xc,H as jr,I as ji,J as Ip,K as xp,L as Jn,M as At,N as Qt,O as Ue,P as Yn,Q as Pp,R as Sp,S as Xn,T as Is,U as Pc,V as Rp,W as Op,X as Sc,Y as Ui,_ as V,a as JE,aa as vr,b as sp,ba as zi,c as np,ca as Zt,d as op,da as Ur,e as Vn,ea as Tp,f as Fi,fa as Ap,g as qi,ga as Cp,h as Mi,ha as Np,i as Es,ia as Dp,j as ap,ja as Lp,k as cp,ka as Qn,l as up,la as Fp,m as Kn,ma as qp,n as hp,na as Mp,o as Gn,oa as ht,p as lp,pa as jp,q as fp,qa as Up,r as Mr,ra as zp,s as pp,sa as $p,t as dp,ta as Rc,u as gp,ua as Hp,v as bc,va as kp,w as yp,wa as Oc,x as mp,xa as Bp,y as Ec,ya as Tc,z as vp,za as Vp}from"./chunk-3YUWJCCP.js";import{a as mr}from"./chunk-5IV5XR7X.js";import{a as ke,e as _c,f as Je,g as Bn,h as Tt,i as je,j as yr,l as g}from"./chunk-PWCKSV3D.js";var tr,sd=_c(()=>{"use strict";tr=class{}});var nd={};Bn(nd,{IEvents:()=>tr});var Mc=_c(()=>{"use strict";sd()});var od=Je(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});to.IHeartBeat=void 0;var mI=(Mc(),yr(nd)),jc=class extends mI.IEvents{constructor(t){super()}};to.IHeartBeat=jc});var zc=Je(Uc=>{"use strict";Object.defineProperty(Uc,"__esModule",{value:!0});var vI=(Mi(),yr(qi));vI.__exportStar(od(),Uc)});var ad=Je($i=>{"use strict";Object.defineProperty($i,"__esModule",{value:!0});$i.HEARTBEAT_EVENTS=$i.HEARTBEAT_INTERVAL=void 0;var wI=Es();$i.HEARTBEAT_INTERVAL=wI.FIVE_SECONDS;$i.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"}});var Hc=Je($c=>{"use strict";Object.defineProperty($c,"__esModule",{value:!0});var _I=(Mi(),yr(qi));_I.__exportStar(ad(),$c)});var cd=Je(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});ro.HeartBeat=void 0;var kc=(Mi(),yr(qi)),bI=mr(),EI=Es(),II=zc(),Bc=Hc(),Vc=class n extends II.IHeartBeat{constructor(t){super(t),this.events=new bI.EventEmitter,this.interval=Bc.HEARTBEAT_INTERVAL,this.interval=t?.interval||Bc.HEARTBEAT_INTERVAL}static init(t){return kc.__awaiter(this,void 0,void 0,function*(){let r=new n(t);return yield r.init(),r})}init(){return kc.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}initialize(){return kc.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),EI.toMiliseconds(this.interval))})}pulse(){this.events.emit(Bc.HEARTBEAT_EVENTS.pulse)}};ro.HeartBeat=Vc});var ud=Je(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});var Kc=(Mi(),yr(qi));Kc.__exportStar(cd(),Ts);Kc.__exportStar(zc(),Ts);Kc.__exportStar(Hc(),Ts)});var ld=Je((yO,hd)=>{"use strict";function xI(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}hd.exports=PI;function PI(n,t,r){var s=r&&r.stringify||xI,o=1;if(typeof n=="object"&&n!==null){var u=t.length+o;if(u===1)return n;var l=new Array(u);l[0]=s(n);for(var d=1;d<u;d++)l[d]=s(t[d]);return l.join(" ")}if(typeof n!="string")return n;var v=t.length;if(v===0)return n;for(var b="",y=1-o,_=-1,P=n&&n.length||0,S=0;S<P;){if(n.charCodeAt(S)===37&&S+1<P){switch(_=_>-1?_:0,n.charCodeAt(S+1)){case 100:case 102:if(y>=v||t[y]==null)break;_<S&&(b+=n.slice(_,S)),b+=Number(t[y]),_=S+2,S++;break;case 105:if(y>=v||t[y]==null)break;_<S&&(b+=n.slice(_,S)),b+=Math.floor(Number(t[y])),_=S+2,S++;break;case 79:case 111:case 106:if(y>=v||t[y]===void 0)break;_<S&&(b+=n.slice(_,S));var A=typeof t[y];if(A==="string"){b+="'"+t[y]+"'",_=S+2,S++;break}if(A==="function"){b+=t[y].name||"<anonymous>",_=S+2,S++;break}b+=s(t[y]),_=S+2,S++;break;case 115:if(y>=v)break;_<S&&(b+=n.slice(_,S)),b+=String(t[y]),_=S+2,S++;break;case 37:_<S&&(b+=n.slice(_,S)),b+="%",_=S+2,S++,y--;break}++y}++S}return _===-1?n:(_<P&&(b+=n.slice(_)),b)}});var yd=Je((mO,gd)=>{"use strict";var fd=ld();gd.exports=rr;var As=FI().console||{},SI={mapHttpRequest:io,mapHttpResponse:io,wrapRequestSerializer:Gc,wrapResponseSerializer:Gc,wrapErrorSerializer:Gc,req:io,res:io,err:CI};function RI(n,t){return Array.isArray(n)?n.filter(function(s){return s!=="!stdSerializers.err"}):n===!0?Object.keys(t):!1}function rr(n){n=n||{},n.browser=n.browser||{};let t=n.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");let r=n.browser.write||As;n.browser.write&&(n.browser.asObject=!0);let s=n.serializers||{},o=RI(n.browser.serialize,s),u=n.browser.serialize;Array.isArray(n.browser.serialize)&&n.browser.serialize.indexOf("!stdSerializers.err")>-1&&(u=!1);let l=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),n.enabled===!1&&(n.level="silent");let d=n.level||"info",v=Object.create(r);v.log||(v.log=Cs),Object.defineProperty(v,"levelVal",{get:y}),Object.defineProperty(v,"level",{get:_,set:P});let b={transmit:t,serialize:o,asObject:n.browser.asObject,levels:l,timestamp:NI(n)};v.levels=rr.levels,v.level=d,v.setMaxListeners=v.getMaxListeners=v.emit=v.addListener=v.on=v.prependListener=v.once=v.prependOnceListener=v.removeListener=v.removeAllListeners=v.listeners=v.listenerCount=v.eventNames=v.write=v.flush=Cs,v.serializers=s,v._serialize=o,v._stdErrSerialize=u,v.child=S,t&&(v._logEvent=Wc());function y(){return this.level==="silent"?1/0:this.levels.values[this.level]}function _(){return this._level}function P(A){if(A!=="silent"&&!this.levels.values[A])throw Error("unknown level "+A);this._level=A,Hi(b,v,"error","log"),Hi(b,v,"fatal","error"),Hi(b,v,"warn","error"),Hi(b,v,"info","log"),Hi(b,v,"debug","log"),Hi(b,v,"trace","log")}function S(A,M){if(!A)throw new Error("missing bindings for child Pino");M=M||{},o&&A.serializers&&(M.serializers=A.serializers);let q=M.serializers;if(o&&q){var B=Object.assign({},s,q),J=n.browser.serialize===!0?Object.keys(B):o;delete A.serializers,so([A],J,B,this._stdErrSerialize)}function H(z){this._childLevel=(z._childLevel|0)+1,this.error=ki(z,A,"error"),this.fatal=ki(z,A,"fatal"),this.warn=ki(z,A,"warn"),this.info=ki(z,A,"info"),this.debug=ki(z,A,"debug"),this.trace=ki(z,A,"trace"),B&&(this.serializers=B,this._serialize=J),t&&(this._logEvent=Wc([].concat(z._logEvent.bindings,A)))}return H.prototype=this,new H(this)}return v}rr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};rr.stdSerializers=SI;rr.stdTimeFunctions=Object.assign({},{nullTime:pd,epochTime:dd,unixTime:DI,isoTime:LI});function Hi(n,t,r,s){let o=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?Cs:o[r]?o[r]:As[r]||As[s]||Cs,OI(n,t,r)}function OI(n,t,r){!n.transmit&&t[r]===Cs||(t[r]=function(s){return function(){let u=n.timestamp(),l=new Array(arguments.length),d=Object.getPrototypeOf&&Object.getPrototypeOf(this)===As?As:this;for(var v=0;v<l.length;v++)l[v]=arguments[v];if(n.serialize&&!n.asObject&&so(l,this._serialize,this.serializers,this._stdErrSerialize),n.asObject?s.call(d,TI(this,r,l,u)):s.apply(d,l),n.transmit){let b=n.transmit.level||t.level,y=rr.levels.values[b],_=rr.levels.values[r];if(_<y)return;AI(this,{ts:u,methodLevel:r,methodValue:_,transmitLevel:b,transmitValue:rr.levels.values[n.transmit.level||t.level],send:n.transmit.send,val:t.levelVal},l)}}}(t[r]))}function TI(n,t,r,s){n._serialize&&so(r,n._serialize,n.serializers,n._stdErrSerialize);let o=r.slice(),u=o[0],l={};s&&(l.time=s),l.level=rr.levels.values[t];let d=(n._childLevel|0)+1;if(d<1&&(d=1),u!==null&&typeof u=="object"){for(;d--&&typeof o[0]=="object";)Object.assign(l,o.shift());u=o.length?fd(o.shift(),o):void 0}else typeof u=="string"&&(u=fd(o.shift(),o));return u!==void 0&&(l.msg=u),l}function so(n,t,r,s){for(let o in n)if(s&&n[o]instanceof Error)n[o]=rr.stdSerializers.err(n[o]);else if(typeof n[o]=="object"&&!Array.isArray(n[o]))for(let u in n[o])t&&t.indexOf(u)>-1&&u in r&&(n[o][u]=r[u](n[o][u]))}function ki(n,t,r){return function(){let s=new Array(1+arguments.length);s[0]=t;for(var o=1;o<s.length;o++)s[o]=arguments[o-1];return n[r].apply(this,s)}}function AI(n,t,r){let s=t.send,o=t.ts,u=t.methodLevel,l=t.methodValue,d=t.val,v=n._logEvent.bindings;so(r,n._serialize||Object.keys(n.serializers),n.serializers,n._stdErrSerialize===void 0?!0:n._stdErrSerialize),n._logEvent.ts=o,n._logEvent.messages=r.filter(function(b){return v.indexOf(b)===-1}),n._logEvent.level.label=u,n._logEvent.level.value=l,s(u,n._logEvent,d),n._logEvent=Wc(v)}function Wc(n){return{ts:0,messages:[],bindings:n||[],level:{label:"",value:0}}}function CI(n){let t={type:n.constructor.name,msg:n.message,stack:n.stack};for(let r in n)t[r]===void 0&&(t[r]=n[r]);return t}function NI(n){return typeof n.timestamp=="function"?n.timestamp:n.timestamp===!1?pd:dd}function io(){return{}}function Gc(n){return n}function Cs(){}function pd(){return!1}function dd(){return Date.now()}function DI(){return Math.round(Date.now()/1e3)}function LI(){return new Date(Date.now()).toISOString()}function FI(){function n(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return n(self)||n(window)||n(this)||{}}}});var Jc=Je(Bi=>{"use strict";Object.defineProperty(Bi,"__esModule",{value:!0});Bi.PINO_CUSTOM_CONTEXT_KEY=Bi.PINO_LOGGER_DEFAULTS=void 0;Bi.PINO_LOGGER_DEFAULTS={level:"info"};Bi.PINO_CUSTOM_CONTEXT_KEY="custom_context"});var bd=Je(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.generateChildLogger=bt.formatChildLoggerContext=bt.getLoggerContext=bt.setBrowserLoggerContext=bt.getBrowserLoggerContext=bt.getDefaultLoggerOptions=void 0;var Vi=Jc();function qI(n){return Object.assign(Object.assign({},n),{level:n?.level||Vi.PINO_LOGGER_DEFAULTS.level})}bt.getDefaultLoggerOptions=qI;function md(n,t=Vi.PINO_CUSTOM_CONTEXT_KEY){return n[t]||""}bt.getBrowserLoggerContext=md;function vd(n,t,r=Vi.PINO_CUSTOM_CONTEXT_KEY){return n[r]=t,n}bt.setBrowserLoggerContext=vd;function wd(n,t=Vi.PINO_CUSTOM_CONTEXT_KEY){let r="";return typeof n.bindings>"u"?r=md(n,t):r=n.bindings().context||"",r}bt.getLoggerContext=wd;function _d(n,t,r=Vi.PINO_CUSTOM_CONTEXT_KEY){let s=wd(n,r);return s.trim()?`${s}/${t}`:t}bt.formatChildLoggerContext=_d;function MI(n,t,r=Vi.PINO_CUSTOM_CONTEXT_KEY){let s=_d(n,t,r),o=n.child({context:s});return vd(o,s,r)}bt.generateChildLogger=MI});var no=Je(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});Ki.pino=void 0;var Yc=(Mi(),yr(qi)),jI=Yc.__importDefault(yd());Object.defineProperty(Ki,"pino",{enumerable:!0,get:function(){return jI.default}});Yc.__exportStar(Jc(),Ki);Yc.__exportStar(bd(),Ki)});var Pd=Je(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});var Wi=JE(),Gi=sp();wr.DIGEST_LENGTH=64;wr.BLOCK_SIZE=128;var xd=function(){function n(){this.digestLength=wr.DIGEST_LENGTH,this.blockSize=wr.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return n.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},n.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},n.prototype.clean=function(){Gi.wipe(this._buffer),Gi.wipe(this._tempHi),Gi.wipe(this._tempLo),this.reset()},n.prototype.update=function(t,r){if(r===void 0&&(r=t.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var s=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<wr.BLOCK_SIZE&&r>0;)this._buffer[this._bufferLength++]=t[s++],r--;this._bufferLength===this.blockSize&&(Xc(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(s=Xc(this._tempHi,this._tempLo,this._stateHi,this._stateLo,t,s,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=t[s++],r--;return this},n.prototype.finish=function(t){if(!this._finished){var r=this._bytesHashed,s=this._bufferLength,o=r/536870912|0,u=r<<3,l=r%128<112?128:256;this._buffer[s]=128;for(var d=s+1;d<l-8;d++)this._buffer[d]=0;Wi.writeUint32BE(o,this._buffer,l-8),Wi.writeUint32BE(u,this._buffer,l-4),Xc(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,l),this._finished=!0}for(var d=0;d<this.digestLength/8;d++)Wi.writeUint32BE(this._stateHi[d],t,d*8),Wi.writeUint32BE(this._stateLo[d],t,d*8+4);return this},n.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},n.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},n.prototype.restoreState=function(t){return this._stateHi.set(t.stateHi),this._stateLo.set(t.stateLo),this._bufferLength=t.bufferLength,t.buffer&&this._buffer.set(t.buffer),this._bytesHashed=t.bytesHashed,this._finished=!1,this},n.prototype.cleanSavedState=function(t){Gi.wipe(t.stateHi),Gi.wipe(t.stateLo),t.buffer&&Gi.wipe(t.buffer),t.bufferLength=0,t.bytesHashed=0},n}();wr.SHA512=xd;var Id=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function Xc(n,t,r,s,o,u,l){for(var d=r[0],v=r[1],b=r[2],y=r[3],_=r[4],P=r[5],S=r[6],A=r[7],M=s[0],q=s[1],B=s[2],J=s[3],H=s[4],z=s[5],ee=s[6],se=s[7],T,N,re,x,R,D,U,$;l>=128;){for(var X=0;X<16;X++){var we=8*X+u;n[X]=Wi.readUint32BE(o,we),t[X]=Wi.readUint32BE(o,we+4)}for(var X=0;X<80;X++){var Be=d,tt=v,wi=b,Pe=y,me=_,Ve=P,Ke=S,ze=A,Se=M,De=q,Ge=B,Ie=J,Te=H,We=z,Le=ee,Ae=se;if(T=A,N=se,R=N&65535,D=N>>>16,U=T&65535,$=T>>>16,T=(_>>>14|H<<18)^(_>>>18|H<<14)^(H>>>9|_<<23),N=(H>>>14|_<<18)^(H>>>18|_<<14)^(_>>>9|H<<23),R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,T=_&P^~_&S,N=H&z^~H&ee,R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,T=Id[X*2],N=Id[X*2+1],R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,T=n[X%16],N=t[X%16],R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,D+=R>>>16,U+=D>>>16,$+=U>>>16,re=U&65535|$<<16,x=R&65535|D<<16,T=re,N=x,R=N&65535,D=N>>>16,U=T&65535,$=T>>>16,T=(d>>>28|M<<4)^(M>>>2|d<<30)^(M>>>7|d<<25),N=(M>>>28|d<<4)^(d>>>2|M<<30)^(d>>>7|M<<25),R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,T=d&v^d&b^v&b,N=M&q^M&B^q&B,R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,D+=R>>>16,U+=D>>>16,$+=U>>>16,ze=U&65535|$<<16,Ae=R&65535|D<<16,T=Pe,N=Ie,R=N&65535,D=N>>>16,U=T&65535,$=T>>>16,T=re,N=x,R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,D+=R>>>16,U+=D>>>16,$+=U>>>16,Pe=U&65535|$<<16,Ie=R&65535|D<<16,v=Be,b=tt,y=wi,_=Pe,P=me,S=Ve,A=Ke,d=ze,q=Se,B=De,J=Ge,H=Ie,z=Te,ee=We,se=Le,M=Ae,X%16===15)for(var we=0;we<16;we++)T=n[we],N=t[we],R=N&65535,D=N>>>16,U=T&65535,$=T>>>16,T=n[(we+9)%16],N=t[(we+9)%16],R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,re=n[(we+1)%16],x=t[(we+1)%16],T=(re>>>1|x<<31)^(re>>>8|x<<24)^re>>>7,N=(x>>>1|re<<31)^(x>>>8|re<<24)^(x>>>7|re<<25),R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,re=n[(we+14)%16],x=t[(we+14)%16],T=(re>>>19|x<<13)^(x>>>29|re<<3)^re>>>6,N=(x>>>19|re<<13)^(re>>>29|x<<3)^(x>>>6|re<<26),R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,D+=R>>>16,U+=D>>>16,$+=U>>>16,n[we]=U&65535|$<<16,t[we]=R&65535|D<<16}T=d,N=M,R=N&65535,D=N>>>16,U=T&65535,$=T>>>16,T=r[0],N=s[0],R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,D+=R>>>16,U+=D>>>16,$+=U>>>16,r[0]=d=U&65535|$<<16,s[0]=M=R&65535|D<<16,T=v,N=q,R=N&65535,D=N>>>16,U=T&65535,$=T>>>16,T=r[1],N=s[1],R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,D+=R>>>16,U+=D>>>16,$+=U>>>16,r[1]=v=U&65535|$<<16,s[1]=q=R&65535|D<<16,T=b,N=B,R=N&65535,D=N>>>16,U=T&65535,$=T>>>16,T=r[2],N=s[2],R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,D+=R>>>16,U+=D>>>16,$+=U>>>16,r[2]=b=U&65535|$<<16,s[2]=B=R&65535|D<<16,T=y,N=J,R=N&65535,D=N>>>16,U=T&65535,$=T>>>16,T=r[3],N=s[3],R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,D+=R>>>16,U+=D>>>16,$+=U>>>16,r[3]=y=U&65535|$<<16,s[3]=J=R&65535|D<<16,T=_,N=H,R=N&65535,D=N>>>16,U=T&65535,$=T>>>16,T=r[4],N=s[4],R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,D+=R>>>16,U+=D>>>16,$+=U>>>16,r[4]=_=U&65535|$<<16,s[4]=H=R&65535|D<<16,T=P,N=z,R=N&65535,D=N>>>16,U=T&65535,$=T>>>16,T=r[5],N=s[5],R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,D+=R>>>16,U+=D>>>16,$+=U>>>16,r[5]=P=U&65535|$<<16,s[5]=z=R&65535|D<<16,T=S,N=ee,R=N&65535,D=N>>>16,U=T&65535,$=T>>>16,T=r[6],N=s[6],R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,D+=R>>>16,U+=D>>>16,$+=U>>>16,r[6]=S=U&65535|$<<16,s[6]=ee=R&65535|D<<16,T=A,N=se,R=N&65535,D=N>>>16,U=T&65535,$=T>>>16,T=r[7],N=s[7],R+=N&65535,D+=N>>>16,U+=T&65535,$+=T>>>16,D+=R>>>16,U+=D>>>16,$+=U>>>16,r[7]=A=U&65535|$<<16,s[7]=se=R&65535|D<<16,u+=128,l-=128}return u}function UI(n){var t=new xd;t.update(n);var r=t.digest();return t.clean(),r}wr.hash=UI});var Ud=Je(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.convertSecretKeyToX25519=ye.convertPublicKeyToX25519=ye.verify=ye.sign=ye.extractPublicKeyFromSecretKey=ye.generateKeyPair=ye.generateKeyPairFromSeed=ye.SEED_LENGTH=ye.SECRET_KEY_LENGTH=ye.PUBLIC_KEY_LENGTH=ye.SIGNATURE_LENGTH=void 0;var zI=np(),Ns=Pd(),Ad=sp();ye.SIGNATURE_LENGTH=64;ye.PUBLIC_KEY_LENGTH=32;ye.SECRET_KEY_LENGTH=64;ye.SEED_LENGTH=32;function W(n){let t=new Float64Array(16);if(n)for(let r=0;r<n.length;r++)t[r]=n[r];return t}var $I=new Uint8Array(32);$I[0]=9;var eu=W(),Ji=W([1]),HI=W([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),kI=W([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),Sd=W([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Rd=W([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),BI=W([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function zr(n,t){for(let r=0;r<16;r++)n[r]=t[r]|0}function Qc(n){let t=1;for(let r=0;r<16;r++){let s=n[r]+t+65535;t=Math.floor(s/65536),n[r]=s-t*65536}n[0]+=t-1+37*(t-1)}function Cd(n,t,r){let s=~(r-1);for(let o=0;o<16;o++){let u=s&(n[o]^t[o]);n[o]^=u,t[o]^=u}}function Ds(n,t){let r=W(),s=W();for(let o=0;o<16;o++)s[o]=t[o];Qc(s),Qc(s),Qc(s);for(let o=0;o<2;o++){r[0]=s[0]-65517;for(let l=1;l<15;l++)r[l]=s[l]-65535-(r[l-1]>>16&1),r[l-1]&=65535;r[15]=s[15]-32767-(r[14]>>16&1);let u=r[15]>>16&1;r[14]&=65535,Cd(s,r,1-u)}for(let o=0;o<16;o++)n[2*o]=s[o]&255,n[2*o+1]=s[o]>>8}function Nd(n,t){let r=0;for(let s=0;s<32;s++)r|=n[s]^t[s];return(1&r-1>>>8)-1}function Od(n,t){let r=new Uint8Array(32),s=new Uint8Array(32);return Ds(r,n),Ds(s,t),Nd(r,s)}function Dd(n){let t=new Uint8Array(32);return Ds(t,n),t[0]&1}function VI(n,t){for(let r=0;r<16;r++)n[r]=t[2*r]+(t[2*r+1]<<8);n[15]&=32767}function ci(n,t,r){for(let s=0;s<16;s++)n[s]=t[s]+r[s]}function hi(n,t,r){for(let s=0;s<16;s++)n[s]=t[s]-r[s]}function be(n,t,r){let s,o,u=0,l=0,d=0,v=0,b=0,y=0,_=0,P=0,S=0,A=0,M=0,q=0,B=0,J=0,H=0,z=0,ee=0,se=0,T=0,N=0,re=0,x=0,R=0,D=0,U=0,$=0,X=0,we=0,Be=0,tt=0,wi=0,Pe=r[0],me=r[1],Ve=r[2],Ke=r[3],ze=r[4],Se=r[5],De=r[6],Ge=r[7],Ie=r[8],Te=r[9],We=r[10],Le=r[11],Ae=r[12],Xe=r[13],_e=r[14],qe=r[15];s=t[0],u+=s*Pe,l+=s*me,d+=s*Ve,v+=s*Ke,b+=s*ze,y+=s*Se,_+=s*De,P+=s*Ge,S+=s*Ie,A+=s*Te,M+=s*We,q+=s*Le,B+=s*Ae,J+=s*Xe,H+=s*_e,z+=s*qe,s=t[1],l+=s*Pe,d+=s*me,v+=s*Ve,b+=s*Ke,y+=s*ze,_+=s*Se,P+=s*De,S+=s*Ge,A+=s*Ie,M+=s*Te,q+=s*We,B+=s*Le,J+=s*Ae,H+=s*Xe,z+=s*_e,ee+=s*qe,s=t[2],d+=s*Pe,v+=s*me,b+=s*Ve,y+=s*Ke,_+=s*ze,P+=s*Se,S+=s*De,A+=s*Ge,M+=s*Ie,q+=s*Te,B+=s*We,J+=s*Le,H+=s*Ae,z+=s*Xe,ee+=s*_e,se+=s*qe,s=t[3],v+=s*Pe,b+=s*me,y+=s*Ve,_+=s*Ke,P+=s*ze,S+=s*Se,A+=s*De,M+=s*Ge,q+=s*Ie,B+=s*Te,J+=s*We,H+=s*Le,z+=s*Ae,ee+=s*Xe,se+=s*_e,T+=s*qe,s=t[4],b+=s*Pe,y+=s*me,_+=s*Ve,P+=s*Ke,S+=s*ze,A+=s*Se,M+=s*De,q+=s*Ge,B+=s*Ie,J+=s*Te,H+=s*We,z+=s*Le,ee+=s*Ae,se+=s*Xe,T+=s*_e,N+=s*qe,s=t[5],y+=s*Pe,_+=s*me,P+=s*Ve,S+=s*Ke,A+=s*ze,M+=s*Se,q+=s*De,B+=s*Ge,J+=s*Ie,H+=s*Te,z+=s*We,ee+=s*Le,se+=s*Ae,T+=s*Xe,N+=s*_e,re+=s*qe,s=t[6],_+=s*Pe,P+=s*me,S+=s*Ve,A+=s*Ke,M+=s*ze,q+=s*Se,B+=s*De,J+=s*Ge,H+=s*Ie,z+=s*Te,ee+=s*We,se+=s*Le,T+=s*Ae,N+=s*Xe,re+=s*_e,x+=s*qe,s=t[7],P+=s*Pe,S+=s*me,A+=s*Ve,M+=s*Ke,q+=s*ze,B+=s*Se,J+=s*De,H+=s*Ge,z+=s*Ie,ee+=s*Te,se+=s*We,T+=s*Le,N+=s*Ae,re+=s*Xe,x+=s*_e,R+=s*qe,s=t[8],S+=s*Pe,A+=s*me,M+=s*Ve,q+=s*Ke,B+=s*ze,J+=s*Se,H+=s*De,z+=s*Ge,ee+=s*Ie,se+=s*Te,T+=s*We,N+=s*Le,re+=s*Ae,x+=s*Xe,R+=s*_e,D+=s*qe,s=t[9],A+=s*Pe,M+=s*me,q+=s*Ve,B+=s*Ke,J+=s*ze,H+=s*Se,z+=s*De,ee+=s*Ge,se+=s*Ie,T+=s*Te,N+=s*We,re+=s*Le,x+=s*Ae,R+=s*Xe,D+=s*_e,U+=s*qe,s=t[10],M+=s*Pe,q+=s*me,B+=s*Ve,J+=s*Ke,H+=s*ze,z+=s*Se,ee+=s*De,se+=s*Ge,T+=s*Ie,N+=s*Te,re+=s*We,x+=s*Le,R+=s*Ae,D+=s*Xe,U+=s*_e,$+=s*qe,s=t[11],q+=s*Pe,B+=s*me,J+=s*Ve,H+=s*Ke,z+=s*ze,ee+=s*Se,se+=s*De,T+=s*Ge,N+=s*Ie,re+=s*Te,x+=s*We,R+=s*Le,D+=s*Ae,U+=s*Xe,$+=s*_e,X+=s*qe,s=t[12],B+=s*Pe,J+=s*me,H+=s*Ve,z+=s*Ke,ee+=s*ze,se+=s*Se,T+=s*De,N+=s*Ge,re+=s*Ie,x+=s*Te,R+=s*We,D+=s*Le,U+=s*Ae,$+=s*Xe,X+=s*_e,we+=s*qe,s=t[13],J+=s*Pe,H+=s*me,z+=s*Ve,ee+=s*Ke,se+=s*ze,T+=s*Se,N+=s*De,re+=s*Ge,x+=s*Ie,R+=s*Te,D+=s*We,U+=s*Le,$+=s*Ae,X+=s*Xe,we+=s*_e,Be+=s*qe,s=t[14],H+=s*Pe,z+=s*me,ee+=s*Ve,se+=s*Ke,T+=s*ze,N+=s*Se,re+=s*De,x+=s*Ge,R+=s*Ie,D+=s*Te,U+=s*We,$+=s*Le,X+=s*Ae,we+=s*Xe,Be+=s*_e,tt+=s*qe,s=t[15],z+=s*Pe,ee+=s*me,se+=s*Ve,T+=s*Ke,N+=s*ze,re+=s*Se,x+=s*De,R+=s*Ge,D+=s*Ie,U+=s*Te,$+=s*We,X+=s*Le,we+=s*Ae,Be+=s*Xe,tt+=s*_e,wi+=s*qe,u+=38*ee,l+=38*se,d+=38*T,v+=38*N,b+=38*re,y+=38*x,_+=38*R,P+=38*D,S+=38*U,A+=38*$,M+=38*X,q+=38*we,B+=38*Be,J+=38*tt,H+=38*wi,o=1,s=u+o+65535,o=Math.floor(s/65536),u=s-o*65536,s=l+o+65535,o=Math.floor(s/65536),l=s-o*65536,s=d+o+65535,o=Math.floor(s/65536),d=s-o*65536,s=v+o+65535,o=Math.floor(s/65536),v=s-o*65536,s=b+o+65535,o=Math.floor(s/65536),b=s-o*65536,s=y+o+65535,o=Math.floor(s/65536),y=s-o*65536,s=_+o+65535,o=Math.floor(s/65536),_=s-o*65536,s=P+o+65535,o=Math.floor(s/65536),P=s-o*65536,s=S+o+65535,o=Math.floor(s/65536),S=s-o*65536,s=A+o+65535,o=Math.floor(s/65536),A=s-o*65536,s=M+o+65535,o=Math.floor(s/65536),M=s-o*65536,s=q+o+65535,o=Math.floor(s/65536),q=s-o*65536,s=B+o+65535,o=Math.floor(s/65536),B=s-o*65536,s=J+o+65535,o=Math.floor(s/65536),J=s-o*65536,s=H+o+65535,o=Math.floor(s/65536),H=s-o*65536,s=z+o+65535,o=Math.floor(s/65536),z=s-o*65536,u+=o-1+37*(o-1),o=1,s=u+o+65535,o=Math.floor(s/65536),u=s-o*65536,s=l+o+65535,o=Math.floor(s/65536),l=s-o*65536,s=d+o+65535,o=Math.floor(s/65536),d=s-o*65536,s=v+o+65535,o=Math.floor(s/65536),v=s-o*65536,s=b+o+65535,o=Math.floor(s/65536),b=s-o*65536,s=y+o+65535,o=Math.floor(s/65536),y=s-o*65536,s=_+o+65535,o=Math.floor(s/65536),_=s-o*65536,s=P+o+65535,o=Math.floor(s/65536),P=s-o*65536,s=S+o+65535,o=Math.floor(s/65536),S=s-o*65536,s=A+o+65535,o=Math.floor(s/65536),A=s-o*65536,s=M+o+65535,o=Math.floor(s/65536),M=s-o*65536,s=q+o+65535,o=Math.floor(s/65536),q=s-o*65536,s=B+o+65535,o=Math.floor(s/65536),B=s-o*65536,s=J+o+65535,o=Math.floor(s/65536),J=s-o*65536,s=H+o+65535,o=Math.floor(s/65536),H=s-o*65536,s=z+o+65535,o=Math.floor(s/65536),z=s-o*65536,u+=o-1+37*(o-1),n[0]=u,n[1]=l,n[2]=d,n[3]=v,n[4]=b,n[5]=y,n[6]=_,n[7]=P,n[8]=S,n[9]=A,n[10]=M,n[11]=q,n[12]=B,n[13]=J,n[14]=H,n[15]=z}function ui(n,t){be(n,t,t)}function Ld(n,t){let r=W(),s;for(s=0;s<16;s++)r[s]=t[s];for(s=253;s>=0;s--)ui(r,r),s!==2&&s!==4&&be(r,r,t);for(s=0;s<16;s++)n[s]=r[s]}function KI(n,t){let r=W(),s;for(s=0;s<16;s++)r[s]=t[s];for(s=250;s>=0;s--)ui(r,r),s!==1&&be(r,r,t);for(s=0;s<16;s++)n[s]=r[s]}function tu(n,t){let r=W(),s=W(),o=W(),u=W(),l=W(),d=W(),v=W(),b=W(),y=W();hi(r,n[1],n[0]),hi(y,t[1],t[0]),be(r,r,y),ci(s,n[0],n[1]),ci(y,t[0],t[1]),be(s,s,y),be(o,n[3],t[3]),be(o,o,kI),be(u,n[2],t[2]),ci(u,u,u),hi(l,s,r),hi(d,u,o),ci(v,u,o),ci(b,s,r),be(n[0],l,d),be(n[1],b,v),be(n[2],v,d),be(n[3],l,b)}function Td(n,t,r){for(let s=0;s<4;s++)Cd(n[s],t[s],r)}function iu(n,t){let r=W(),s=W(),o=W();Ld(o,t[2]),be(r,t[0],o),be(s,t[1],o),Ds(n,s),n[31]^=Dd(r)<<7}function Fd(n,t,r){zr(n[0],eu),zr(n[1],Ji),zr(n[2],Ji),zr(n[3],eu);for(let s=255;s>=0;--s){let o=r[s/8|0]>>(s&7)&1;Td(n,t,o),tu(t,n),tu(n,n),Td(n,t,o)}}function su(n,t){let r=[W(),W(),W(),W()];zr(r[0],Sd),zr(r[1],Rd),zr(r[2],Ji),be(r[3],Sd,Rd),Fd(n,r,t)}function qd(n){if(n.length!==ye.SEED_LENGTH)throw new Error(`ed25519: seed must be ${ye.SEED_LENGTH} bytes`);let t=(0,Ns.hash)(n);t[0]&=248,t[31]&=127,t[31]|=64;let r=new Uint8Array(32),s=[W(),W(),W(),W()];su(s,t),iu(r,s);let o=new Uint8Array(64);return o.set(n),o.set(r,32),{publicKey:r,secretKey:o}}ye.generateKeyPairFromSeed=qd;function GI(n){let t=(0,zI.randomBytes)(32,n),r=qd(t);return(0,Ad.wipe)(t),r}ye.generateKeyPair=GI;function WI(n){if(n.length!==ye.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${ye.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(n.subarray(32))}ye.extractPublicKeyFromSecretKey=WI;var Zc=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Md(n,t){let r,s,o,u;for(s=63;s>=32;--s){for(r=0,o=s-32,u=s-12;o<u;++o)t[o]+=r-16*t[s]*Zc[o-(s-32)],r=Math.floor((t[o]+128)/256),t[o]-=r*256;t[o]+=r,t[s]=0}for(r=0,o=0;o<32;o++)t[o]+=r-(t[31]>>4)*Zc[o],r=t[o]>>8,t[o]&=255;for(o=0;o<32;o++)t[o]-=r*Zc[o];for(s=0;s<32;s++)t[s+1]+=t[s]>>8,n[s]=t[s]&255}function ru(n){let t=new Float64Array(64);for(let r=0;r<64;r++)t[r]=n[r];for(let r=0;r<64;r++)n[r]=0;Md(n,t)}function JI(n,t){let r=new Float64Array(64),s=[W(),W(),W(),W()],o=(0,Ns.hash)(n.subarray(0,32));o[0]&=248,o[31]&=127,o[31]|=64;let u=new Uint8Array(64);u.set(o.subarray(32),32);let l=new Ns.SHA512;l.update(u.subarray(32)),l.update(t);let d=l.digest();l.clean(),ru(d),su(s,d),iu(u,s),l.reset(),l.update(u.subarray(0,32)),l.update(n.subarray(32)),l.update(t);let v=l.digest();ru(v);for(let b=0;b<32;b++)r[b]=d[b];for(let b=0;b<32;b++)for(let y=0;y<32;y++)r[b+y]+=v[b]*o[y];return Md(u.subarray(32),r),u}ye.sign=JI;function jd(n,t){let r=W(),s=W(),o=W(),u=W(),l=W(),d=W(),v=W();return zr(n[2],Ji),VI(n[1],t),ui(o,n[1]),be(u,o,HI),hi(o,o,n[2]),ci(u,n[2],u),ui(l,u),ui(d,l),be(v,d,l),be(r,v,o),be(r,r,u),KI(r,r),be(r,r,o),be(r,r,u),be(r,r,u),be(n[0],r,u),ui(s,n[0]),be(s,s,u),Od(s,o)&&be(n[0],n[0],BI),ui(s,n[0]),be(s,s,u),Od(s,o)?-1:(Dd(n[0])===t[31]>>7&&hi(n[0],eu,n[0]),be(n[3],n[0],n[1]),0)}function YI(n,t,r){let s=new Uint8Array(32),o=[W(),W(),W(),W()],u=[W(),W(),W(),W()];if(r.length!==ye.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${ye.SIGNATURE_LENGTH} bytes`);if(jd(u,n))return!1;let l=new Ns.SHA512;l.update(r.subarray(0,32)),l.update(n),l.update(t);let d=l.digest();return ru(d),Fd(o,u,d),su(u,r.subarray(32)),tu(o,u),iu(s,o),!Nd(r,s)}ye.verify=YI;function XI(n){let t=[W(),W(),W(),W()];if(jd(t,n))throw new Error("Ed25519: invalid public key");let r=W(),s=W(),o=t[1];ci(r,Ji,o),hi(s,Ji,o),Ld(s,s),be(r,r,s);let u=new Uint8Array(32);return Ds(u,r),u}ye.convertPublicKeyToX25519=XI;function QI(n){let t=(0,Ns.hash)(n.subarray(0,32));t[0]&=248,t[31]&=127,t[31]|=64;let r=new Uint8Array(t.subarray(0,32));return(0,Ad.wipe)(t),r}ye.convertSecretKeyToX25519=QI});var og=Je(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.isBrowserCryptoAvailable=Hr.getSubtleCrypto=Hr.getBrowerCrypto=void 0;function hu(){return(global==null?void 0:global.crypto)||(global==null?void 0:global.msCrypto)||{}}Hr.getBrowerCrypto=hu;function ng(){let n=hu();return n.subtle||n.webkitSubtle}Hr.getSubtleCrypto=ng;function sx(){return!!hu()&&!!ng()}Hr.isBrowserCryptoAvailable=sx});var ug=Je(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.isBrowser=kr.isNode=kr.isReactNative=void 0;function ag(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}kr.isReactNative=ag;function cg(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}kr.isNode=cg;function nx(){return!ag()&&!cg()}kr.isBrowser=nx});var lu=Je(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});var hg=(Mi(),yr(qi));hg.__exportStar(og(),So);hg.__exportStar(ug(),So)});var mg=Je((RT,yg)=>{"use strict";yg.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var ty=Je(($s,Zi)=>{"use strict";var yx=200,Pu="__lodash_hash_undefined__",zo=1,Ng=2,Dg=9007199254740991,Do="[object Arguments]",vu="[object Array]",mx="[object AsyncFunction]",Lg="[object Boolean]",Fg="[object Date]",qg="[object Error]",Mg="[object Function]",vx="[object GeneratorFunction]",Lo="[object Map]",jg="[object Number]",wx="[object Null]",Qi="[object Object]",bg="[object Promise]",_x="[object Proxy]",Ug="[object RegExp]",Fo="[object Set]",zg="[object String]",bx="[object Symbol]",Ex="[object Undefined]",wu="[object WeakMap]",$g="[object ArrayBuffer]",qo="[object DataView]",Ix="[object Float32Array]",xx="[object Float64Array]",Px="[object Int8Array]",Sx="[object Int16Array]",Rx="[object Int32Array]",Ox="[object Uint8Array]",Tx="[object Uint8ClampedArray]",Ax="[object Uint16Array]",Cx="[object Uint32Array]",Nx=/[\\^$.*+?()[\]{}|]/g,Dx=/^\[object .+?Constructor\]$/,Lx=/^(?:0|[1-9]\d*)$/,Oe={};Oe[Ix]=Oe[xx]=Oe[Px]=Oe[Sx]=Oe[Rx]=Oe[Ox]=Oe[Tx]=Oe[Ax]=Oe[Cx]=!0;Oe[Do]=Oe[vu]=Oe[$g]=Oe[Lg]=Oe[qo]=Oe[Fg]=Oe[qg]=Oe[Mg]=Oe[Lo]=Oe[jg]=Oe[Qi]=Oe[Ug]=Oe[Fo]=Oe[zg]=Oe[wu]=!1;var Hg=typeof global=="object"&&global&&global.Object===Object&&global,Fx=typeof self=="object"&&self&&self.Object===Object&&self,br=Hg||Fx||Function("return this")(),kg=typeof $s=="object"&&$s&&!$s.nodeType&&$s,Eg=kg&&typeof Zi=="object"&&Zi&&!Zi.nodeType&&Zi,Bg=Eg&&Eg.exports===kg,gu=Bg&&Hg.process,Ig=function(){try{return gu&&gu.binding&&gu.binding("util")}catch{}}(),xg=Ig&&Ig.isTypedArray;function qx(n,t){for(var r=-1,s=n==null?0:n.length,o=0,u=[];++r<s;){var l=n[r];t(l,r,n)&&(u[o++]=l)}return u}function Mx(n,t){for(var r=-1,s=t.length,o=n.length;++r<s;)n[o+r]=t[r];return n}function jx(n,t){for(var r=-1,s=n==null?0:n.length;++r<s;)if(t(n[r],r,n))return!0;return!1}function Ux(n,t){for(var r=-1,s=Array(n);++r<n;)s[r]=t(r);return s}function zx(n){return function(t){return n(t)}}function $x(n,t){return n.has(t)}function Hx(n,t){return n?.[t]}function kx(n){var t=-1,r=Array(n.size);return n.forEach(function(s,o){r[++t]=[o,s]}),r}function Bx(n,t){return function(r){return n(t(r))}}function Vx(n){var t=-1,r=Array(n.size);return n.forEach(function(s){r[++t]=s}),r}var Kx=Array.prototype,Gx=Function.prototype,$o=Object.prototype,yu=br["__core-js_shared__"],Vg=Gx.toString,sr=$o.hasOwnProperty,Pg=function(){var n=/[^.]+$/.exec(yu&&yu.keys&&yu.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),Kg=$o.toString,Wx=RegExp("^"+Vg.call(sr).replace(Nx,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Sg=Bg?br.Buffer:void 0,Mo=br.Symbol,Rg=br.Uint8Array,Gg=$o.propertyIsEnumerable,Jx=Kx.splice,li=Mo?Mo.toStringTag:void 0,Og=Object.getOwnPropertySymbols,Yx=Sg?Sg.isBuffer:void 0,Xx=Bx(Object.keys,Object),_u=es(br,"DataView"),Hs=es(br,"Map"),bu=es(br,"Promise"),Eu=es(br,"Set"),Iu=es(br,"WeakMap"),ks=es(Object,"create"),Qx=di(_u),Zx=di(Hs),eP=di(bu),tP=di(Eu),rP=di(Iu),Tg=Mo?Mo.prototype:void 0,mu=Tg?Tg.valueOf:void 0;function fi(n){var t=-1,r=n==null?0:n.length;for(this.clear();++t<r;){var s=n[t];this.set(s[0],s[1])}}function iP(){this.__data__=ks?ks(null):{},this.size=0}function sP(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t}function nP(n){var t=this.__data__;if(ks){var r=t[n];return r===Pu?void 0:r}return sr.call(t,n)?t[n]:void 0}function oP(n){var t=this.__data__;return ks?t[n]!==void 0:sr.call(t,n)}function aP(n,t){var r=this.__data__;return this.size+=this.has(n)?0:1,r[n]=ks&&t===void 0?Pu:t,this}fi.prototype.clear=iP;fi.prototype.delete=sP;fi.prototype.get=nP;fi.prototype.has=oP;fi.prototype.set=aP;function Er(n){var t=-1,r=n==null?0:n.length;for(this.clear();++t<r;){var s=n[t];this.set(s[0],s[1])}}function cP(){this.__data__=[],this.size=0}function uP(n){var t=this.__data__,r=Ho(t,n);if(r<0)return!1;var s=t.length-1;return r==s?t.pop():Jx.call(t,r,1),--this.size,!0}function hP(n){var t=this.__data__,r=Ho(t,n);return r<0?void 0:t[r][1]}function lP(n){return Ho(this.__data__,n)>-1}function fP(n,t){var r=this.__data__,s=Ho(r,n);return s<0?(++this.size,r.push([n,t])):r[s][1]=t,this}Er.prototype.clear=cP;Er.prototype.delete=uP;Er.prototype.get=hP;Er.prototype.has=lP;Er.prototype.set=fP;function pi(n){var t=-1,r=n==null?0:n.length;for(this.clear();++t<r;){var s=n[t];this.set(s[0],s[1])}}function pP(){this.size=0,this.__data__={hash:new fi,map:new(Hs||Er),string:new fi}}function dP(n){var t=ko(this,n).delete(n);return this.size-=t?1:0,t}function gP(n){return ko(this,n).get(n)}function yP(n){return ko(this,n).has(n)}function mP(n,t){var r=ko(this,n),s=r.size;return r.set(n,t),this.size+=r.size==s?0:1,this}pi.prototype.clear=pP;pi.prototype.delete=dP;pi.prototype.get=gP;pi.prototype.has=yP;pi.prototype.set=mP;function jo(n){var t=-1,r=n==null?0:n.length;for(this.__data__=new pi;++t<r;)this.add(n[t])}function vP(n){return this.__data__.set(n,Pu),this}function wP(n){return this.__data__.has(n)}jo.prototype.add=jo.prototype.push=vP;jo.prototype.has=wP;function Gr(n){var t=this.__data__=new Er(n);this.size=t.size}function _P(){this.__data__=new Er,this.size=0}function bP(n){var t=this.__data__,r=t.delete(n);return this.size=t.size,r}function EP(n){return this.__data__.get(n)}function IP(n){return this.__data__.has(n)}function xP(n,t){var r=this.__data__;if(r instanceof Er){var s=r.__data__;if(!Hs||s.length<yx-1)return s.push([n,t]),this.size=++r.size,this;r=this.__data__=new pi(s)}return r.set(n,t),this.size=r.size,this}Gr.prototype.clear=_P;Gr.prototype.delete=bP;Gr.prototype.get=EP;Gr.prototype.has=IP;Gr.prototype.set=xP;function PP(n,t){var r=Uo(n),s=!r&&zP(n),o=!r&&!s&&xu(n),u=!r&&!s&&!o&&ey(n),l=r||s||o||u,d=l?Ux(n.length,String):[],v=d.length;for(var b in n)(t||sr.call(n,b))&&!(l&&(b=="length"||o&&(b=="offset"||b=="parent")||u&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||FP(b,v)))&&d.push(b);return d}function Ho(n,t){for(var r=n.length;r--;)if(Yg(n[r][0],t))return r;return-1}function SP(n,t,r){var s=t(n);return Uo(n)?s:Mx(s,r(n))}function Vs(n){return n==null?n===void 0?Ex:wx:li&&li in Object(n)?DP(n):UP(n)}function Ag(n){return Bs(n)&&Vs(n)==Do}function Wg(n,t,r,s,o){return n===t?!0:n==null||t==null||!Bs(n)&&!Bs(t)?n!==n&&t!==t:RP(n,t,r,s,Wg,o)}function RP(n,t,r,s,o,u){var l=Uo(n),d=Uo(t),v=l?vu:Kr(n),b=d?vu:Kr(t);v=v==Do?Qi:v,b=b==Do?Qi:b;var y=v==Qi,_=b==Qi,P=v==b;if(P&&xu(n)){if(!xu(t))return!1;l=!0,y=!1}if(P&&!y)return u||(u=new Gr),l||ey(n)?Jg(n,t,r,s,o,u):CP(n,t,v,r,s,o,u);if(!(r&zo)){var S=y&&sr.call(n,"__wrapped__"),A=_&&sr.call(t,"__wrapped__");if(S||A){var M=S?n.value():n,q=A?t.value():t;return u||(u=new Gr),o(M,q,r,s,u)}}return P?(u||(u=new Gr),NP(n,t,r,s,o,u)):!1}function OP(n){if(!Zg(n)||MP(n))return!1;var t=Xg(n)?Wx:Dx;return t.test(di(n))}function TP(n){return Bs(n)&&Qg(n.length)&&!!Oe[Vs(n)]}function AP(n){if(!jP(n))return Xx(n);var t=[];for(var r in Object(n))sr.call(n,r)&&r!="constructor"&&t.push(r);return t}function Jg(n,t,r,s,o,u){var l=r&zo,d=n.length,v=t.length;if(d!=v&&!(l&&v>d))return!1;var b=u.get(n);if(b&&u.get(t))return b==t;var y=-1,_=!0,P=r&Ng?new jo:void 0;for(u.set(n,t),u.set(t,n);++y<d;){var S=n[y],A=t[y];if(s)var M=l?s(A,S,y,t,n,u):s(S,A,y,n,t,u);if(M!==void 0){if(M)continue;_=!1;break}if(P){if(!jx(t,function(q,B){if(!$x(P,B)&&(S===q||o(S,q,r,s,u)))return P.push(B)})){_=!1;break}}else if(!(S===A||o(S,A,r,s,u))){_=!1;break}}return u.delete(n),u.delete(t),_}function CP(n,t,r,s,o,u,l){switch(r){case qo:if(n.byteLength!=t.byteLength||n.byteOffset!=t.byteOffset)return!1;n=n.buffer,t=t.buffer;case $g:return!(n.byteLength!=t.byteLength||!u(new Rg(n),new Rg(t)));case Lg:case Fg:case jg:return Yg(+n,+t);case qg:return n.name==t.name&&n.message==t.message;case Ug:case zg:return n==t+"";case Lo:var d=kx;case Fo:var v=s&zo;if(d||(d=Vx),n.size!=t.size&&!v)return!1;var b=l.get(n);if(b)return b==t;s|=Ng,l.set(n,t);var y=Jg(d(n),d(t),s,o,u,l);return l.delete(n),y;case bx:if(mu)return mu.call(n)==mu.call(t)}return!1}function NP(n,t,r,s,o,u){var l=r&zo,d=Cg(n),v=d.length,b=Cg(t),y=b.length;if(v!=y&&!l)return!1;for(var _=v;_--;){var P=d[_];if(!(l?P in t:sr.call(t,P)))return!1}var S=u.get(n);if(S&&u.get(t))return S==t;var A=!0;u.set(n,t),u.set(t,n);for(var M=l;++_<v;){P=d[_];var q=n[P],B=t[P];if(s)var J=l?s(B,q,P,t,n,u):s(q,B,P,n,t,u);if(!(J===void 0?q===B||o(q,B,r,s,u):J)){A=!1;break}M||(M=P=="constructor")}if(A&&!M){var H=n.constructor,z=t.constructor;H!=z&&"constructor"in n&&"constructor"in t&&!(typeof H=="function"&&H instanceof H&&typeof z=="function"&&z instanceof z)&&(A=!1)}return u.delete(n),u.delete(t),A}function Cg(n){return SP(n,kP,LP)}function ko(n,t){var r=n.__data__;return qP(t)?r[typeof t=="string"?"string":"hash"]:r.map}function es(n,t){var r=Hx(n,t);return OP(r)?r:void 0}function DP(n){var t=sr.call(n,li),r=n[li];try{n[li]=void 0;var s=!0}catch{}var o=Kg.call(n);return s&&(t?n[li]=r:delete n[li]),o}var LP=Og?function(n){return n==null?[]:(n=Object(n),qx(Og(n),function(t){return Gg.call(n,t)}))}:BP,Kr=Vs;(_u&&Kr(new _u(new ArrayBuffer(1)))!=qo||Hs&&Kr(new Hs)!=Lo||bu&&Kr(bu.resolve())!=bg||Eu&&Kr(new Eu)!=Fo||Iu&&Kr(new Iu)!=wu)&&(Kr=function(n){var t=Vs(n),r=t==Qi?n.constructor:void 0,s=r?di(r):"";if(s)switch(s){case Qx:return qo;case Zx:return Lo;case eP:return bg;case tP:return Fo;case rP:return wu}return t});function FP(n,t){return t=t??Dg,!!t&&(typeof n=="number"||Lx.test(n))&&n>-1&&n%1==0&&n<t}function qP(n){var t=typeof n;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?n!=="__proto__":n===null}function MP(n){return!!Pg&&Pg in n}function jP(n){var t=n&&n.constructor,r=typeof t=="function"&&t.prototype||$o;return n===r}function UP(n){return Kg.call(n)}function di(n){if(n!=null){try{return Vg.call(n)}catch{}try{return n+""}catch{}}return""}function Yg(n,t){return n===t||n!==n&&t!==t}var zP=Ag(function(){return arguments}())?Ag:function(n){return Bs(n)&&sr.call(n,"callee")&&!Gg.call(n,"callee")},Uo=Array.isArray;function $P(n){return n!=null&&Qg(n.length)&&!Xg(n)}var xu=Yx||VP;function HP(n,t){return Wg(n,t)}function Xg(n){if(!Zg(n))return!1;var t=Vs(n);return t==Mg||t==vx||t==mx||t==_x}function Qg(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=Dg}function Zg(n){var t=typeof n;return n!=null&&(t=="object"||t=="function")}function Bs(n){return n!=null&&typeof n=="object"}var ey=xg?zx(xg):TP;function kP(n){return $P(n)?PP(n):AP(n)}function BP(){return[]}function VP(){return!1}Zi.exports=HP});var Su={};Bn(Su,{default:()=>KP});function KP(n,t){return t=t||{},new Promise(function(r,s){var o=new XMLHttpRequest,u=[],l=[],d={},v=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:v,headers:{keys:function(){return u},entries:function(){return l},get:function(y){return d[y.toLowerCase()]},has:function(y){return y.toLowerCase()in d}}}};for(var b in o.open(t.method||"get",n,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(y,_,P){u.push(_=_.toLowerCase()),l.push([_,P]),d[_]=d[_]?d[_]+","+P:P}),r(v())},o.onerror=s,o.withCredentials=t.credentials=="include",t.headers)o.setRequestHeader(b,t.headers[b]);o.send(t.body||null)})}var Ru=_c(()=>{"use strict"});var iy=Je((NT,ry)=>{"use strict";ry.exports=self.fetch||(self.fetch=(Ru(),yr(Su)).default||(Ru(),yr(Su)))});var Ky=Je((Sr,Vy)=>{"use strict";var By=typeof self<"u"?self:Sr,Wo=function(){function n(){this.fetch=!1,this.DOMException=By.DOMException}return n.prototype=By,new n}();(function(n){var t=function(r){var s={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n};function o(x){return x&&DataView.prototype.isPrototypeOf(x)}if(s.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(x){return x&&u.indexOf(Object.prototype.toString.call(x))>-1};function d(x){if(typeof x!="string"&&(x=String(x)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(x))throw new TypeError("Invalid character in header field name");return x.toLowerCase()}function v(x){return typeof x!="string"&&(x=String(x)),x}function b(x){var R={next:function(){var D=x.shift();return{done:D===void 0,value:D}}};return s.iterable&&(R[Symbol.iterator]=function(){return R}),R}function y(x){this.map={},x instanceof y?x.forEach(function(R,D){this.append(D,R)},this):Array.isArray(x)?x.forEach(function(R){this.append(R[0],R[1])},this):x&&Object.getOwnPropertyNames(x).forEach(function(R){this.append(R,x[R])},this)}y.prototype.append=function(x,R){x=d(x),R=v(R);var D=this.map[x];this.map[x]=D?D+", "+R:R},y.prototype.delete=function(x){delete this.map[d(x)]},y.prototype.get=function(x){return x=d(x),this.has(x)?this.map[x]:null},y.prototype.has=function(x){return this.map.hasOwnProperty(d(x))},y.prototype.set=function(x,R){this.map[d(x)]=v(R)},y.prototype.forEach=function(x,R){for(var D in this.map)this.map.hasOwnProperty(D)&&x.call(R,this.map[D],D,this)},y.prototype.keys=function(){var x=[];return this.forEach(function(R,D){x.push(D)}),b(x)},y.prototype.values=function(){var x=[];return this.forEach(function(R){x.push(R)}),b(x)},y.prototype.entries=function(){var x=[];return this.forEach(function(R,D){x.push([D,R])}),b(x)},s.iterable&&(y.prototype[Symbol.iterator]=y.prototype.entries);function _(x){if(x.bodyUsed)return Promise.reject(new TypeError("Already read"));x.bodyUsed=!0}function P(x){return new Promise(function(R,D){x.onload=function(){R(x.result)},x.onerror=function(){D(x.error)}})}function S(x){var R=new FileReader,D=P(R);return R.readAsArrayBuffer(x),D}function A(x){var R=new FileReader,D=P(R);return R.readAsText(x),D}function M(x){for(var R=new Uint8Array(x),D=new Array(R.length),U=0;U<R.length;U++)D[U]=String.fromCharCode(R[U]);return D.join("")}function q(x){if(x.slice)return x.slice(0);var R=new Uint8Array(x.byteLength);return R.set(new Uint8Array(x)),R.buffer}function B(){return this.bodyUsed=!1,this._initBody=function(x){this._bodyInit=x,x?typeof x=="string"?this._bodyText=x:s.blob&&Blob.prototype.isPrototypeOf(x)?this._bodyBlob=x:s.formData&&FormData.prototype.isPrototypeOf(x)?this._bodyFormData=x:s.searchParams&&URLSearchParams.prototype.isPrototypeOf(x)?this._bodyText=x.toString():s.arrayBuffer&&s.blob&&o(x)?(this._bodyArrayBuffer=q(x.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(x)||l(x))?this._bodyArrayBuffer=q(x):this._bodyText=x=Object.prototype.toString.call(x):this._bodyText="",this.headers.get("content-type")||(typeof x=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):s.searchParams&&URLSearchParams.prototype.isPrototypeOf(x)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s.blob&&(this.blob=function(){var x=_(this);if(x)return x;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?_(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(S)}),this.text=function(){var x=_(this);if(x)return x;if(this._bodyBlob)return A(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(M(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s.formData&&(this.formData=function(){return this.text().then(ee)}),this.json=function(){return this.text().then(JSON.parse)},this}var J=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function H(x){var R=x.toUpperCase();return J.indexOf(R)>-1?R:x}function z(x,R){R=R||{};var D=R.body;if(x instanceof z){if(x.bodyUsed)throw new TypeError("Already read");this.url=x.url,this.credentials=x.credentials,R.headers||(this.headers=new y(x.headers)),this.method=x.method,this.mode=x.mode,this.signal=x.signal,!D&&x._bodyInit!=null&&(D=x._bodyInit,x.bodyUsed=!0)}else this.url=String(x);if(this.credentials=R.credentials||this.credentials||"same-origin",(R.headers||!this.headers)&&(this.headers=new y(R.headers)),this.method=H(R.method||this.method||"GET"),this.mode=R.mode||this.mode||null,this.signal=R.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&D)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(D)}z.prototype.clone=function(){return new z(this,{body:this._bodyInit})};function ee(x){var R=new FormData;return x.trim().split("&").forEach(function(D){if(D){var U=D.split("="),$=U.shift().replace(/\+/g," "),X=U.join("=").replace(/\+/g," ");R.append(decodeURIComponent($),decodeURIComponent(X))}}),R}function se(x){var R=new y,D=x.replace(/\r?\n[\t ]+/g," ");return D.split(/\r?\n/).forEach(function(U){var $=U.split(":"),X=$.shift().trim();if(X){var we=$.join(":").trim();R.append(X,we)}}),R}B.call(z.prototype);function T(x,R){R||(R={}),this.type="default",this.status=R.status===void 0?200:R.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in R?R.statusText:"OK",this.headers=new y(R.headers),this.url=R.url||"",this._initBody(x)}B.call(T.prototype),T.prototype.clone=function(){return new T(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new y(this.headers),url:this.url})},T.error=function(){var x=new T(null,{status:0,statusText:""});return x.type="error",x};var N=[301,302,303,307,308];T.redirect=function(x,R){if(N.indexOf(R)===-1)throw new RangeError("Invalid status code");return new T(null,{status:R,headers:{location:x}})},r.DOMException=n.DOMException;try{new r.DOMException}catch{r.DOMException=function(R,D){this.message=R,this.name=D;var U=Error(R);this.stack=U.stack},r.DOMException.prototype=Object.create(Error.prototype),r.DOMException.prototype.constructor=r.DOMException}function re(x,R){return new Promise(function(D,U){var $=new z(x,R);if($.signal&&$.signal.aborted)return U(new r.DOMException("Aborted","AbortError"));var X=new XMLHttpRequest;function we(){X.abort()}X.onload=function(){var Be={status:X.status,statusText:X.statusText,headers:se(X.getAllResponseHeaders()||"")};Be.url="responseURL"in X?X.responseURL:Be.headers.get("X-Request-URL");var tt="response"in X?X.response:X.responseText;D(new T(tt,Be))},X.onerror=function(){U(new TypeError("Network request failed"))},X.ontimeout=function(){U(new TypeError("Network request failed"))},X.onabort=function(){U(new r.DOMException("Aborted","AbortError"))},X.open($.method,$.url,!0),$.credentials==="include"?X.withCredentials=!0:$.credentials==="omit"&&(X.withCredentials=!1),"responseType"in X&&s.blob&&(X.responseType="blob"),$.headers.forEach(function(Be,tt){X.setRequestHeader(tt,Be)}),$.signal&&($.signal.addEventListener("abort",we),X.onreadystatechange=function(){X.readyState===4&&$.signal.removeEventListener("abort",we)}),X.send(typeof $._bodyInit>"u"?null:$._bodyInit)})}return re.polyfill=!0,n.fetch||(n.fetch=re,n.Headers=y,n.Request=z,n.Response=T),r.Headers=y,r.Request=z,r.Response=T,r.fetch=re,Object.defineProperty(r,"__esModule",{value:!0}),r}({})})(Wo);Wo.fetch.ponyfill=!0;delete Wo.fetch.polyfill;var rs=Wo;Sr=rs.fetch;Sr.default=rs.fetch;Sr.fetch=rs.fetch;Sr.Headers=rs.Headers;Sr.Request=rs.Request;Sr.Response=rs.Response;Vy.exports=Sr});var lm=je(mr());var xr=je(mr());var YE=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,XE=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,QE=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function ZE(n,t){if(n==="__proto__"||n==="constructor"&&t&&typeof t=="object"&&"prototype"in t){eI(n);return}return t}function eI(n){console.warn(`[destr] Dropping "${n}" key to prevent prototype pollution.`)}function Ps(n,t={}){if(typeof n!="string")return n;let r=n.trim();if(n[0]==='"'&&n.endsWith('"')&&!n.includes("\\"))return r.slice(1,-1);if(r.length<=9){let s=r.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!QE.test(n)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return n}try{if(YE.test(n)||XE.test(n)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(n,ZE)}return JSON.parse(n)}catch(s){if(t.strict)throw s;return n}}function tI(n){return!n||typeof n.then!="function"?Promise.resolve(n):n}function et(n,...t){try{return tI(n(...t))}catch(r){return Promise.reject(r)}}function rI(n){let t=typeof n;return n===null||t!=="object"&&t!=="function"}function iI(n){let t=Object.getPrototypeOf(n);return!t||t.isPrototypeOf(Object)}function Ss(n){if(rI(n))return String(n);if(iI(n)||Array.isArray(n))return JSON.stringify(n);if(typeof n.toJSON=="function")return Ss(n.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Kp(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}var Ac="base64:";function Gp(n){if(typeof n=="string")return n;Kp();let t=Buffer.from(n).toString("base64");return Ac+t}function Wp(n){return typeof n!="string"||!n.startsWith(Ac)?n:(Kp(),Buffer.from(n.slice(Ac.length),"base64"))}function dt(n){return n?n.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Jp(...n){return dt(n.join(":"))}function Rs(n){return n=dt(n),n?n+":":""}var sI="memory",nI=()=>{let n=new Map;return{name:sI,options:{},hasItem(t){return n.has(t)},getItem(t){return n.get(t)??null},getItemRaw(t){return n.get(t)??null},setItem(t,r){n.set(t,r)},setItemRaw(t,r){n.set(t,r)},removeItem(t){n.delete(t)},getKeys(){return Array.from(n.keys())},clear(){n.clear()},dispose(){n.clear()}}};function Qp(n={}){let t={mounts:{"":n.driver||nI()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=y=>{for(let _ of t.mountpoints)if(y.startsWith(_))return{base:_,relativeKey:y.slice(_.length),driver:t.mounts[_]};return{base:"",relativeKey:y,driver:t.mounts[""]}},s=(y,_)=>t.mountpoints.filter(P=>P.startsWith(y)||_&&y.startsWith(P)).map(P=>({relativeBase:y.length>P.length?y.slice(P.length):void 0,mountpoint:P,driver:t.mounts[P]})),o=(y,_)=>{if(t.watching){_=dt(_);for(let P of t.watchListeners)P(y,_)}},u=()=>g(this,null,function*(){if(!t.watching){t.watching=!0;for(let y in t.mounts)t.unwatch[y]=yield Yp(t.mounts[y],o,y)}}),l=()=>g(this,null,function*(){if(t.watching){for(let y in t.unwatch)yield t.unwatch[y]();t.unwatch={},t.watching=!1}}),d=(y,_,P)=>{let S=new Map,A=M=>{let q=S.get(M.base);return q||(q={driver:M.driver,base:M.base,items:[]},S.set(M.base,q)),q};for(let M of y){let q=typeof M=="string",B=dt(q?M:M.key),J=q?void 0:M.value,H=q||!M.options?_:ke(ke({},_),M.options),z=r(B);A(z).items.push({key:B,value:J,relativeKey:z.relativeKey,options:H})}return Promise.all([...S.values()].map(M=>P(M))).then(M=>M.flat())},v={hasItem(y,_={}){y=dt(y);let{relativeKey:P,driver:S}=r(y);return et(S.hasItem,P,_)},getItem(y,_={}){y=dt(y);let{relativeKey:P,driver:S}=r(y);return et(S.getItem,P,_).then(A=>Ps(A))},getItems(y,_){return d(y,_,P=>P.driver.getItems?et(P.driver.getItems,P.items.map(S=>({key:S.relativeKey,options:S.options})),_).then(S=>S.map(A=>({key:Jp(P.base,A.key),value:Ps(A.value)}))):Promise.all(P.items.map(S=>et(P.driver.getItem,S.relativeKey,S.options).then(A=>({key:S.key,value:Ps(A)})))))},getItemRaw(y,_={}){y=dt(y);let{relativeKey:P,driver:S}=r(y);return S.getItemRaw?et(S.getItemRaw,P,_):et(S.getItem,P,_).then(A=>Wp(A))},setItem(S,A){return g(this,arguments,function*(y,_,P={}){if(_===void 0)return v.removeItem(y);y=dt(y);let{relativeKey:M,driver:q}=r(y);q.setItem&&(yield et(q.setItem,M,Ss(_),P),q.watch||o("update",y))})},setItems(y,_){return g(this,null,function*(){yield d(y,_,P=>g(this,null,function*(){if(P.driver.setItems)return et(P.driver.setItems,P.items.map(S=>({key:S.relativeKey,value:Ss(S.value),options:S.options})),_);P.driver.setItem&&(yield Promise.all(P.items.map(S=>et(P.driver.setItem,S.relativeKey,Ss(S.value),S.options))))}))})},setItemRaw(S,A){return g(this,arguments,function*(y,_,P={}){if(_===void 0)return v.removeItem(y,P);y=dt(y);let{relativeKey:M,driver:q}=r(y);if(q.setItemRaw)yield et(q.setItemRaw,M,_,P);else if(q.setItem)yield et(q.setItem,M,Gp(_),P);else return;q.watch||o("update",y)})},removeItem(P){return g(this,arguments,function*(y,_={}){typeof _=="boolean"&&(_={removeMeta:_}),y=dt(y);let{relativeKey:S,driver:A}=r(y);A.removeItem&&(yield et(A.removeItem,S,_),(_.removeMeta||_.removeMata)&&(yield et(A.removeItem,S+"$",_)),A.watch||o("remove",y))})},getMeta(P){return g(this,arguments,function*(y,_={}){typeof _=="boolean"&&(_={nativeOnly:_}),y=dt(y);let{relativeKey:S,driver:A}=r(y),M=Object.create(null);if(A.getMeta&&Object.assign(M,yield et(A.getMeta,S,_)),!_.nativeOnly){let q=yield et(A.getItem,S+"$",_).then(B=>Ps(B));q&&typeof q=="object"&&(typeof q.atime=="string"&&(q.atime=new Date(q.atime)),typeof q.mtime=="string"&&(q.mtime=new Date(q.mtime)),Object.assign(M,q))}return M})},setMeta(y,_,P={}){return this.setItem(y+"$",_,P)},removeMeta(y,_={}){return this.removeItem(y+"$",_)},getKeys(P){return g(this,arguments,function*(y,_={}){y=Rs(y);let S=s(y,!0),A=[],M=[];for(let q of S){let J=(yield et(q.driver.getKeys,q.relativeBase,_)).map(H=>q.mountpoint+dt(H)).filter(H=>!A.some(z=>H.startsWith(z)));M.push(...J),A=[q.mountpoint,...A.filter(H=>!H.startsWith(q.mountpoint))]}return y?M.filter(q=>q.startsWith(y)&&!q.endsWith("$")):M.filter(q=>!q.endsWith("$"))})},clear(P){return g(this,arguments,function*(y,_={}){y=Rs(y),yield Promise.all(s(y,!1).map(S=>g(this,null,function*(){if(S.driver.clear)return et(S.driver.clear,S.relativeBase,_);if(S.driver.removeItem){let A=yield S.driver.getKeys(S.relativeBase||"",_);return Promise.all(A.map(M=>S.driver.removeItem(M,_)))}})))})},dispose(){return g(this,null,function*(){yield Promise.all(Object.values(t.mounts).map(y=>Xp(y)))})},watch(y){return g(this,null,function*(){return yield u(),t.watchListeners.push(y),()=>g(this,null,function*(){t.watchListeners=t.watchListeners.filter(_=>_!==y),t.watchListeners.length===0&&(yield l())})})},unwatch(){return g(this,null,function*(){t.watchListeners=[],yield l()})},mount(y,_){if(y=Rs(y),y&&t.mounts[y])throw new Error(`already mounted at ${y}`);return y&&(t.mountpoints.push(y),t.mountpoints.sort((P,S)=>S.length-P.length)),t.mounts[y]=_,t.watching&&Promise.resolve(Yp(_,o,y)).then(P=>{t.unwatch[y]=P}).catch(console.error),v},unmount(y,_=!0){return g(this,null,function*(){y=Rs(y),!(!y||!t.mounts[y])&&(t.watching&&y in t.unwatch&&(t.unwatch[y](),delete t.unwatch[y]),_&&(yield Xp(t.mounts[y])),t.mountpoints=t.mountpoints.filter(P=>P!==y),delete t.mounts[y])})},getMount(y=""){y=dt(y)+":";let _=r(y);return{driver:_.driver,base:_.base}},getMounts(y="",_={}){return y=dt(y),s(y,_.parents).map(S=>({driver:S.driver,base:S.mountpoint}))}};return v}function Yp(n,t,r){return n.watch?n.watch((s,o)=>t(s,r+o)):()=>{}}function Xp(n){return g(this,null,function*(){typeof n.dispose=="function"&&(yield et(n.dispose))})}function ai(n){return new Promise((t,r)=>{n.oncomplete=n.onsuccess=()=>t(n.result),n.onabort=n.onerror=()=>r(n.error)})}function Nc(n,t){let r=indexedDB.open(n);r.onupgradeneeded=()=>r.result.createObjectStore(t);let s=ai(r);return(o,u)=>s.then(l=>u(l.transaction(t,o).objectStore(t)))}var Cc;function Os(){return Cc||(Cc=Nc("keyval-store","keyval")),Cc}function Dc(n,t=Os()){return t("readonly",r=>ai(r.get(n)))}function Zp(n,t,r=Os()){return r("readwrite",s=>(s.put(t,n),ai(s.transaction)))}function ed(n,t=Os()){return t("readwrite",r=>(r.delete(n),ai(r.transaction)))}function td(n=Os()){return n("readwrite",t=>(t.clear(),ai(t.transaction)))}function oI(n,t){return n.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},ai(n.transaction)}function rd(n=Os()){return n("readonly",t=>{if(t.getAllKeys)return ai(t.getAllKeys());let r=[];return oI(t,s=>r.push(s.key)).then(()=>r)})}var aI=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),cI=n=>{let t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function er(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return cI(n)}catch{return n}}function $t(n){return typeof n=="string"?n:aI(n)||""}var uI="idb-keyval",hI=(n={})=>{let t=n.base&&n.base.length>0?`${n.base}:`:"",r=u=>t+u,s;return n.dbName&&n.storeName&&(s=Nc(n.dbName,n.storeName)),{name:uI,options:n,hasItem(u){return g(this,null,function*(){return!(typeof(yield Dc(r(u),s))>"u")})},getItem(u){return g(this,null,function*(){return(yield Dc(r(u),s))??null})},setItem(u,l){return Zp(r(u),l,s)},removeItem(u){return ed(r(u),s)},getKeys(){return rd(s)},clear(){return td(s)}}},lI="WALLET_CONNECT_V2_INDEXED_DB",fI="keyvaluestorage",Fc=class{constructor(){this.indexedDb=Qp({driver:hI({dbName:lI,storeName:fI})})}getKeys(){return g(this,null,function*(){return this.indexedDb.getKeys()})}getEntries(){return g(this,null,function*(){return(yield this.indexedDb.getItems(yield this.indexedDb.getKeys())).map(t=>[t.key,t.value])})}getItem(t){return g(this,null,function*(){let r=yield this.indexedDb.getItem(t);if(r!==null)return r})}setItem(t,r){return g(this,null,function*(){yield this.indexedDb.setItem(t,$t(r))})}removeItem(t){return g(this,null,function*(){yield this.indexedDb.removeItem(t)})}},Lc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Zn={exports:{}};(function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){let r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Lc<"u"&&Lc.localStorage?Zn.exports=Lc.localStorage:typeof window<"u"&&window.localStorage?Zn.exports=window.localStorage:Zn.exports=new t})();function pI(n){var t;return[n[0],er((t=n[1])!=null?t:"")]}var qc=class{constructor(){this.localStorage=Zn.exports}getKeys(){return g(this,null,function*(){return Object.keys(this.localStorage)})}getEntries(){return g(this,null,function*(){return Object.entries(this.localStorage).map(pI)})}getItem(t){return g(this,null,function*(){let r=this.localStorage.getItem(t);if(r!==null)return er(r)})}setItem(t,r){return g(this,null,function*(){this.localStorage.setItem(t,$t(r))})}removeItem(t){return g(this,null,function*(){this.localStorage.removeItem(t)})}},dI="wc_storage_version",id=1,gI=(n,t,r)=>g(void 0,null,function*(){let s=dI,o=yield t.getItem(s);if(o&&o>=id){r(t);return}let u=yield n.getKeys();if(!u.length){r(t);return}let l=[];for(;u.length;){let d=u.shift();if(!d)continue;let v=d.toLowerCase();if(v.includes("wc@")||v.includes("walletconnect")||v.includes("wc_")||v.includes("wallet_connect")){let b=yield n.getItem(d);yield t.setItem(d,b),l.push(d)}}yield t.setItem(s,id),r(t),yI(n,l)}),yI=(n,t)=>g(void 0,null,function*(){t.length&&t.forEach(r=>g(void 0,null,function*(){yield n.removeItem(r)}))}),eo=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};let t=new qc;this.storage=t;try{let r=new Fc;gI(t,r,this.setInitialized)}catch{this.initialized=!0}}getKeys(){return g(this,null,function*(){return yield this.initialize(),this.storage.getKeys()})}getEntries(){return g(this,null,function*(){return yield this.initialize(),this.storage.getEntries()})}getItem(t){return g(this,null,function*(){return yield this.initialize(),this.storage.getItem(t)})}setItem(t,r){return g(this,null,function*(){return yield this.initialize(),this.storage.setItem(t,r)})}removeItem(t){return g(this,null,function*(){return yield this.initialize(),this.storage.removeItem(t)})}initialize(){return g(this,null,function*(){this.initialized||(yield new Promise(t=>{let r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)}))})}};var mi=je(ud()),fe=je(no());Mc();var Ed=je(mr()),oo=class extends tr{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}};var ao=class extends tr{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},co=class{constructor(t,r){this.logger=t,this.core=r}},uo=class extends tr{constructor(t,r){super(),this.relayer=t,this.logger=r}},ho=class extends tr{constructor(t){super()}},lo=class{constructor(t,r,s,o){this.core=t,this.logger=r,this.name=s}};var fo=class extends tr{constructor(t,r){super(),this.relayer=t,this.logger=r}};var po=class extends tr{constructor(t,r){super(),this.core=t,this.logger=r}};var go=class{constructor(t,r){this.projectId=t,this.logger=r}},yo=class{constructor(t,r){this.projectId=t,this.logger=r}};var mo=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}};var vo=class{constructor(t){this.client=t}};var Ls=je(Ud()),Xd=je(np()),Qd=je(Es());var zd="EdDSA",$d="JWT",nu=".",ou="base64url",Hd="utf8",kd="utf8",Bd=":",Vd="did",Kd="key",au="base58btc",Gd="z",Wd="K36";function wo(n){return Fi(Vn($t(n),Hd),ou)}function _o(n){let t=Vn(Wd,au),r=Gd+Fi(op([t,n]),au);return[Vd,Kd,r].join(Bd)}function ZI(n){return Fi(n,ou)}function Jd(n){return Vn([wo(n.header),wo(n.payload)].join(nu),kd)}function Yd(n){return[wo(n.header),wo(n.payload),ZI(n.signature)].join(nu)}function cu(n=(0,Xd.randomBytes)(32)){return Ls.generateKeyPairFromSeed(n)}function Zd(u,l,d,v){return g(this,arguments,function*(n,t,r,s,o=(0,Qd.fromMiliseconds)(Date.now())){let b={alg:zd,typ:$d},y=_o(s.publicKey),_=o+r,P={iss:y,sub:n,aud:t,iat:o,exp:_},S=Jd({header:b,payload:P}),A=Ls.sign(s.secretKey,S);return Yd({header:b,payload:P,signature:A})})}var le=je(Es());var gg=je(mr());var it={};Bn(it,{DEFAULT_ERROR:()=>qs,IBaseJsonRpcProvider:()=>To,IEvents:()=>Yi,IJsonRpcConnection:()=>fu,IJsonRpcProvider:()=>zs,INTERNAL_ERROR:()=>bo,INVALID_PARAMS:()=>ig,INVALID_REQUEST:()=>tg,METHOD_NOT_FOUND:()=>rg,PARSE_ERROR:()=>eg,RESERVED_ERROR_CODES:()=>uu,SERVER_ERROR:()=>Fs,SERVER_ERROR_CODE_RANGE:()=>Eo,STANDARD_ERROR_MAP:()=>$r,formatErrorMessage:()=>pg,formatJsonRpcError:()=>_r,formatJsonRpcRequest:()=>ir,formatJsonRpcResult:()=>Br,getBigIntRpcId:()=>Us,getError:()=>xo,getErrorByCode:()=>Po,isHttpUrl:()=>Ao,isJsonRpcError:()=>yt,isJsonRpcPayload:()=>du,isJsonRpcRequest:()=>Xi,isJsonRpcResponse:()=>Vr,isJsonRpcResult:()=>Ht,isJsonRpcValidationInvalid:()=>fx,isLocalhostUrl:()=>pu,isNodeJs:()=>fg,isReservedErrorCode:()=>Io,isServerErrorCode:()=>rx,isValidDefaultRoute:()=>Ro,isValidErrorCode:()=>sg,isValidLeadingWildcardRoute:()=>ax,isValidRoute:()=>ox,isValidTrailingWildcardRoute:()=>cx,isValidWildcardRoute:()=>Oo,isWsUrl:()=>Co,parseConnectionError:()=>Ms,payloadId:()=>js,validateJsonRpcError:()=>ix});var eg="PARSE_ERROR",tg="INVALID_REQUEST",rg="METHOD_NOT_FOUND",ig="INVALID_PARAMS",bo="INTERNAL_ERROR",Fs="SERVER_ERROR",uu=[-32700,-32600,-32601,-32602,-32603],Eo=[-32e3,-32099],$r={[eg]:{code:-32700,message:"Parse error"},[tg]:{code:-32600,message:"Invalid Request"},[rg]:{code:-32601,message:"Method not found"},[ig]:{code:-32602,message:"Invalid params"},[bo]:{code:-32603,message:"Internal error"},[Fs]:{code:-32e3,message:"Server error"}},qs=Fs;function rx(n){return n<=Eo[0]&&n>=Eo[1]}function Io(n){return uu.includes(n)}function sg(n){return typeof n=="number"}function xo(n){return Object.keys($r).includes(n)?$r[n]:$r[qs]}function Po(n){let t=Object.values($r).find(r=>r.code===n);return t||$r[qs]}function ix(n){if(typeof n.error.code>"u")return{valid:!1,error:"Missing code for JSON-RPC error"};if(typeof n.error.message>"u")return{valid:!1,error:"Missing message for JSON-RPC error"};if(!sg(n.error.code))return{valid:!1,error:`Invalid error code type for JSON-RPC: ${n.error.code}`};if(Io(n.error.code)){let t=Po(n.error.code);if(t.message!==$r[qs].message&&n.error.message===t.message)return{valid:!1,error:`Invalid error code message for JSON-RPC: ${n.error.code}`}}return{valid:!0}}function Ms(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var gt={};Bn(gt,{isNodeJs:()=>fg});var lg=je(lu());Tt(gt,je(lu()));var fg=lg.isNode;Tt(it,gt);function js(n=3){let t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function Us(n=6){return BigInt(js(n))}function ir(n,t,r){return{id:r||js(),jsonrpc:"2.0",method:n,params:t}}function Br(n,t){return{id:n,jsonrpc:"2.0",result:t}}function _r(n,t,r){return{id:n,jsonrpc:"2.0",error:pg(t,r)}}function pg(n,t){return typeof n>"u"?xo(bo):(typeof n=="string"&&(n=Object.assign(Object.assign({},xo(Fs)),{message:n})),typeof t<"u"&&(n.data=t),Io(n.code)&&(n=Po(n.code)),n)}function ox(n){return n.includes("*")?Oo(n):!/\W/g.test(n)}function Ro(n){return n==="*"}function Oo(n){return Ro(n)?!0:!(!n.includes("*")||n.split("*").length!==2||n.split("*").filter(t=>t.trim()==="").length!==1)}function ax(n){return!Ro(n)&&Oo(n)&&!n.split("*")[0].trim()}function cx(n){return!Ro(n)&&Oo(n)&&!n.split("*")[1].trim()}var Yi=class{};var fu=class extends Yi{constructor(t){super()}},To=class extends Yi{constructor(){super()}},zs=class extends To{constructor(t){super()}};var ux="^https?:",hx="^wss?:";function lx(n){let t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function dg(n,t){let r=lx(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function Ao(n){return dg(n,ux)}function Co(n){return dg(n,hx)}function pu(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function du(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function Xi(n){return du(n)&&"method"in n}function Vr(n){return du(n)&&(Ht(n)||yt(n))}function Ht(n){return"result"in n}function yt(n){return"error"in n}function fx(n){return"error"in n&&n.valid===!1}var Ct=class extends zs{constructor(t){super(t),this.events=new gg.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}connect(){return g(this,arguments,function*(t=this.connection){yield this.open(t)})}disconnect(){return g(this,null,function*(){yield this.close()})}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}request(t,r){return g(this,null,function*(){return this.requestStrict(ir(t.method,t.params||[],t.id||Us().toString()),r)})}requestStrict(t,r){return g(this,null,function*(){return new Promise((s,o)=>g(this,null,function*(){if(!this.connection.connected)try{yield this.open()}catch(u){o(u)}this.events.on(`${t.id}`,u=>{yt(u)?o(u.error):s(u.result)});try{yield this.connection.send(t,r)}catch(u){o(u)}}))})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Vr(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}open(){return g(this,arguments,function*(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(yield this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),yield this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))})}close(){return g(this,null,function*(){yield this.connection.close()})}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}};var _g=je(mr());var px=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:mg(),dx=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",vg=n=>n.split("?")[0],wg=10,gx=px(),No=class{constructor(t){if(this.url=t,this.events=new _g.EventEmitter,this.registering=!1,!Co(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}open(){return g(this,arguments,function*(t=this.url){yield this.register(t)})}close(){return g(this,null,function*(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})})}send(t){return g(this,null,function*(){typeof this.socket>"u"&&(this.socket=yield this.register());try{this.socket.send($t(t))}catch(r){this.onError(t.id,r)}})}register(t=this.url){if(!Co(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){let r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),o(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{let o=new URLSearchParams(t).get("origin"),u=(0,it.isReactNative)()?{headers:{origin:o}}:{rejectUnauthorized:!pu(t)},l=new gx(t,[],u);dx()?l.onerror=d=>{let v=d;s(this.emitError(v.error))}:l.on("error",d=>{s(this.emitError(d))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;let r=typeof t.data=="string"?er(t.data):t.data;this.events.emit("payload",r)}onError(t,r){let s=this.parseError(r),o=s.message||s.toString(),u=_r(t,o);this.events.emit("payload",u)}parseError(t,r=this.url){return Ms(t,vg(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>wg&&this.events.setMaxListeners(wg)}emitError(t){let r=this.parseError(new Error(t?.message||`WebSocket connection failed for host: ${vg(this.url)}`));return this.events.emit("register_error",r),r}};var Ey=je(ty()),Iy=je(iy());function GP(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<n.length;o++){var u=n.charAt(o),l=u.charCodeAt(0);if(r[l]!==255)throw new TypeError(u+" is ambiguous");r[l]=o}var d=n.length,v=n.charAt(0),b=Math.log(d)/Math.log(256),y=Math.log(256)/Math.log(d);function _(A){if(A instanceof Uint8Array||(ArrayBuffer.isView(A)?A=new Uint8Array(A.buffer,A.byteOffset,A.byteLength):Array.isArray(A)&&(A=Uint8Array.from(A))),!(A instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(A.length===0)return"";for(var M=0,q=0,B=0,J=A.length;B!==J&&A[B]===0;)B++,M++;for(var H=(J-B)*y+1>>>0,z=new Uint8Array(H);B!==J;){for(var ee=A[B],se=0,T=H-1;(ee!==0||se<q)&&T!==-1;T--,se++)ee+=256*z[T]>>>0,z[T]=ee%d>>>0,ee=ee/d>>>0;if(ee!==0)throw new Error("Non-zero carry");q=se,B++}for(var N=H-q;N!==H&&z[N]===0;)N++;for(var re=v.repeat(M);N<H;++N)re+=n.charAt(z[N]);return re}function P(A){if(typeof A!="string")throw new TypeError("Expected String");if(A.length===0)return new Uint8Array;var M=0;if(A[M]!==" "){for(var q=0,B=0;A[M]===v;)q++,M++;for(var J=(A.length-M)*b+1>>>0,H=new Uint8Array(J);A[M];){var z=r[A.charCodeAt(M)];if(z===255)return;for(var ee=0,se=J-1;(z!==0||ee<B)&&se!==-1;se--,ee++)z+=d*H[se]>>>0,H[se]=z%256>>>0,z=z/256>>>0;if(z!==0)throw new Error("Non-zero carry");B=ee,M++}if(A[M]!==" "){for(var T=J-B;T!==J&&H[T]===0;)T++;for(var N=new Uint8Array(q+(J-T)),re=q;T!==J;)N[re++]=H[T++];return N}}}function S(A){var M=P(A);if(M)return M;throw new Error(`Non-${t} character`)}return{encode:_,decodeUnsafe:P,decode:S}}var WP=GP,JP=WP,xy=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},YP=n=>new TextEncoder().encode(n),XP=n=>new TextDecoder().decode(n),Cu=class{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Nu=class{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Py(this,t)}},Du=class{constructor(t){this.decoders=t}or(t){return Py(this,t)}decode(t){let r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Py=(n,t)=>new Du(ke(ke({},n.decoders||{[n.prefix]:n}),t.decoders||{[t.prefix]:t})),Lu=class{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new Cu(t,r,s),this.decoder=new Nu(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},Bo=({name:n,prefix:t,encode:r,decode:s})=>new Lu(n,t,r,s),Ws=({prefix:n,name:t,alphabet:r})=>{let{encode:s,decode:o}=JP(r,t);return Bo({prefix:n,name:t,encode:s,decode:u=>xy(o(u))})},QP=(n,t,r,s)=>{let o={};for(let y=0;y<t.length;++y)o[t[y]]=y;let u=n.length;for(;n[u-1]==="=";)--u;let l=new Uint8Array(u*r/8|0),d=0,v=0,b=0;for(let y=0;y<u;++y){let _=o[n[y]];if(_===void 0)throw new SyntaxError(`Non-${s} character`);v=v<<r|_,d+=r,d>=8&&(d-=8,l[b++]=255&v>>d)}if(d>=r||255&v<<8-d)throw new SyntaxError("Unexpected end of data");return l},ZP=(n,t,r)=>{let s=t[t.length-1]==="=",o=(1<<r)-1,u="",l=0,d=0;for(let v=0;v<n.length;++v)for(d=d<<8|n[v],l+=8;l>r;)l-=r,u+=t[o&d>>l];if(l&&(u+=t[o&d<<r-l]),s)for(;u.length*r&7;)u+="=";return u},at=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Bo({prefix:t,name:n,encode(o){return ZP(o,s,r)},decode(o){return QP(o,s,r,n)}}),eS=Bo({prefix:"\0",name:"identity",encode:n=>XP(n),decode:n=>YP(n)}),tS=Object.freeze({__proto__:null,identity:eS}),rS=at({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),iS=Object.freeze({__proto__:null,base2:rS}),sS=at({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),nS=Object.freeze({__proto__:null,base8:sS}),oS=Ws({prefix:"9",name:"base10",alphabet:"0123456789"}),aS=Object.freeze({__proto__:null,base10:oS}),cS=at({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),uS=at({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),hS=Object.freeze({__proto__:null,base16:cS,base16upper:uS}),lS=at({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),fS=at({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),pS=at({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),dS=at({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),gS=at({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),yS=at({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),mS=at({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),vS=at({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),wS=at({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),_S=Object.freeze({__proto__:null,base32:lS,base32upper:fS,base32pad:pS,base32padupper:dS,base32hex:gS,base32hexupper:yS,base32hexpad:mS,base32hexpadupper:vS,base32z:wS}),bS=Ws({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ES=Ws({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),IS=Object.freeze({__proto__:null,base36:bS,base36upper:ES}),xS=Ws({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),PS=Ws({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),SS=Object.freeze({__proto__:null,base58btc:xS,base58flickr:PS}),RS=at({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),OS=at({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),TS=at({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),AS=at({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),CS=Object.freeze({__proto__:null,base64:RS,base64pad:OS,base64url:TS,base64urlpad:AS}),Sy=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),NS=Sy.reduce((n,t,r)=>(n[r]=t,n),[]),DS=Sy.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function LS(n){return n.reduce((t,r)=>(t+=NS[r],t),"")}function FS(n){let t=[];for(let r of n){let s=DS[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}var qS=Bo({prefix:"\u{1F680}",name:"base256emoji",encode:LS,decode:FS}),MS=Object.freeze({__proto__:null,base256emoji:qS}),jS=Ry,sy=128,US=127,zS=~US,$S=Math.pow(2,31);function Ry(n,t,r){t=t||[],r=r||0;for(var s=r;n>=$S;)t[r++]=n&255|sy,n/=128;for(;n&zS;)t[r++]=n&255|sy,n>>>=7;return t[r]=n|0,Ry.bytes=r-s+1,t}var HS=Fu,kS=128,ny=127;function Fu(n,s){var r=0,s=s||0,o=0,u=s,l,d=n.length;do{if(u>=d)throw Fu.bytes=0,new RangeError("Could not decode varint");l=n[u++],r+=o<28?(l&ny)<<o:(l&ny)*Math.pow(2,o),o+=7}while(l>=kS);return Fu.bytes=u-s,r}var BS=Math.pow(2,7),VS=Math.pow(2,14),KS=Math.pow(2,21),GS=Math.pow(2,28),WS=Math.pow(2,35),JS=Math.pow(2,42),YS=Math.pow(2,49),XS=Math.pow(2,56),QS=Math.pow(2,63),ZS=function(n){return n<BS?1:n<VS?2:n<KS?3:n<GS?4:n<WS?5:n<JS?6:n<YS?7:n<XS?8:n<QS?9:10},eR={encode:jS,decode:HS,encodingLength:ZS},Oy=eR,oy=(n,t,r=0)=>(Oy.encode(n,t,r),t),ay=n=>Oy.encodingLength(n),qu=(n,t)=>{let r=t.byteLength,s=ay(n),o=s+ay(r),u=new Uint8Array(o+r);return oy(n,u,0),oy(r,u,s),u.set(t,o),new Mu(n,r,t,u)},Mu=class{constructor(t,r,s,o){this.code=t,this.size=r,this.digest=s,this.bytes=o}},Ty=({name:n,code:t,encode:r})=>new ju(n,t,r),ju=class{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?qu(this.code,r):r.then(s=>qu(this.code,s))}else throw Error("Unknown type, must be binary type")}},Ay=n=>t=>g(void 0,null,function*(){return new Uint8Array(yield crypto.subtle.digest(n,t))}),tR=Ty({name:"sha2-256",code:18,encode:Ay("SHA-256")}),rR=Ty({name:"sha2-512",code:19,encode:Ay("SHA-512")}),iR=Object.freeze({__proto__:null,sha256:tR,sha512:rR}),Cy=0,sR="identity",Ny=xy,nR=n=>qu(Cy,Ny(n)),oR={code:Cy,name:sR,encode:Ny,digest:nR},aR=Object.freeze({__proto__:null,identity:oR});new TextEncoder,new TextDecoder;var cy=ke(ke(ke(ke(ke(ke(ke(ke(ke(ke({},tS),iS),nS),aS),hS),_S),IS),SS),CS),MS);ke(ke({},iR),aR);function Dy(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function cR(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Dy(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Ly(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}var uy=Ly("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Ou=Ly("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);let t=cR(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),uR=ke({utf8:uy,"utf-8":uy,hex:cy.base16,latin1:Ou,ascii:Ou,binary:Ou},cy);function hR(n,t="utf8"){let r=uR[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Dy(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}var Fy="wc",lR=2,Zu="core",Wr=`${Fy}@2:${Zu}:`,fR={name:Zu,logger:"error"},pR={database:":memory:"},dR="crypto",hy="client_ed25519_seed",gR=le.ONE_DAY,yR="keychain",mR="0.3",vR="messages",wR="0.3",_R=le.SIX_HOURS,bR="publisher",eh="irn",ER="error",qy="wss://relay.walletconnect.com",ly="wss://relay.walletconnect.org",IR="relayer",ot={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},xR="_subscription",Ir={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},PR=le.ONE_SECOND;var SR="2.11.0",RR=1e4,OR="0.3",TR="WALLETCONNECT_CLIENT_ID",Wt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"};var AR="subscription",CR="0.3",NR=le.FIVE_SECONDS*1e3,DR="pairing",LR="0.3";var Ks={wc_pairingDelete:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:le.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:le.ONE_DAY,prompt:!1,tag:0},res:{ttl:le.ONE_DAY,prompt:!1,tag:0}}},ts={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},nr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},FR="history",qR="0.3",MR="expirer",Nt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},jR="0.3";var Tu="verify-api",gi="https://verify.walletconnect.com",Uu="https://verify.walletconnect.org",UR=[gi,Uu],zR="echo",$R="https://echo.walletconnect.com",zu=class{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=yR,this.version=mR,this.initialized=!1,this.storagePrefix=Wr,this.init=()=>g(this,null,function*(){if(!this.initialized){let s=yield this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}}),this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=(s,o)=>g(this,null,function*(){this.isInitialized(),this.keychain.set(s,o),yield this.persist()}),this.get=s=>{this.isInitialized();let o=this.keychain.get(s);if(typeof o>"u"){let{message:u}=V("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(u)}return o},this.del=s=>g(this,null,function*(){this.isInitialized(),this.keychain.delete(s),yield this.persist()}),this.core=t,this.logger=(0,fe.generateChildLogger)(r,this.name)}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}setKeyChain(t){return g(this,null,function*(){yield this.core.storage.setItem(this.storageKey,Ic(t))})}getKeyChain(){return g(this,null,function*(){let t=yield this.core.storage.getItem(this.storageKey);return typeof t<"u"?xc(t):void 0})}persist(){return g(this,null,function*(){yield this.setKeyChain(this.keychain)})}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}},$u=class{constructor(t,r,s){this.core=t,this.logger=r,this.name=dR,this.initialized=!1,this.init=()=>g(this,null,function*(){this.initialized||(yield this.keychain.init(),this.initialized=!0)}),this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=()=>g(this,null,function*(){this.isInitialized();let o=yield this.getClientSeed(),u=cu(o);return _o(u.publicKey)}),this.generateKeyPair=()=>{this.isInitialized();let o=hp();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=o=>g(this,null,function*(){this.isInitialized();let u=yield this.getClientSeed(),l=cu(u),d=Gn();return yield Zd(d,o,gR,l)}),this.generateSharedKey=(o,u,l)=>{this.isInitialized();let d=this.getPrivateKey(o),v=lp(d,u);return this.setSymKey(v,l)},this.setSymKey=(o,u)=>g(this,null,function*(){this.isInitialized();let l=u||fp(o);return yield this.keychain.set(l,o),l}),this.deleteKeyPair=o=>g(this,null,function*(){this.isInitialized(),yield this.keychain.del(o)}),this.deleteSymKey=o=>g(this,null,function*(){this.isInitialized(),yield this.keychain.del(o)}),this.encode=(o,u,l)=>g(this,null,function*(){this.isInitialized();let d=mp(l),v=$t(u);if(Ec(d)){let P=d.senderPublicKey,S=d.receiverPublicKey;o=yield this.generateSharedKey(P,S)}let b=this.getSymKey(o),{type:y,senderPublicKey:_}=d;return dp({type:y,symKey:b,message:v,senderPublicKey:_})}),this.decode=(o,u,l)=>g(this,null,function*(){this.isInitialized();let d=yp(u,l);if(Ec(d)){let v=d.receiverPublicKey,b=d.senderPublicKey;o=yield this.generateSharedKey(v,b)}try{let v=this.getSymKey(o),b=gp({symKey:v,encoded:u});return er(b)}catch(v){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${yield this.getClientId()}'`),this.logger.error(v)}}),this.getPayloadType=o=>{let u=bc(o);return pp(u.type)},this.getPayloadSenderPublicKey=o=>{let u=bc(o);return u.senderPublicKey?Fi(u.senderPublicKey,up):void 0},this.core=t,this.logger=(0,fe.generateChildLogger)(r,this.name),this.keychain=s||new zu(this.core,this.logger)}get context(){return(0,fe.getLoggerContext)(this.logger)}setPrivateKey(t,r){return g(this,null,function*(){return yield this.keychain.set(t,r),t})}getPrivateKey(t){return this.keychain.get(t)}getClientSeed(){return g(this,null,function*(){let t="";try{t=this.keychain.get(hy)}catch{t=Gn(),yield this.keychain.set(hy,t)}return hR(t,"base16")})}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}},Hu=class extends co{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=vR,this.version=wR,this.initialized=!1,this.storagePrefix=Wr,this.init=()=>g(this,null,function*(){if(!this.initialized){this.logger.trace("Initialized");try{let s=yield this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}}),this.set=(s,o)=>g(this,null,function*(){this.isInitialized();let u=Mr(o),l=this.messages.get(s);return typeof l>"u"&&(l={}),typeof l[u]<"u"||(l[u]=o,this.messages.set(s,l),yield this.persist()),u}),this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();let u=this.get(s),l=Mr(o);return typeof u[l]<"u"},this.del=s=>g(this,null,function*(){this.isInitialized(),this.messages.delete(s),yield this.persist()}),this.logger=(0,fe.generateChildLogger)(t,this.name),this.core=r}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}setRelayerMessages(t){return g(this,null,function*(){yield this.core.storage.setItem(this.storageKey,Ic(t))})}getRelayerMessages(){return g(this,null,function*(){let t=yield this.core.storage.getItem(this.storageKey);return typeof t<"u"?xc(t):void 0})}persist(){return g(this,null,function*(){yield this.setRelayerMessages(this.messages)})}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}},ku=class extends uo{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new xr.EventEmitter,this.name=bR,this.queue=new Map,this.publishTimeout=(0,le.toMiliseconds)(le.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=(s,o,u)=>g(this,null,function*(){var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:u}});try{let d=u?.ttl||_R,v=Xn(u),b=u?.prompt||!1,y=u?.tag||0,_=u?.id||Us().toString(),P={topic:s,message:o,opts:{ttl:d,relay:v,prompt:b,tag:y,id:_}},S=setTimeout(()=>this.queue.set(_,P),this.publishTimeout);try{yield yield ji(this.rpcPublish(s,o,d,v,b,y,_),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(_),this.relayer.events.emit(ot.publish,P)}catch(A){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=u?.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(_),A;return}finally{clearTimeout(S)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:u}})}catch(d){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(d),d}}),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=t,this.logger=(0,fe.generateChildLogger)(r,this.name),this.registerEventListeners()}get context(){return(0,fe.getLoggerContext)(this.logger)}rpcPublish(t,r,s,o,u,l,d){var v,b,y,_;let P={method:Is(o.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:u,tag:l},id:d};return Zt((v=P.params)==null?void 0:v.prompt)&&((b=P.params)==null||delete b.prompt),Zt((y=P.params)==null?void 0:y.tag)&&((_=P.params)==null||delete _.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:P}),this.relayer.request(P)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(t=>g(this,null,function*(){let{topic:r,message:s,opts:o}=t;yield this.publish(r,s,o)}))}registerEventListeners(){this.relayer.core.heartbeat.on(mi.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(ot.connection_stalled);return}this.checkQueue()}),this.relayer.on(ot.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}},Bu=class{constructor(){this.map=new Map,this.set=(t,r)=>{let s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;let s=this.get(t);if(!this.exists(t,r))return;let o=s.filter(u=>u!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}},HR=Object.defineProperty,kR=Object.defineProperties,BR=Object.getOwnPropertyDescriptors,fy=Object.getOwnPropertySymbols,VR=Object.prototype.hasOwnProperty,KR=Object.prototype.propertyIsEnumerable,py=(n,t,r)=>t in n?HR(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Gs=(n,t)=>{for(var r in t||(t={}))VR.call(t,r)&&py(n,r,t[r]);if(fy)for(var r of fy(t))KR.call(t,r)&&py(n,r,t[r]);return n},Au=(n,t)=>kR(n,BR(t)),Vu=class extends fo{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new Bu,this.events=new xr.EventEmitter,this.name=AR,this.version=CR,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Wr,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=()=>g(this,null,function*(){this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=yield this.relayer.core.crypto.getClientId())}),this.subscribe=(s,o)=>g(this,null,function*(){yield this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{let u=Xn(o),l={topic:s,relay:u};this.pending.set(s,l);let d=yield this.rpcSubscribe(s,u);return this.onSubscribe(d,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),d}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}}),this.unsubscribe=(s,o)=>g(this,null,function*(){yield this.restartToComplete(),this.isInitialized(),typeof o?.id<"u"?yield this.unsubscribeById(s,o.id,o):yield this.unsubscribeByTopic(s,o)}),this.isSubscribed=s=>g(this,null,function*(){return this.topics.includes(s)?!0:yield new Promise((o,u)=>{let l=new le.Watch;l.start(this.pendingSubscriptionWatchLabel);let d=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(d),l.stop(this.pendingSubscriptionWatchLabel),o(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=NR&&(clearInterval(d),l.stop(this.pendingSubscriptionWatchLabel),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)}),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=()=>g(this,null,function*(){this.restartInProgress=!0,yield this.restore(),yield this.reset(),this.restartInProgress=!1}),this.relayer=t,this.logger=(0,fe.generateChildLogger)(r,this.name),this.clientId=""}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}unsubscribeByTopic(t,r){return g(this,null,function*(){let s=this.topicMap.get(t);yield Promise.all(s.map(o=>g(this,null,function*(){return yield this.unsubscribeById(t,o,r)})))})}unsubscribeById(t,r,s){return g(this,null,function*(){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{let o=Xn(s);yield this.rpcUnsubscribe(t,r,o);let u=Ye("USER_DISCONNECTED",`${this.name}, ${t}`);yield this.onUnsubscribe(t,r,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}})}rpcSubscribe(t,r){return g(this,null,function*(){let s={method:Is(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{yield yield ji(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(ot.connection_stalled)}return Mr(t+this.clientId)})}rpcBatchSubscribe(t){return g(this,null,function*(){if(!t.length)return;let r=t[0].relay,s={method:Is(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return yield yield ji(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(ot.connection_stalled)}})}rpcUnsubscribe(t,r,s){let o={method:Is(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,Au(Gs({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Gs({},r)),this.pending.delete(r.topic)})}onUnsubscribe(t,r,s){return g(this,null,function*(){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),yield this.relayer.messages.del(t)})}setRelayerSubscriptions(t){return g(this,null,function*(){yield this.relayer.core.storage.setItem(this.storageKey,t)})}getRelayerSubscriptions(){return g(this,null,function*(){return yield this.relayer.core.storage.getItem(this.storageKey)})}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Gs({},r)),this.topicMap.set(r.topic,t),this.events.emit(Wt.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});let r=this.subscriptions.get(t);if(!r){let{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});let s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(Wt.deleted,Au(Gs({},s),{reason:r}))}persist(){return g(this,null,function*(){yield this.setRelayerSubscriptions(this.values),this.events.emit(Wt.sync)})}reset(){return g(this,null,function*(){if(this.cached.length){let t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){let s=this.cached.splice(0,this.batchSubscribeTopicsLimit);yield this.batchSubscribe(s)}}this.events.emit(Wt.resubscribed)})}restore(){return g(this,null,function*(){try{let t=yield this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){let{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}})}batchSubscribe(t){return g(this,null,function*(){if(!t.length)return;let r=yield this.rpcBatchSubscribe(t);vr(r)&&this.onBatchSubscribe(r.map((s,o)=>Au(Gs({},t[o]),{id:s})))})}onConnect(){return g(this,null,function*(){this.restartInProgress||(yield this.restart(),this.onEnable())})}onDisconnect(){this.onDisable()}checkPending(){return g(this,null,function*(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;let t=[];this.pending.forEach(r=>{t.push(r)}),yield this.batchSubscribe(t)})}registerEventListeners(){this.relayer.core.heartbeat.on(mi.HEARTBEAT_EVENTS.pulse,()=>g(this,null,function*(){yield this.checkPending()})),this.relayer.on(ot.connect,()=>g(this,null,function*(){yield this.onConnect()})),this.relayer.on(ot.disconnect,()=>{this.onDisconnect()}),this.events.on(Wt.created,t=>g(this,null,function*(){let r=Wt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),yield this.persist()})),this.events.on(Wt.deleted,t=>g(this,null,function*(){let r=Wt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),yield this.persist()}))}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}restartToComplete(){return g(this,null,function*(){this.restartInProgress&&(yield new Promise(t=>{let r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)}))})}},GR=Object.defineProperty,dy=Object.getOwnPropertySymbols,WR=Object.prototype.hasOwnProperty,JR=Object.prototype.propertyIsEnumerable,gy=(n,t,r)=>t in n?GR(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,YR=(n,t)=>{for(var r in t||(t={}))WR.call(t,r)&&gy(n,r,t[r]);if(dy)for(var r of dy(t))JR.call(t,r)&&gy(n,r,t[r]);return n},Ku=class extends ho{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new xr.EventEmitter,this.name=IR,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=r=>g(this,null,function*(){this.logger.debug("Publishing Request Payload");try{return yield this.toEstablishConnection(),yield this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}}),this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(ot.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(ot.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Ir.payload,this.onPayloadHandler),this.provider.on(Ir.connect,this.onConnectHandler),this.provider.on(Ir.disconnect,this.onDisconnectHandler),this.provider.on(Ir.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?(0,fe.generateChildLogger)(t.logger,this.name):(0,fe.pino)((0,fe.getDefaultLoggerOptions)({level:t.logger||ER})),this.messages=new Hu(this.logger,t.core),this.subscriber=new Vu(this,this.logger),this.publisher=new ku(this,this.logger),this.relayUrl=t?.relayUrl||qy,this.projectId=t.projectId,this.bundleId=_p(),this.provider={}}init(){return g(this,null,function*(){this.logger.trace("Initialized"),this.registerEventListeners(),yield this.createProvider(),yield Promise.all([this.messages.init(),this.subscriber.init()]);try{yield this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${ly}...`),yield this.restartTransport(ly)}this.initialized=!0,setTimeout(()=>g(this,null,function*(){this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),yield this.transportClose(),this.transportExplicitlyClosed=!1)}),RR)})}get context(){return(0,fe.getLoggerContext)(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}publish(t,r,s){return g(this,null,function*(){this.isInitialized(),yield this.publisher.publish(t,r,s),yield this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})})}subscribe(t,r){return g(this,null,function*(){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";if(o)return o;let u,l=d=>{d.topic===t&&(this.subscriber.off(Wt.created,l),u())};return yield Promise.all([new Promise(d=>{u=d,this.subscriber.on(Wt.created,l)}),new Promise(d=>g(this,null,function*(){o=yield this.subscriber.subscribe(t,r),d()}))]),o})}unsubscribe(t,r){return g(this,null,function*(){this.isInitialized(),yield this.subscriber.unsubscribe(t,r)})}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}transportClose(){return g(this,null,function*(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?yield ji(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&(yield this.provider.disconnect())})}transportOpen(t){return g(this,null,function*(){if(this.transportExplicitlyClosed=!1,yield this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,yield this.transportClose(),yield this.createProvider()),this.connectionAttemptInProgress=!0;try{yield Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Wt.resubscribed,()=>{r()})}),new Promise((r,s)=>g(this,null,function*(){try{yield ji(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}r()}))])}catch(r){this.logger.error(r);let s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(Ir.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}})}restartTransport(t){return g(this,null,function*(){yield this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,yield this.transportClose(),yield this.createProvider(),yield this.transportOpen())})}confirmOnlineStateOrThrow(){return g(this,null,function*(){if(!(yield Tc()))throw new Error("No internet connection detected. Please restart your network and try again.")})}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}createProvider(){return g(this,null,function*(){this.provider.connection&&this.unregisterProviderListeners();let t=yield this.core.crypto.signJWT(this.relayUrl);this.provider=new Ct(new No(Ep({sdkVersion:SR,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()})}recordMessageEvent(t){return g(this,null,function*(){let{topic:r,message:s}=t;yield this.messages.set(r,s)})}shouldIgnoreMessageEvent(t){return g(this,null,function*(){let{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!(yield this.subscriber.isSubscribed(r)))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;let o=this.messages.has(r,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o})}onProviderPayload(t){return g(this,null,function*(){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Xi(t)){if(!t.method.endsWith(xR))return;let r=t.params,{topic:s,message:o,publishedAt:u}=r.data,l={topic:s,message:o,publishedAt:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(YR({type:"event",event:r.id},l)),this.events.emit(r.id,l),yield this.acknowledgePayload(t),yield this.onMessageEvent(l)}else Vr(t)&&this.events.emit(ot.message_ack,t)})}onMessageEvent(t){return g(this,null,function*(){(yield this.shouldIgnoreMessageEvent(t))||(this.events.emit(ot.message,t),yield this.recordMessageEvent(t))})}acknowledgePayload(t){return g(this,null,function*(){let r=Br(t.id,!0);yield this.provider.connection.send(r)})}unregisterProviderListeners(){this.provider.off(Ir.payload,this.onPayloadHandler),this.provider.off(Ir.connect,this.onConnectHandler),this.provider.off(Ir.disconnect,this.onDisconnectHandler),this.provider.off(Ir.error,this.onProviderErrorHandler)}registerEventListeners(){return g(this,null,function*(){this.events.on(ot.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=yield Tc();Vp(r=>g(this,null,function*(){this.initialized&&t!==r&&(t=r,r?yield this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,yield this.transportClose().catch(s=>this.logger.error(s))))}))})}onProviderDisconnect(){this.events.emit(ot.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(()=>g(this,null,function*(){yield this.restartTransport().catch(t=>this.logger.error(t))}),(0,le.toMiliseconds)(PR)))}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}toEstablishConnection(){return g(this,null,function*(){if(yield this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return yield new Promise(t=>{let r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});yield this.restartTransport()}})}},XR=Object.defineProperty,yy=Object.getOwnPropertySymbols,QR=Object.prototype.hasOwnProperty,ZR=Object.prototype.propertyIsEnumerable,my=(n,t,r)=>t in n?XR(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,vy=(n,t)=>{for(var r in t||(t={}))QR.call(t,r)&&my(n,r,t[r]);if(yy)for(var r of yy(t))ZR.call(t,r)&&my(n,r,t[r]);return n},yi=class extends lo{constructor(t,r,s,o=Wr,u=void 0){super(t,r,s,o),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=OR,this.cached=[],this.initialized=!1,this.storagePrefix=Wr,this.init=()=>g(this,null,function*(){this.initialized||(this.logger.trace("Initialized"),yield this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!Zt(l)?this.map.set(this.getKey(l),l):Cp(l)?this.map.set(l.id,l):Np(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)}),this.set=(l,d)=>g(this,null,function*(){this.isInitialized(),this.map.has(l)?yield this.update(l,d):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:d}),this.map.set(l,d),yield this.persist())}),this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(d=>Object.keys(l).every(v=>(0,Ey.default)(d[v],l[v]))):this.values),this.update=(l,d)=>g(this,null,function*(){this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:d});let v=vy(vy({},this.getData(l)),d);this.map.set(l,v),yield this.persist()}),this.delete=(l,d)=>g(this,null,function*(){this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:d}),this.map.delete(l),yield this.persist())}),this.logger=(0,fe.generateChildLogger)(r,this.name),this.storagePrefix=o,this.getKey=u}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}setDataStore(t){return g(this,null,function*(){yield this.core.storage.setItem(this.storageKey,t)})}getDataStore(){return g(this,null,function*(){return yield this.core.storage.getItem(this.storageKey)})}getData(t){let r=this.map.get(t);if(!r){let{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}persist(){return g(this,null,function*(){yield this.setDataStore(this.values)})}restore(){return g(this,null,function*(){try{let t=yield this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){let{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}})}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}},Gu=class{constructor(t,r){this.core=t,this.logger=r,this.name=DR,this.version=LR,this.events=new xr.default,this.initialized=!1,this.storagePrefix=Wr,this.ignoredPayloadTypes=[Kn],this.registeredMethods=[],this.init=()=>g(this,null,function*(){this.initialized||(yield this.pairings.init(),yield this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=()=>g(this,null,function*(){this.isInitialized();let s=Gn(),o=yield this.core.crypto.setSymKey(s),u=At(le.FIVE_MINUTES),l={protocol:eh},d={topic:o,expiry:u,relay:l,active:!1},v=Rp({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:l});return yield this.pairings.set(o,d),yield this.core.relayer.subscribe(o),this.core.expirer.set(o,u),{topic:o,uri:v}}),this.pair=s=>g(this,null,function*(){this.isInitialized(),this.isValidPair(s);let{topic:o,symKey:u,relay:l}=Pc(s.uri),d;if(this.pairings.keys.includes(o)&&(d=this.pairings.get(o),d.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);let v=At(le.FIVE_MINUTES),b={topic:o,relay:l,expiry:v,active:!1};return yield this.pairings.set(o,b),this.core.expirer.set(o,v),s.activatePairing&&(yield this.activate({topic:o})),this.events.emit(ts.create,b),this.core.crypto.keychain.has(o)||(yield this.core.crypto.setSymKey(u,o),yield this.core.relayer.subscribe(o,{relay:l})),b}),this.activate=o=>g(this,[o],function*({topic:s}){this.isInitialized();let u=At(le.THIRTY_DAYS);yield this.pairings.update(s,{active:!0,expiry:u}),this.core.expirer.set(s,u)}),this.ping=s=>g(this,null,function*(){this.isInitialized(),yield this.isValidPing(s);let{topic:o}=s;if(this.pairings.keys.includes(o)){let u=yield this.sendRequest(o,"wc_pairingPing",{}),{done:l,resolve:d,reject:v}=jr();this.events.once(Ue("pairing_ping",u),({error:b})=>{b?v(b):d()}),yield l()}}),this.updateExpiry=u=>g(this,[u],function*({topic:s,expiry:o}){this.isInitialized(),yield this.pairings.update(s,{expiry:o})}),this.updateMetadata=u=>g(this,[u],function*({topic:s,metadata:o}){this.isInitialized(),yield this.pairings.update(s,{peerMetadata:o})}),this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=s=>g(this,null,function*(){this.isInitialized(),yield this.isValidDisconnect(s);let{topic:o}=s;this.pairings.keys.includes(o)&&(yield this.sendRequest(o,"wc_pairingDelete",Ye("USER_DISCONNECTED")),yield this.deletePairing(o))}),this.sendRequest=(s,o,u)=>g(this,null,function*(){let l=ir(o,u),d=yield this.core.crypto.encode(s,l),v=Ks[o].req;return this.core.history.set(s,l),this.core.relayer.publish(s,d,v),l.id}),this.sendResult=(s,o,u)=>g(this,null,function*(){let l=Br(s,u),d=yield this.core.crypto.encode(o,l),v=yield this.core.history.get(o,s),b=Ks[v.request.method].res;yield this.core.relayer.publish(o,d,b),yield this.core.history.resolve(l)}),this.sendError=(s,o,u)=>g(this,null,function*(){let l=_r(s,u),d=yield this.core.crypto.encode(o,l),v=yield this.core.history.get(o,s),b=Ks[v.request.method]?Ks[v.request.method].res:Ks.unregistered_method.res;yield this.core.relayer.publish(o,d,b),yield this.core.history.resolve(l)}),this.deletePairing=(s,o)=>g(this,null,function*(){yield this.core.relayer.unsubscribe(s),yield Promise.all([this.pairings.delete(s,Ye("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])}),this.cleanup=()=>g(this,null,function*(){let s=this.pairings.getAll().filter(o=>Qt(o.expiry));yield Promise.all(s.map(o=>this.deletePairing(o.topic)))}),this.onRelayEventRequest=s=>{let{topic:o,payload:u}=s;switch(u.method){case"wc_pairingPing":return this.onPairingPingRequest(o,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,u);default:return this.onUnknownRpcMethodRequest(o,u)}},this.onRelayEventResponse=s=>g(this,null,function*(){let{topic:o,payload:u}=s,l=(yield this.core.history.get(o,u.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(o,u);default:return this.onUnknownRpcMethodResponse(l)}}),this.onPairingPingRequest=(s,o)=>g(this,null,function*(){let{id:u}=o;try{this.isValidPing({topic:s}),yield this.sendResult(u,s,!0),this.events.emit(ts.ping,{id:u,topic:s})}catch(l){yield this.sendError(u,s,l),this.logger.error(l)}}),this.onPairingPingResponse=(s,o)=>{let{id:u}=o;setTimeout(()=>{Ht(o)?this.events.emit(Ue("pairing_ping",u),{}):yt(o)&&this.events.emit(Ue("pairing_ping",u),{error:o.error})},500)},this.onPairingDeleteRequest=(s,o)=>g(this,null,function*(){let{id:u}=o;try{this.isValidDisconnect({topic:s}),yield this.deletePairing(s),this.events.emit(ts.delete,{id:u,topic:s})}catch(l){yield this.sendError(u,s,l),this.logger.error(l)}}),this.onUnknownRpcMethodRequest=(s,o)=>g(this,null,function*(){let{id:u,method:l}=o;try{if(this.registeredMethods.includes(l))return;let d=Ye("WC_METHOD_UNSUPPORTED",l);yield this.sendError(u,s,d),this.logger.error(d)}catch(d){yield this.sendError(u,s,d),this.logger.error(d)}}),this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Ye("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!ht(s)){let{message:l}=V("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(l)}if(!Ap(s.uri)){let{message:l}=V("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(l)}let u=Pc(s.uri);if(!((o=u?.relay)!=null&&o.protocol)){let{message:l}=V("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(l)}if(!(u!=null&&u.symKey)){let{message:l}=V("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(l)}},this.isValidPing=s=>g(this,null,function*(){if(!ht(s)){let{message:u}=V("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(u)}let{topic:o}=s;yield this.isValidPairingTopic(o)}),this.isValidDisconnect=s=>g(this,null,function*(){if(!ht(s)){let{message:u}=V("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(u)}let{topic:o}=s;yield this.isValidPairingTopic(o)}),this.isValidPairingTopic=s=>g(this,null,function*(){if(!Ur(s,!1)){let{message:o}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){let{message:o}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Qt(this.pairings.get(s).expiry)){yield this.deletePairing(s);let{message:o}=V("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}}),this.core=t,this.logger=(0,fe.generateChildLogger)(r,this.name),this.pairings=new yi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,fe.getLoggerContext)(this.logger)}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(ot.message,t=>g(this,null,function*(){let{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;let o=yield this.core.crypto.decode(r,s);try{Xi(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Vr(o)&&(yield this.core.history.resolve(o),yield this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))}catch(u){this.logger.error(u)}}))}registerExpirerEvents(){this.core.expirer.on(Nt.expired,t=>g(this,null,function*(){let{topic:r}=Jn(t.target);r&&this.pairings.keys.includes(r)&&(yield this.deletePairing(r,!0),this.events.emit(ts.expire,{topic:r}))}))}},Wu=class extends ao{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new xr.EventEmitter,this.name=FR,this.version=qR,this.cached=[],this.initialized=!1,this.storagePrefix=Wr,this.init=()=>g(this,null,function*(){this.initialized||(this.logger.trace("Initialized"),yield this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),this.set=(s,o,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:u}),this.records.has(o.id))return;let l={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:u,expiry:At(le.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(nr.created,l)},this.resolve=s=>g(this,null,function*(){if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;let o=yield this.getRecord(s.id);typeof o.response>"u"&&(o.response=yt(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(nr.updated,o))}),this.get=(s,o)=>g(this,null,function*(){return this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),yield this.getRecord(o)}),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(u=>{if(u.topic===s){if(typeof o<"u"&&u.id!==o)return;this.records.delete(u.id),this.events.emit(nr.deleted,u)}})},this.exists=(s,o)=>g(this,null,function*(){return this.isInitialized(),this.records.has(o)?(yield this.getRecord(o)).topic===s:!1}),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=(0,fe.generateChildLogger)(r,this.name)}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;let s={topic:r.topic,request:ir(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}setJsonRpcRecords(t){return g(this,null,function*(){yield this.core.storage.setItem(this.storageKey,t)})}getJsonRpcRecords(){return g(this,null,function*(){return yield this.core.storage.getItem(this.storageKey)})}getRecord(t){this.isInitialized();let r=this.records.get(t);if(!r){let{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}persist(){return g(this,null,function*(){yield this.setJsonRpcRecords(this.values),this.events.emit(nr.sync)})}restore(){return g(this,null,function*(){try{let t=yield this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){let{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}})}registerEventListeners(){this.events.on(nr.created,t=>{let r=nr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(nr.updated,t=>{let r=nr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(nr.deleted,t=>{let r=nr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(mi.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{(0,le.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}},Ju=class extends po{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new xr.EventEmitter,this.name=MR,this.version=jR,this.cached=[],this.initialized=!1,this.storagePrefix=Wr,this.init=()=>g(this,null,function*(){this.initialized||(this.logger.trace("Initialized"),yield this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),this.has=s=>{try{let o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();let u=this.formatTarget(s),l={target:u,expiry:o};this.expirations.set(u,l),this.checkExpiry(u,l),this.events.emit(Nt.created,{target:u,expiration:l})},this.get=s=>{this.isInitialized();let o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){let o=this.formatTarget(s),u=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Nt.deleted,{target:o,expiration:u})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=(0,fe.generateChildLogger)(r,this.name)}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Ip(t);if(typeof t=="number")return xp(t);let{message:r}=V("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}setExpirations(t){return g(this,null,function*(){yield this.core.storage.setItem(this.storageKey,t)})}getExpirations(){return g(this,null,function*(){return yield this.core.storage.getItem(this.storageKey)})}persist(){return g(this,null,function*(){yield this.setExpirations(this.values),this.events.emit(Nt.sync)})}restore(){return g(this,null,function*(){try{let t=yield this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){let{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}})}getExpiration(t){let r=this.expirations.get(t);if(!r){let{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){let{expiry:s}=r;(0,le.toMiliseconds)(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Nt.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(mi.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Nt.created,t=>{let r=Nt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Nt.expired,t=>{let r=Nt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Nt.deleted,t=>{let r=Nt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}}},Yu=class extends go{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Tu,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=s=>g(this,null,function*(){if(this.verifyDisabled||wp()||!Wn())return;let o=this.getVerifyUrl(s?.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{yield this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Uu;try{yield this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u),this.verifyDisabled=!0}}}),this.register=s=>g(this,null,function*(){this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),yield this.init())}),this.resolve=s=>g(this,null,function*(){if(this.isDevEnv)return"";let o=this.getVerifyUrl(s?.verifyUrl),u;try{u=yield this.fetchAttestation(s.attestationId,o)}catch(l){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(l),u=yield this.fetchAttestation(s.attestationId,Uu)}return u}),this.fetchAttestation=(s,o)=>g(this,null,function*(){this.logger.info(`resolving attestation: ${s} from url: ${o}`);let u=this.startAbortTimer(le.ONE_SECOND*2),l=yield fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(u),l.status===200?yield l.json():void 0}),this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=()=>g(this,null,function*(){let s,o=u=>{u.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};yield Promise.race([new Promise(u=>{if(document.getElementById(Tu))return u();window.addEventListener("message",o);let l=document.createElement("iframe");l.id=Tu,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,s=u}),new Promise((u,l)=>setTimeout(()=>{window.removeEventListener("message",o),l("verify iframe load timeout")},(0,le.toMiliseconds)(le.FIVE_SECONDS)))])}),this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||gi;return UR.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${gi}`),o=gi),o},this.logger=(0,fe.generateChildLogger)(r,this.name),this.verifyUrl=gi,this.abortController=new AbortController,this.isDevEnv=vp()&&process.env.IS_VITEST}get context(){return(0,fe.getLoggerContext)(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,le.toMiliseconds)(t))}},Xu=class extends yo{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.context=zR,this.registerDeviceToken=s=>g(this,null,function*(){let{clientId:o,token:u,notificationType:l,enableEncrypted:d=!1}=s,v=`${$R}/${this.projectId}/clients`;yield(0,Iy.default)(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:l,token:u,always_raw:d})})}),this.logger=(0,fe.generateChildLogger)(r,this.context)}},e6=Object.defineProperty,wy=Object.getOwnPropertySymbols,t6=Object.prototype.hasOwnProperty,r6=Object.prototype.propertyIsEnumerable,_y=(n,t,r)=>t in n?e6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,by=(n,t)=>{for(var r in t||(t={}))t6.call(t,r)&&_y(n,r,t[r]);if(wy)for(var r of wy(t))r6.call(t,r)&&_y(n,r,t[r]);return n},Qu=class n extends oo{constructor(t){super(t),this.protocol=Fy,this.version=lR,this.name=Zu,this.events=new xr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||qy,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";let r=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:(0,fe.pino)((0,fe.getDefaultLoggerOptions)({level:t?.logger||fR.logger}));this.logger=(0,fe.generateChildLogger)(r,this.name),this.heartbeat=new mi.HeartBeat,this.crypto=new $u(this,this.logger,t?.keychain),this.history=new Wu(this,this.logger),this.expirer=new Ju(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new eo(by(by({},pR),t?.storageOptions)),this.relayer=new Ku({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Gu(this,this.logger),this.verify=new Yu(this.projectId||"",this.logger),this.echoClient=new Xu(this.projectId||"",this.logger)}static init(t){return g(this,null,function*(){let r=new n(t);yield r.initialize();let s=yield r.crypto.getClientId();return yield r.storage.setItem(TR,s),r})}get context(){return(0,fe.getLoggerContext)(this.logger)}start(){return g(this,null,function*(){this.initialized||(yield this.initialize())})}initialize(){return g(this,null,function*(){this.logger.trace("Initialized");try{yield this.crypto.init(),yield this.history.init(),yield this.expirer.init(),yield this.relayer.init(),yield this.heartbeat.init(),yield this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}})}},My=Qu;var Jr=je(no());var Go=je(mr()),pe=je(Es());var $y="wc",Hy=2,ky="client",ah=`${$y}@${Hy}:${ky}:`,th={name:ky,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"};var jy="WALLETCONNECT_DEEPLINK_CHOICE";var i6="proposal";var ch="Proposal expired",s6="session",Vo=pe.SEVEN_DAYS,n6="engine",Js={wc_sessionPropose:{req:{ttl:pe.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1104},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1106},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:pe.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:pe.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1112},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:pe.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:pe.THIRTY_SECONDS,prompt:!1,tag:1115}}},rh={min:pe.FIVE_MINUTES,max:pe.SEVEN_DAYS},Pr={idle:"IDLE",active:"ACTIVE"},o6="request",a6=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"],c6=Object.defineProperty,u6=Object.defineProperties,h6=Object.getOwnPropertyDescriptors,Uy=Object.getOwnPropertySymbols,l6=Object.prototype.hasOwnProperty,f6=Object.prototype.propertyIsEnumerable,zy=(n,t,r)=>t in n?c6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Et=(n,t)=>{for(var r in t||(t={}))l6.call(t,r)&&zy(n,r,t[r]);if(Uy)for(var r of Uy(t))f6.call(t,r)&&zy(n,r,t[r]);return n},Ys=(n,t)=>u6(n,h6(t)),ih=class extends vo{constructor(t){super(t),this.name=n6,this.events=new Go.default,this.initialized=!1,this.ignoredPayloadTypes=[Kn],this.requestQueue={state:Pr.idle,queue:[]},this.sessionRequestQueue={state:Pr.idle,queue:[]},this.requestQueueDelay=pe.ONE_SECOND,this.init=()=>g(this,null,function*(){this.initialized||(yield this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Js)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,pe.toMiliseconds)(this.requestQueueDelay)))}),this.connect=r=>g(this,null,function*(){yield this.isInitialized();let s=Ys(Et({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});yield this.isValidConnect(s);let{pairingTopic:o,requiredNamespaces:u,optionalNamespaces:l,sessionProperties:d,relays:v}=s,b=o,y,_=!1;if(b&&(_=this.client.core.pairing.pairings.get(b).active),!b||!_){let{topic:H,uri:z}=yield this.client.core.pairing.create();b=H,y=z}let P=yield this.client.core.crypto.generateKeyPair(),S=Et({requiredNamespaces:u,optionalNamespaces:l,relays:v??[{protocol:eh}],proposer:{publicKey:P,metadata:this.client.metadata}},d&&{sessionProperties:d}),{reject:A,resolve:M,done:q}=jr(pe.FIVE_MINUTES,ch);if(this.events.once(Ue("session_connect"),ee=>g(this,[ee],function*({error:H,session:z}){if(H)A(H);else if(z){z.self.publicKey=P;let se=Ys(Et({},z),{requiredNamespaces:z.requiredNamespaces,optionalNamespaces:z.optionalNamespaces});yield this.client.session.set(z.topic,se),yield this.setExpiry(z.topic,z.expiry),b&&(yield this.client.core.pairing.updateMetadata({topic:b,metadata:z.peer.metadata})),M(se)}})),!b){let{message:H}=V("NO_MATCHING_KEY",`connect() pairing topic: ${b}`);throw new Error(H)}let B=yield this.sendRequest({topic:b,method:"wc_sessionPropose",params:S}),J=At(pe.FIVE_MINUTES);return yield this.setProposal(B,Et({id:B,expiry:J},S)),{uri:y,approval:q}}),this.pair=r=>g(this,null,function*(){return yield this.isInitialized(),yield this.client.core.pairing.pair(r)}),this.approve=r=>g(this,null,function*(){yield this.isInitialized(),yield this.isValidApprove(r);let{id:s,relayProtocol:o,namespaces:u,sessionProperties:l}=r,d=this.client.proposal.get(s),{pairingTopic:v,proposer:b,requiredNamespaces:y,optionalNamespaces:_}=d;v=v||"",zi(y)||(y=Op(u,"approve()"));let P=yield this.client.core.crypto.generateKeyPair(),S=b.publicKey,A=yield this.client.core.crypto.generateSharedKey(P,S);v&&s&&(yield this.client.core.pairing.updateMetadata({topic:v,metadata:b.metadata}),yield this.sendResult({id:s,topic:v,result:{relay:{protocol:o??"irn"},responderPublicKey:P}}),yield this.client.proposal.delete(s,Ye("USER_DISCONNECTED")),yield this.client.core.pairing.activate({topic:v}));let M=Et({relay:{protocol:o??"irn"},namespaces:u,requiredNamespaces:y,optionalNamespaces:_,pairingTopic:v,controller:{publicKey:P,metadata:this.client.metadata},expiry:At(Vo)},l&&{sessionProperties:l});yield this.client.core.relayer.subscribe(A),yield this.sendRequest({topic:A,method:"wc_sessionSettle",params:M,throwOnFailedPublish:!0});let q=Ys(Et({},M),{topic:A,pairingTopic:v,acknowledged:!1,self:M.controller,peer:{publicKey:b.publicKey,metadata:b.metadata},controller:P});return yield this.client.session.set(A,q),yield this.setExpiry(A,At(Vo)),{topic:A,acknowledged:()=>new Promise(B=>setTimeout(()=>B(this.client.session.get(A)),500))}}),this.reject=r=>g(this,null,function*(){yield this.isInitialized(),yield this.isValidReject(r);let{id:s,reason:o}=r,{pairingTopic:u}=this.client.proposal.get(s);u&&(yield this.sendError(s,u,o),yield this.client.proposal.delete(s,Ye("USER_DISCONNECTED")))}),this.update=r=>g(this,null,function*(){yield this.isInitialized(),yield this.isValidUpdate(r);let{topic:s,namespaces:o}=r,u=yield this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:l,resolve:d,reject:v}=jr();return this.events.once(Ue("session_update",u),({error:b})=>{b?v(b):d()}),yield this.client.session.update(s,{namespaces:o}),{acknowledged:l}}),this.extend=r=>g(this,null,function*(){yield this.isInitialized(),yield this.isValidExtend(r);let{topic:s}=r,o=yield this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:u,resolve:l,reject:d}=jr();return this.events.once(Ue("session_extend",o),({error:v})=>{v?d(v):l()}),yield this.setExpiry(s,At(Vo)),{acknowledged:u}}),this.request=r=>g(this,null,function*(){yield this.isInitialized(),yield this.isValidRequest(r);let{chainId:s,request:o,topic:u,expiry:l}=r,d=js(),{done:v,resolve:b,reject:y}=jr(l,"Request expired. Please try again.");return this.events.once(Ue("session_request",d),({error:_,result:P})=>{_?y(_):b(P)}),yield Promise.all([new Promise(_=>g(this,null,function*(){yield this.sendRequest({clientRpcId:d,topic:u,method:"wc_sessionRequest",params:{request:o,chainId:s},expiry:l,throwOnFailedPublish:!0}).catch(P=>y(P)),this.client.events.emit("session_request_sent",{topic:u,request:o,chainId:s,id:d}),_()})),new Promise(_=>g(this,null,function*(){let P=yield Sp(this.client.core.storage,jy);Pp({id:d,topic:u,wcDeepLink:P}),_()})),v()]).then(_=>_[2])}),this.respond=r=>g(this,null,function*(){yield this.isInitialized(),yield this.isValidRespond(r);let{topic:s,response:o}=r,{id:u}=o;Ht(o)?yield this.sendResult({id:u,topic:s,result:o.result,throwOnFailedPublish:!0}):yt(o)&&(yield this.sendError(u,s,o.error)),this.cleanupAfterResponse(r)}),this.ping=r=>g(this,null,function*(){yield this.isInitialized(),yield this.isValidPing(r);let{topic:s}=r;if(this.client.session.keys.includes(s)){let o=yield this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:u,resolve:l,reject:d}=jr();this.events.once(Ue("session_ping",o),({error:v})=>{v?d(v):l()}),yield u()}else this.client.core.pairing.pairings.keys.includes(s)&&(yield this.client.core.pairing.ping({topic:s}))}),this.emit=r=>g(this,null,function*(){yield this.isInitialized(),yield this.isValidEmit(r);let{topic:s,event:o,chainId:u}=r;yield this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:u}})}),this.disconnect=r=>g(this,null,function*(){yield this.isInitialized(),yield this.isValidDisconnect(r);let{topic:s}=r;this.client.session.keys.includes(s)?(yield this.sendRequest({topic:s,method:"wc_sessionDelete",params:Ye("USER_DISCONNECTED"),throwOnFailedPublish:!0}),yield this.deleteSession(s)):yield this.client.core.pairing.disconnect({topic:s})}),this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>Tp(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=r=>g(this,null,function*(){if(r.pairingTopic)try{let s=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(u=>{var l,d;return((l=u.peerMetadata)==null?void 0:l.url)&&((d=u.peerMetadata)==null?void 0:d.url)===r.peer.metadata.url&&u.topic&&u.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),yield Promise.all(o.map(u=>this.client.core.pairing.disconnect({topic:u.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}}),this.deleteSession=(r,s)=>g(this,null,function*(){let{self:o}=this.client.session.get(r);yield this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Ye("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&(yield this.client.core.crypto.deleteKeyPair(o.publicKey)),this.client.core.crypto.keychain.has(r)&&(yield this.client.core.crypto.deleteSymKey(r)),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(jy).catch(u=>this.client.logger.warn(u)),this.getPendingSessionRequests().forEach(u=>{u.topic===r&&this.deletePendingSessionRequest(u.id,Ye("USER_DISCONNECTED"))})}),this.deleteProposal=(r,s)=>g(this,null,function*(){yield Promise.all([this.client.proposal.delete(r,Ye("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])}),this.deletePendingSessionRequest=(r,s,o=!1)=>g(this,null,function*(){yield Promise.all([this.client.pendingRequest.delete(r,s),o?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(u=>u.id!==r),o&&(this.sessionRequestQueue.state=Pr.idle)}),this.setExpiry=(r,s)=>g(this,null,function*(){this.client.session.keys.includes(r)&&(yield this.client.session.update(r,{expiry:s})),this.client.core.expirer.set(r,s)}),this.setProposal=(r,s)=>g(this,null,function*(){yield this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)}),this.setPendingSessionRequest=r=>g(this,null,function*(){let s=Js.wc_sessionRequest.req.ttl,{id:o,topic:u,params:l,verifyContext:d}=r;yield this.client.pendingRequest.set(o,{id:o,topic:u,params:l,verifyContext:d}),s&&this.client.core.expirer.set(o,At(s))}),this.sendRequest=r=>g(this,null,function*(){let{topic:s,method:o,params:u,expiry:l,relayRpcId:d,clientRpcId:v,throwOnFailedPublish:b}=r,y=ir(o,u,v);if(Wn()&&a6.includes(o)){let S=Mr(JSON.stringify(y));this.client.core.verify.register({attestationId:S})}let _=yield this.client.core.crypto.encode(s,y),P=Js[o].req;return l&&(P.ttl=l),d&&(P.id=d),this.client.core.history.set(s,y),b?(P.internal=Ys(Et({},P.internal),{throwOnFailedPublish:!0}),yield this.client.core.relayer.publish(s,_,P)):this.client.core.relayer.publish(s,_,P).catch(S=>this.client.logger.error(S)),y.id}),this.sendResult=r=>g(this,null,function*(){let{id:s,topic:o,result:u,throwOnFailedPublish:l}=r,d=Br(s,u),v=yield this.client.core.crypto.encode(o,d),b=yield this.client.core.history.get(o,s),y=Js[b.request.method].res;l?(y.internal=Ys(Et({},y.internal),{throwOnFailedPublish:!0}),yield this.client.core.relayer.publish(o,v,y)):this.client.core.relayer.publish(o,v,y).catch(_=>this.client.logger.error(_)),yield this.client.core.history.resolve(d)}),this.sendError=(r,s,o)=>g(this,null,function*(){let u=_r(r,o),l=yield this.client.core.crypto.encode(s,u),d=yield this.client.core.history.get(s,r),v=Js[d.request.method].res;this.client.core.relayer.publish(s,l,v),yield this.client.core.history.resolve(u)}),this.cleanup=()=>g(this,null,function*(){let r=[],s=[];this.client.session.getAll().forEach(o=>{Qt(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Qt(o.expiry)&&s.push(o.id)}),yield Promise.all([...r.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])}),this.onRelayEventRequest=r=>g(this,null,function*(){this.requestQueue.queue.push(r),yield this.processRequestsQueue()}),this.processRequestsQueue=()=>g(this,null,function*(){if(this.requestQueue.state===Pr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Pr.active;let r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),yield new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=Pr.idle}),this.processRequest=r=>{let{topic:s,payload:o}=r,u=o.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=r=>g(this,null,function*(){let{topic:s,payload:o}=r,u=(yield this.client.core.history.get(s,o.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${u}`)}}),this.onRelayEventUnknownPayload=r=>{let{topic:s}=r,{message:o}=V("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=(r,s)=>g(this,null,function*(){let{params:o,id:u}=s;try{this.isValidConnect(Et({},s.params));let l=At(pe.FIVE_MINUTES),d=Et({id:u,pairingTopic:r,expiry:l},o);yield this.setProposal(u,d);let v=Mr(JSON.stringify(s)),b=yield this.getVerifyContext(v,d.proposer.metadata);this.client.events.emit("session_proposal",{id:u,params:d,verifyContext:b})}catch(l){yield this.sendError(u,r,l),this.client.logger.error(l)}}),this.onSessionProposeResponse=(r,s)=>g(this,null,function*(){let{id:o}=s;if(Ht(s)){let{result:u}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});let l=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});let d=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});let v=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:v});let b=yield this.client.core.crypto.generateSharedKey(d,v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:b});let y=yield this.client.core.relayer.subscribe(b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:y}),yield this.client.core.pairing.activate({topic:r})}else yt(s)&&(yield this.client.proposal.delete(o,Ye("USER_DISCONNECTED")),this.events.emit(Ue("session_connect"),{error:s.error}))}),this.onSessionSettleRequest=(r,s)=>g(this,null,function*(){let{id:o,params:u}=s;try{this.isValidSessionSettleRequest(u);let{relay:l,controller:d,expiry:v,namespaces:b,requiredNamespaces:y,optionalNamespaces:_,sessionProperties:P,pairingTopic:S}=s.params,A=Et({topic:r,relay:l,expiry:v,namespaces:b,acknowledged:!0,pairingTopic:S,requiredNamespaces:y,optionalNamespaces:_,controller:d.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:d.publicKey,metadata:d.metadata}},P&&{sessionProperties:P});yield this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Ue("session_connect"),{session:A}),this.cleanupDuplicatePairings(A)}catch(l){yield this.sendError(o,r,l),this.client.logger.error(l)}}),this.onSessionSettleResponse=(r,s)=>g(this,null,function*(){let{id:o}=s;Ht(s)?(yield this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ue("session_approve",o),{})):yt(s)&&(yield this.client.session.delete(r,Ye("USER_DISCONNECTED")),this.events.emit(Ue("session_approve",o),{error:s.error}))}),this.onSessionUpdateRequest=(r,s)=>g(this,null,function*(){let{params:o,id:u}=s;try{let l=`${r}_session_update`,d=xs.get(l);if(d&&this.isRequestOutOfSync(d,u)){this.client.logger.info(`Discarding out of sync request - ${u}`);return}this.isValidUpdate(Et({topic:r},o)),yield this.client.session.update(r,{namespaces:o.namespaces}),yield this.sendResult({id:u,topic:r,result:!0}),this.client.events.emit("session_update",{id:u,topic:r,params:o}),xs.set(l,u)}catch(l){yield this.sendError(u,r,l),this.client.logger.error(l)}}),this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{let{id:o}=s;Ht(s)?this.events.emit(Ue("session_update",o),{}):yt(s)&&this.events.emit(Ue("session_update",o),{error:s.error})},this.onSessionExtendRequest=(r,s)=>g(this,null,function*(){let{id:o}=s;try{this.isValidExtend({topic:r}),yield this.setExpiry(r,At(Vo)),yield this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_extend",{id:o,topic:r})}catch(u){yield this.sendError(o,r,u),this.client.logger.error(u)}}),this.onSessionExtendResponse=(r,s)=>{let{id:o}=s;Ht(s)?this.events.emit(Ue("session_extend",o),{}):yt(s)&&this.events.emit(Ue("session_extend",o),{error:s.error})},this.onSessionPingRequest=(r,s)=>g(this,null,function*(){let{id:o}=s;try{this.isValidPing({topic:r}),yield this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_ping",{id:o,topic:r})}catch(u){yield this.sendError(o,r,u),this.client.logger.error(u)}}),this.onSessionPingResponse=(r,s)=>{let{id:o}=s;setTimeout(()=>{Ht(s)?this.events.emit(Ue("session_ping",o),{}):yt(s)&&this.events.emit(Ue("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=(r,s)=>g(this,null,function*(){let{id:o}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),yield Promise.all([new Promise(u=>{this.client.core.relayer.once(ot.publish,()=>g(this,null,function*(){u(yield this.deleteSession(r))}))}),this.sendResult({id:o,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(u){this.client.logger.error(u)}}),this.onSessionRequest=(r,s)=>g(this,null,function*(){let{id:o,params:u}=s;try{this.isValidRequest(Et({topic:r},u));let l=Mr(JSON.stringify(ir("wc_sessionRequest",u,o))),d=this.client.session.get(r),v=yield this.getVerifyContext(l,d.peer.metadata),b={id:o,topic:r,params:u,verifyContext:v};yield this.setPendingSessionRequest(b),this.addSessionRequestToSessionRequestQueue(b),this.processSessionRequestQueue()}catch(l){yield this.sendError(o,r,l),this.client.logger.error(l)}}),this.onSessionRequestResponse=(r,s)=>{let{id:o}=s;Ht(s)?this.events.emit(Ue("session_request",o),{result:s.result}):yt(s)&&this.events.emit(Ue("session_request",o),{error:s.error})},this.onSessionEventRequest=(r,s)=>g(this,null,function*(){let{id:o,params:u}=s;try{let l=`${r}_session_event_${u.event.name}`,d=xs.get(l);if(d&&this.isRequestOutOfSync(d,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(Et({topic:r},u)),this.client.events.emit("session_event",{id:o,topic:r,params:u}),xs.set(l,o)}catch(l){yield this.sendError(o,r,l),this.client.logger.error(l)}}),this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Pr.idle,this.processSessionRequestQueue()},(0,pe.toMiliseconds)(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Pr.active){this.client.logger.info("session request queue is already active.");return}let r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Pr.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;let s=this.client.proposal.getAll().find(o=>o.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,ir("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=r=>g(this,null,function*(){if(!ht(r)){let{message:v}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(v)}let{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:u,sessionProperties:l,relays:d}=r;if(Zt(s)||(yield this.isValidPairingTopic(s)),!qp(d,!0)){let{message:v}=V("MISSING_OR_INVALID",`connect() relays: ${d}`);throw new Error(v)}!Zt(o)&&zi(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!Zt(u)&&zi(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),Zt(l)||this.validateSessionProps(l,"sessionProperties")}),this.validateNamespaces=(r,s)=>{let o=Lp(r,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=r=>g(this,null,function*(){if(!ht(r))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${r}`).message);let{id:s,namespaces:o,relayProtocol:u,sessionProperties:l}=r;yield this.isValidProposalId(s);let d=this.client.proposal.get(s),v=Qn(o,"approve()");if(v)throw new Error(v.message);let b=Oc(d.requiredNamespaces,o,"approve()");if(b)throw new Error(b.message);if(!Ur(u,!0)){let{message:y}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(y)}Zt(l)||this.validateSessionProps(l,"sessionProperties")}),this.isValidReject=r=>g(this,null,function*(){if(!ht(r)){let{message:u}=V("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(u)}let{id:s,reason:o}=r;if(yield this.isValidProposalId(s),!jp(o)){let{message:u}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(u)}}),this.isValidSessionSettleRequest=r=>{if(!ht(r)){let{message:b}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(b)}let{relay:s,controller:o,namespaces:u,expiry:l}=r;if(!Fp(s)){let{message:b}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(b)}let d=Dp(o,"onSessionSettleRequest()");if(d)throw new Error(d.message);let v=Qn(u,"onSessionSettleRequest()");if(v)throw new Error(v.message);if(Qt(l)){let{message:b}=V("EXPIRED","onSessionSettleRequest()");throw new Error(b)}},this.isValidUpdate=r=>g(this,null,function*(){if(!ht(r)){let{message:v}=V("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(v)}let{topic:s,namespaces:o}=r;yield this.isValidSessionTopic(s);let u=this.client.session.get(s),l=Qn(o,"update()");if(l)throw new Error(l.message);let d=Oc(u.requiredNamespaces,o,"update()");if(d)throw new Error(d.message)}),this.isValidExtend=r=>g(this,null,function*(){if(!ht(r)){let{message:o}=V("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}let{topic:s}=r;yield this.isValidSessionTopic(s)}),this.isValidRequest=r=>g(this,null,function*(){if(!ht(r)){let{message:v}=V("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(v)}let{topic:s,request:o,chainId:u,expiry:l}=r;yield this.isValidSessionTopic(s);let{namespaces:d}=this.client.session.get(s);if(!Rc(d,u)){let{message:v}=V("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(v)}if(!Up(o)){let{message:v}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(v)}if(!Hp(d,u,o.method)){let{message:v}=V("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(v)}if(l&&!Bp(l,rh)){let{message:v}=V("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${rh.min} and ${rh.max}`);throw new Error(v)}}),this.isValidRespond=r=>g(this,null,function*(){var s;if(!ht(r)){let{message:l}=V("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}let{topic:o,response:u}=r;try{yield this.isValidSessionTopic(o)}catch(l){throw(s=r?.response)!=null&&s.id&&this.cleanupAfterResponse(r),l}if(!zp(u)){let{message:l}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(u)}`);throw new Error(l)}}),this.isValidPing=r=>g(this,null,function*(){if(!ht(r)){let{message:o}=V("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}let{topic:s}=r;yield this.isValidSessionOrPairingTopic(s)}),this.isValidEmit=r=>g(this,null,function*(){if(!ht(r)){let{message:d}=V("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(d)}let{topic:s,event:o,chainId:u}=r;yield this.isValidSessionTopic(s);let{namespaces:l}=this.client.session.get(s);if(!Rc(l,u)){let{message:d}=V("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(d)}if(!$p(o)){let{message:d}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(d)}if(!kp(l,u,o.name)){let{message:d}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(d)}}),this.isValidDisconnect=r=>g(this,null,function*(){if(!ht(r)){let{message:o}=V("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}let{topic:s}=r;yield this.isValidSessionOrPairingTopic(s)}),this.getVerifyContext=(r,s)=>g(this,null,function*(){let o={verified:{verifyUrl:s.verifyUrl||gi,validation:"UNKNOWN",origin:s.url||""}};try{let u=yield this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});u&&(o.verified.origin=u.origin,o.verified.isScam=u.isScam,o.verified.validation=u.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.info(u)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o}),this.validateSessionProps=(r,s)=>{Object.values(r).forEach(o=>{if(!Ur(o,!1)){let{message:u}=V("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(u)}})}}isInitialized(){return g(this,null,function*(){if(!this.initialized){let{message:t}=V("NOT_INITIALIZED",this.name);throw new Error(t)}yield this.client.core.relayer.confirmOnlineStateOrThrow()})}registerRelayerEvents(){this.client.core.relayer.on(ot.message,t=>g(this,null,function*(){let{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;let o=yield this.client.core.crypto.decode(r,s);try{Xi(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Vr(o)?(yield this.client.core.history.resolve(o),yield this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})}catch(u){this.client.logger.error(u)}}))}registerExpirerEvents(){this.client.core.expirer.on(Nt.expired,t=>g(this,null,function*(){let{topic:r,id:s}=Jn(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return yield this.deletePendingSessionRequest(s,V("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(yield this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(yield this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))}))}registerPairingEvents(){this.client.core.pairing.events.on(ts.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!Ur(t,!1)){let{message:r}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){let{message:r}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Qt(this.client.core.pairing.pairings.get(t).expiry)){let{message:r}=V("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}isValidSessionTopic(t){return g(this,null,function*(){if(!Ur(t,!1)){let{message:r}=V("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){let{message:r}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Qt(this.client.session.get(t).expiry)){yield this.deleteSession(t);let{message:r}=V("EXPIRED",`session topic: ${t}`);throw new Error(r)}})}isValidSessionOrPairingTopic(t){return g(this,null,function*(){if(this.client.session.keys.includes(t))yield this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Ur(t,!1)){let{message:r}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{let{message:r}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}})}isValidProposalId(t){return g(this,null,function*(){if(!Mp(t)){let{message:r}=V("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){let{message:r}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Qt(this.client.proposal.get(t).expiry)){yield this.deleteProposal(t);let{message:r}=V("EXPIRED",`proposal id: ${t}`);throw new Error(r)}})}},sh=class extends yi{constructor(t,r){super(t,r,i6,ah),this.core=t,this.logger=r}},nh=class extends yi{constructor(t,r){super(t,r,s6,ah),this.core=t,this.logger=r}},oh=class extends yi{constructor(t,r){super(t,r,o6,ah,s=>s.id),this.core=t,this.logger=r}},Ko=class n extends mo{constructor(t){super(t),this.protocol=$y,this.version=Hy,this.name=th.name,this.events=new Go.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=s=>g(this,null,function*(){try{return yield this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}}),this.pair=s=>g(this,null,function*(){try{return yield this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}}),this.approve=s=>g(this,null,function*(){try{return yield this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}}),this.reject=s=>g(this,null,function*(){try{return yield this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}}),this.update=s=>g(this,null,function*(){try{return yield this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}}),this.extend=s=>g(this,null,function*(){try{return yield this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}}),this.request=s=>g(this,null,function*(){try{return yield this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}}),this.respond=s=>g(this,null,function*(){try{return yield this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}}),this.ping=s=>g(this,null,function*(){try{return yield this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}}),this.emit=s=>g(this,null,function*(){try{return yield this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}}),this.disconnect=s=>g(this,null,function*(){try{return yield this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}}),this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=t?.name||th.name,this.metadata=t?.metadata||bp();let r=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:(0,Jr.pino)((0,Jr.getDefaultLoggerOptions)({level:t?.logger||th.logger}));this.core=t?.core||new My(t),this.logger=(0,Jr.generateChildLogger)(r,this.name),this.session=new nh(this.core,this.logger),this.proposal=new sh(this.core,this.logger),this.pendingRequest=new oh(this.core,this.logger),this.engine=new ih(this)}static init(t){return g(this,null,function*(){let r=new n(t);return yield r.initialize(),r})}get context(){return(0,Jr.getLoggerContext)(this.logger)}get pairing(){return this.core.pairing.pairings}initialize(){return g(this,null,function*(){this.logger.trace("Initialized");try{yield this.core.start(),yield this.session.init(),yield this.proposal.init(),yield this.pendingRequest.init(),yield this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}})}};var Xo=je(no());var Jy=je(mr()),uh=je(Ky());var p6={Accept:"application/json","Content-Type":"application/json"},d6="POST",Gy={headers:p6,method:d6},Wy=10,Xs=class{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Jy.EventEmitter,this.isAvailable=!1,this.registering=!1,!Ao(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}open(){return g(this,arguments,function*(t=this.url){yield this.register(t)})}close(){return g(this,null,function*(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()})}send(t,r){return g(this,null,function*(){this.isAvailable||(yield this.register());try{let s=$t(t),u=yield(yield(0,uh.default)(this.url,Object.assign(Object.assign({},Gy),{body:s}))).json();this.onPayload({data:u})}catch(s){this.onError(t.id,s)}})}register(){return g(this,arguments,function*(t=this.url){if(!Ao(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){let r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),o(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){let r=$t({id:1,jsonrpc:"2.0",method:"test",params:[]});yield(0,uh.default)(t,Object.assign(Object.assign({},Gy),{body:r}))}this.onOpen()}catch(r){let s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}})}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;let r=typeof t.data=="string"?er(t.data):t.data;this.events.emit("payload",r)}onError(t,r){let s=this.parseError(r),o=s.message||s.toString(),u=_r(t,o);this.events.emit("payload",u)}parseError(t,r=this.url){return Ms(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Wy&&this.events.setMaxListeners(Wy)}},Yy=Xs;var Yr=Yy;var sm=je(mr());var Xy="error",g6="wss://relay.walletconnect.com",y6="wc",m6="universal_provider",Qy=`${y6}@2:${m6}:`,v6="https://rpc.walletconnect.com/v1/",Rr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"},Qs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ph={exports:{}};(function(n,t){(function(){var r,s="4.17.21",o=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",d="Invalid `variable` option passed into `_.template`",v="__lodash_hash_undefined__",b=500,y="__lodash_placeholder__",_=1,P=2,S=4,A=1,M=2,q=1,B=2,J=4,H=8,z=16,ee=32,se=64,T=128,N=256,re=512,x=30,R="...",D=800,U=16,$=1,X=2,we=3,Be=1/0,tt=9007199254740991,wi=17976931348623157e292,Pe=NaN,me=4294967295,Ve=me-1,Ke=me>>>1,ze=[["ary",T],["bind",q],["bindKey",B],["curry",H],["curryRight",z],["flip",re],["partial",ee],["partialRight",se],["rearg",N]],Se="[object Arguments]",De="[object Array]",Ge="[object AsyncFunction]",Ie="[object Boolean]",Te="[object Date]",We="[object DOMException]",Le="[object Error]",Ae="[object Function]",Xe="[object GeneratorFunction]",_e="[object Map]",qe="[object Number]",fm="[object Null]",or="[object Object]",Rh="[object Promise]",pm="[object Proxy]",is="[object RegExp]",kt="[object Set]",ss="[object String]",en="[object Symbol]",dm="[object Undefined]",ns="[object WeakMap]",gm="[object WeakSet]",os="[object ArrayBuffer]",_i="[object DataView]",Zo="[object Float32Array]",ea="[object Float64Array]",ta="[object Int8Array]",ra="[object Int16Array]",ia="[object Int32Array]",sa="[object Uint8Array]",na="[object Uint8ClampedArray]",oa="[object Uint16Array]",aa="[object Uint32Array]",ym=/\b__p \+= '';/g,mm=/\b(__p \+=) '' \+/g,vm=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Oh=/&(?:amp|lt|gt|quot|#39);/g,Th=/[&<>"']/g,wm=RegExp(Oh.source),_m=RegExp(Th.source),bm=/<%-([\s\S]+?)%>/g,Em=/<%([\s\S]+?)%>/g,Ah=/<%=([\s\S]+?)%>/g,Im=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xm=/^\w*$/,Pm=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ca=/[\\^$.*+?()[\]{}|]/g,Sm=RegExp(ca.source),ua=/^\s+/,Rm=/\s/,Om=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Tm=/\{\n\/\* \[wrapped with (.+)\] \*/,Am=/,? & /,Cm=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Nm=/[()=,{}\[\]\/\s]/,Dm=/\\(\\)?/g,Lm=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ch=/\w*$/,Fm=/^[-+]0x[0-9a-f]+$/i,qm=/^0b[01]+$/i,Mm=/^\[object .+?Constructor\]$/,jm=/^0o[0-7]+$/i,Um=/^(?:0|[1-9]\d*)$/,zm=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,tn=/($^)/,$m=/['\n\r\u2028\u2029\\]/g,rn="\\ud800-\\udfff",Hm="\\u0300-\\u036f",km="\\ufe20-\\ufe2f",Bm="\\u20d0-\\u20ff",Nh=Hm+km+Bm,Dh="\\u2700-\\u27bf",Lh="a-z\\xdf-\\xf6\\xf8-\\xff",Vm="\\xac\\xb1\\xd7\\xf7",Km="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Gm="\\u2000-\\u206f",Wm=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fh="A-Z\\xc0-\\xd6\\xd8-\\xde",qh="\\ufe0e\\ufe0f",Mh=Vm+Km+Gm+Wm,ha="['\u2019]",Jm="["+rn+"]",jh="["+Mh+"]",sn="["+Nh+"]",Uh="\\d+",Ym="["+Dh+"]",zh="["+Lh+"]",$h="[^"+rn+Mh+Uh+Dh+Lh+Fh+"]",la="\\ud83c[\\udffb-\\udfff]",Xm="(?:"+sn+"|"+la+")",Hh="[^"+rn+"]",fa="(?:\\ud83c[\\udde6-\\uddff]){2}",pa="[\\ud800-\\udbff][\\udc00-\\udfff]",bi="["+Fh+"]",kh="\\u200d",Bh="(?:"+zh+"|"+$h+")",Qm="(?:"+bi+"|"+$h+")",Vh="(?:"+ha+"(?:d|ll|m|re|s|t|ve))?",Kh="(?:"+ha+"(?:D|LL|M|RE|S|T|VE))?",Gh=Xm+"?",Wh="["+qh+"]?",Zm="(?:"+kh+"(?:"+[Hh,fa,pa].join("|")+")"+Wh+Gh+")*",ev="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",tv="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Jh=Wh+Gh+Zm,rv="(?:"+[Ym,fa,pa].join("|")+")"+Jh,iv="(?:"+[Hh+sn+"?",sn,fa,pa,Jm].join("|")+")",sv=RegExp(ha,"g"),nv=RegExp(sn,"g"),da=RegExp(la+"(?="+la+")|"+iv+Jh,"g"),ov=RegExp([bi+"?"+zh+"+"+Vh+"(?="+[jh,bi,"$"].join("|")+")",Qm+"+"+Kh+"(?="+[jh,bi+Bh,"$"].join("|")+")",bi+"?"+Bh+"+"+Vh,bi+"+"+Kh,tv,ev,Uh,rv].join("|"),"g"),av=RegExp("["+kh+rn+Nh+qh+"]"),cv=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,uv=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],hv=-1,Re={};Re[Zo]=Re[ea]=Re[ta]=Re[ra]=Re[ia]=Re[sa]=Re[na]=Re[oa]=Re[aa]=!0,Re[Se]=Re[De]=Re[os]=Re[Ie]=Re[_i]=Re[Te]=Re[Le]=Re[Ae]=Re[_e]=Re[qe]=Re[or]=Re[is]=Re[kt]=Re[ss]=Re[ns]=!1;var xe={};xe[Se]=xe[De]=xe[os]=xe[_i]=xe[Ie]=xe[Te]=xe[Zo]=xe[ea]=xe[ta]=xe[ra]=xe[ia]=xe[_e]=xe[qe]=xe[or]=xe[is]=xe[kt]=xe[ss]=xe[en]=xe[sa]=xe[na]=xe[oa]=xe[aa]=!0,xe[Le]=xe[Ae]=xe[ns]=!1;var lv={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},fv={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},pv={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},dv={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},gv=parseFloat,yv=parseInt,Yh=typeof Qs=="object"&&Qs&&Qs.Object===Object&&Qs,mv=typeof self=="object"&&self&&self.Object===Object&&self,st=Yh||mv||Function("return this")(),ga=t&&!t.nodeType&&t,Qr=ga&&!0&&n&&!n.nodeType&&n,Xh=Qr&&Qr.exports===ga,ya=Xh&&Yh.process,Dt=function(){try{var E=Qr&&Qr.require&&Qr.require("util").types;return E||ya&&ya.binding&&ya.binding("util")}catch{}}(),Qh=Dt&&Dt.isArrayBuffer,Zh=Dt&&Dt.isDate,el=Dt&&Dt.isMap,tl=Dt&&Dt.isRegExp,rl=Dt&&Dt.isSet,il=Dt&&Dt.isTypedArray;function It(E,C,O){switch(O.length){case 0:return E.call(C);case 1:return E.call(C,O[0]);case 2:return E.call(C,O[0],O[1]);case 3:return E.call(C,O[0],O[1],O[2])}return E.apply(C,O)}function vv(E,C,O,K){for(var te=-1,de=E==null?0:E.length;++te<de;){var Qe=E[te];C(K,Qe,O(Qe),E)}return K}function Lt(E,C){for(var O=-1,K=E==null?0:E.length;++O<K&&C(E[O],O,E)!==!1;);return E}function wv(E,C){for(var O=E==null?0:E.length;O--&&C(E[O],O,E)!==!1;);return E}function sl(E,C){for(var O=-1,K=E==null?0:E.length;++O<K;)if(!C(E[O],O,E))return!1;return!0}function Or(E,C){for(var O=-1,K=E==null?0:E.length,te=0,de=[];++O<K;){var Qe=E[O];C(Qe,O,E)&&(de[te++]=Qe)}return de}function nn(E,C){var O=E==null?0:E.length;return!!O&&Ei(E,C,0)>-1}function ma(E,C,O){for(var K=-1,te=E==null?0:E.length;++K<te;)if(O(C,E[K]))return!0;return!1}function Ce(E,C){for(var O=-1,K=E==null?0:E.length,te=Array(K);++O<K;)te[O]=C(E[O],O,E);return te}function Tr(E,C){for(var O=-1,K=C.length,te=E.length;++O<K;)E[te+O]=C[O];return E}function va(E,C,O,K){var te=-1,de=E==null?0:E.length;for(K&&de&&(O=E[++te]);++te<de;)O=C(O,E[te],te,E);return O}function _v(E,C,O,K){var te=E==null?0:E.length;for(K&&te&&(O=E[--te]);te--;)O=C(O,E[te],te,E);return O}function wa(E,C){for(var O=-1,K=E==null?0:E.length;++O<K;)if(C(E[O],O,E))return!0;return!1}var bv=_a("length");function Ev(E){return E.split("")}function Iv(E){return E.match(Cm)||[]}function nl(E,C,O){var K;return O(E,function(te,de,Qe){if(C(te,de,Qe))return K=de,!1}),K}function on(E,C,O,K){for(var te=E.length,de=O+(K?1:-1);K?de--:++de<te;)if(C(E[de],de,E))return de;return-1}function Ei(E,C,O){return C===C?Fv(E,C,O):on(E,ol,O)}function xv(E,C,O,K){for(var te=O-1,de=E.length;++te<de;)if(K(E[te],C))return te;return-1}function ol(E){return E!==E}function al(E,C){var O=E==null?0:E.length;return O?Ea(E,C)/O:Pe}function _a(E){return function(C){return C==null?r:C[E]}}function ba(E){return function(C){return E==null?r:E[C]}}function cl(E,C,O,K,te){return te(E,function(de,Qe,Ee){O=K?(K=!1,de):C(O,de,Qe,Ee)}),O}function Pv(E,C){var O=E.length;for(E.sort(C);O--;)E[O]=E[O].value;return E}function Ea(E,C){for(var O,K=-1,te=E.length;++K<te;){var de=C(E[K]);de!==r&&(O=O===r?de:O+de)}return O}function Ia(E,C){for(var O=-1,K=Array(E);++O<E;)K[O]=C(O);return K}function Sv(E,C){return Ce(C,function(O){return[O,E[O]]})}function ul(E){return E&&E.slice(0,pl(E)+1).replace(ua,"")}function xt(E){return function(C){return E(C)}}function xa(E,C){return Ce(C,function(O){return E[O]})}function as(E,C){return E.has(C)}function hl(E,C){for(var O=-1,K=E.length;++O<K&&Ei(C,E[O],0)>-1;);return O}function ll(E,C){for(var O=E.length;O--&&Ei(C,E[O],0)>-1;);return O}function Rv(E,C){for(var O=E.length,K=0;O--;)E[O]===C&&++K;return K}var Ov=ba(lv),Tv=ba(fv);function Av(E){return"\\"+dv[E]}function Cv(E,C){return E==null?r:E[C]}function Ii(E){return av.test(E)}function Nv(E){return cv.test(E)}function Dv(E){for(var C,O=[];!(C=E.next()).done;)O.push(C.value);return O}function Pa(E){var C=-1,O=Array(E.size);return E.forEach(function(K,te){O[++C]=[te,K]}),O}function fl(E,C){return function(O){return E(C(O))}}function Ar(E,C){for(var O=-1,K=E.length,te=0,de=[];++O<K;){var Qe=E[O];(Qe===C||Qe===y)&&(E[O]=y,de[te++]=O)}return de}function an(E){var C=-1,O=Array(E.size);return E.forEach(function(K){O[++C]=K}),O}function Lv(E){var C=-1,O=Array(E.size);return E.forEach(function(K){O[++C]=[K,K]}),O}function Fv(E,C,O){for(var K=O-1,te=E.length;++K<te;)if(E[K]===C)return K;return-1}function qv(E,C,O){for(var K=O+1;K--;)if(E[K]===C)return K;return K}function xi(E){return Ii(E)?jv(E):bv(E)}function Bt(E){return Ii(E)?Uv(E):Ev(E)}function pl(E){for(var C=E.length;C--&&Rm.test(E.charAt(C)););return C}var Mv=ba(pv);function jv(E){for(var C=da.lastIndex=0;da.test(E);)++C;return C}function Uv(E){return E.match(da)||[]}function zv(E){return E.match(ov)||[]}var $v=function E(C){C=C==null?st:Pi.defaults(st.Object(),C,Pi.pick(st,uv));var O=C.Array,K=C.Date,te=C.Error,de=C.Function,Qe=C.Math,Ee=C.Object,Sa=C.RegExp,Hv=C.String,Ft=C.TypeError,cn=O.prototype,kv=de.prototype,Si=Ee.prototype,un=C["__core-js_shared__"],hn=kv.toString,ve=Si.hasOwnProperty,Bv=0,dl=function(){var e=/[^.]+$/.exec(un&&un.keys&&un.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ln=Si.toString,Vv=hn.call(Ee),Kv=st._,Gv=Sa("^"+hn.call(ve).replace(ca,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),fn=Xh?C.Buffer:r,Cr=C.Symbol,pn=C.Uint8Array,gl=fn?fn.allocUnsafe:r,dn=fl(Ee.getPrototypeOf,Ee),yl=Ee.create,ml=Si.propertyIsEnumerable,gn=cn.splice,vl=Cr?Cr.isConcatSpreadable:r,cs=Cr?Cr.iterator:r,Zr=Cr?Cr.toStringTag:r,yn=function(){try{var e=si(Ee,"defineProperty");return e({},"",{}),e}catch{}}(),Wv=C.clearTimeout!==st.clearTimeout&&C.clearTimeout,Jv=K&&K.now!==st.Date.now&&K.now,Yv=C.setTimeout!==st.setTimeout&&C.setTimeout,mn=Qe.ceil,vn=Qe.floor,Ra=Ee.getOwnPropertySymbols,Xv=fn?fn.isBuffer:r,wl=C.isFinite,Qv=cn.join,Zv=fl(Ee.keys,Ee),Ze=Qe.max,ct=Qe.min,e0=K.now,t0=C.parseInt,_l=Qe.random,r0=cn.reverse,Oa=si(C,"DataView"),us=si(C,"Map"),Ta=si(C,"Promise"),Ri=si(C,"Set"),hs=si(C,"WeakMap"),ls=si(Ee,"create"),wn=hs&&new hs,Oi={},i0=ni(Oa),s0=ni(us),n0=ni(Ta),o0=ni(Ri),a0=ni(hs),_n=Cr?Cr.prototype:r,fs=_n?_n.valueOf:r,bl=_n?_n.toString:r;function f(e){if(Me(e)&&!ie(e)&&!(e instanceof ue)){if(e instanceof qt)return e;if(ve.call(e,"__wrapped__"))return If(e)}return new qt(e)}var Ti=function(){function e(){}return function(i){if(!Fe(i))return{};if(yl)return yl(i);e.prototype=i;var a=new e;return e.prototype=r,a}}();function bn(){}function qt(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}f.templateSettings={escape:bm,evaluate:Em,interpolate:Ah,variable:"",imports:{_:f}},f.prototype=bn.prototype,f.prototype.constructor=f,qt.prototype=Ti(bn.prototype),qt.prototype.constructor=qt;function ue(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=me,this.__views__=[]}function c0(){var e=new ue(this.__wrapped__);return e.__actions__=mt(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=mt(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=mt(this.__views__),e}function u0(){if(this.__filtered__){var e=new ue(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function h0(){var e=this.__wrapped__.value(),i=this.__dir__,a=ie(e),c=i<0,h=a?e.length:0,p=Ew(0,h,this.__views__),m=p.start,w=p.end,I=w-m,L=c?w:m-1,F=this.__iteratees__,j=F.length,k=0,G=ct(I,this.__takeCount__);if(!a||!c&&h==I&&G==I)return Vl(e,this.__actions__);var Q=[];e:for(;I--&&k<G;){L+=i;for(var oe=-1,Z=e[L];++oe<j;){var ce=F[oe],he=ce.iteratee,Rt=ce.type,pt=he(Z);if(Rt==X)Z=pt;else if(!pt){if(Rt==$)continue e;break e}}Q[k++]=Z}return Q}ue.prototype=Ti(bn.prototype),ue.prototype.constructor=ue;function ei(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var c=e[i];this.set(c[0],c[1])}}function l0(){this.__data__=ls?ls(null):{},this.size=0}function f0(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function p0(e){var i=this.__data__;if(ls){var a=i[e];return a===v?r:a}return ve.call(i,e)?i[e]:r}function d0(e){var i=this.__data__;return ls?i[e]!==r:ve.call(i,e)}function g0(e,i){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=ls&&i===r?v:i,this}ei.prototype.clear=l0,ei.prototype.delete=f0,ei.prototype.get=p0,ei.prototype.has=d0,ei.prototype.set=g0;function ar(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var c=e[i];this.set(c[0],c[1])}}function y0(){this.__data__=[],this.size=0}function m0(e){var i=this.__data__,a=En(i,e);if(a<0)return!1;var c=i.length-1;return a==c?i.pop():gn.call(i,a,1),--this.size,!0}function v0(e){var i=this.__data__,a=En(i,e);return a<0?r:i[a][1]}function w0(e){return En(this.__data__,e)>-1}function _0(e,i){var a=this.__data__,c=En(a,e);return c<0?(++this.size,a.push([e,i])):a[c][1]=i,this}ar.prototype.clear=y0,ar.prototype.delete=m0,ar.prototype.get=v0,ar.prototype.has=w0,ar.prototype.set=_0;function cr(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var c=e[i];this.set(c[0],c[1])}}function b0(){this.size=0,this.__data__={hash:new ei,map:new(us||ar),string:new ei}}function E0(e){var i=Ln(this,e).delete(e);return this.size-=i?1:0,i}function I0(e){return Ln(this,e).get(e)}function x0(e){return Ln(this,e).has(e)}function P0(e,i){var a=Ln(this,e),c=a.size;return a.set(e,i),this.size+=a.size==c?0:1,this}cr.prototype.clear=b0,cr.prototype.delete=E0,cr.prototype.get=I0,cr.prototype.has=x0,cr.prototype.set=P0;function ti(e){var i=-1,a=e==null?0:e.length;for(this.__data__=new cr;++i<a;)this.add(e[i])}function S0(e){return this.__data__.set(e,v),this}function R0(e){return this.__data__.has(e)}ti.prototype.add=ti.prototype.push=S0,ti.prototype.has=R0;function Vt(e){var i=this.__data__=new ar(e);this.size=i.size}function O0(){this.__data__=new ar,this.size=0}function T0(e){var i=this.__data__,a=i.delete(e);return this.size=i.size,a}function A0(e){return this.__data__.get(e)}function C0(e){return this.__data__.has(e)}function N0(e,i){var a=this.__data__;if(a instanceof ar){var c=a.__data__;if(!us||c.length<o-1)return c.push([e,i]),this.size=++a.size,this;a=this.__data__=new cr(c)}return a.set(e,i),this.size=a.size,this}Vt.prototype.clear=O0,Vt.prototype.delete=T0,Vt.prototype.get=A0,Vt.prototype.has=C0,Vt.prototype.set=N0;function El(e,i){var a=ie(e),c=!a&&oi(e),h=!a&&!c&&qr(e),p=!a&&!c&&!h&&Di(e),m=a||c||h||p,w=m?Ia(e.length,Hv):[],I=w.length;for(var L in e)(i||ve.call(e,L))&&!(m&&(L=="length"||h&&(L=="offset"||L=="parent")||p&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||fr(L,I)))&&w.push(L);return w}function Il(e){var i=e.length;return i?e[za(0,i-1)]:r}function D0(e,i){return Fn(mt(e),ri(i,0,e.length))}function L0(e){return Fn(mt(e))}function Aa(e,i,a){(a!==r&&!Kt(e[i],a)||a===r&&!(i in e))&&ur(e,i,a)}function ps(e,i,a){var c=e[i];(!(ve.call(e,i)&&Kt(c,a))||a===r&&!(i in e))&&ur(e,i,a)}function En(e,i){for(var a=e.length;a--;)if(Kt(e[a][0],i))return a;return-1}function F0(e,i,a,c){return Nr(e,function(h,p,m){i(c,h,a(h),m)}),c}function xl(e,i){return e&&Yt(i,rt(i),e)}function q0(e,i){return e&&Yt(i,wt(i),e)}function ur(e,i,a){i=="__proto__"&&yn?yn(e,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[i]=a}function Ca(e,i){for(var a=-1,c=i.length,h=O(c),p=e==null;++a<c;)h[a]=p?r:lc(e,i[a]);return h}function ri(e,i,a){return e===e&&(a!==r&&(e=e<=a?e:a),i!==r&&(e=e>=i?e:i)),e}function Mt(e,i,a,c,h,p){var m,w=i&_,I=i&P,L=i&S;if(a&&(m=h?a(e,c,h,p):a(e)),m!==r)return m;if(!Fe(e))return e;var F=ie(e);if(F){if(m=xw(e),!w)return mt(e,m)}else{var j=ut(e),k=j==Ae||j==Xe;if(qr(e))return Wl(e,w);if(j==or||j==Se||k&&!h){if(m=I||k?{}:df(e),!w)return I?pw(e,q0(m,e)):fw(e,xl(m,e))}else{if(!xe[j])return h?e:{};m=Pw(e,j,w)}}p||(p=new Vt);var G=p.get(e);if(G)return G;p.set(e,m),kf(e)?e.forEach(function(Z){m.add(Mt(Z,i,a,Z,e,p))}):$f(e)&&e.forEach(function(Z,ce){m.set(ce,Mt(Z,i,a,ce,e,p))});var Q=L?I?Xa:Ya:I?wt:rt,oe=F?r:Q(e);return Lt(oe||e,function(Z,ce){oe&&(ce=Z,Z=e[ce]),ps(m,ce,Mt(Z,i,a,ce,e,p))}),m}function M0(e){var i=rt(e);return function(a){return Pl(a,e,i)}}function Pl(e,i,a){var c=a.length;if(e==null)return!c;for(e=Ee(e);c--;){var h=a[c],p=i[h],m=e[h];if(m===r&&!(h in e)||!p(m))return!1}return!0}function Sl(e,i,a){if(typeof e!="function")throw new Ft(l);return _s(function(){e.apply(r,a)},i)}function ds(e,i,a,c){var h=-1,p=nn,m=!0,w=e.length,I=[],L=i.length;if(!w)return I;a&&(i=Ce(i,xt(a))),c?(p=ma,m=!1):i.length>=o&&(p=as,m=!1,i=new ti(i));e:for(;++h<w;){var F=e[h],j=a==null?F:a(F);if(F=c||F!==0?F:0,m&&j===j){for(var k=L;k--;)if(i[k]===j)continue e;I.push(F)}else p(i,j,c)||I.push(F)}return I}var Nr=Zl(Jt),Rl=Zl(Da,!0);function j0(e,i){var a=!0;return Nr(e,function(c,h,p){return a=!!i(c,h,p),a}),a}function In(e,i,a){for(var c=-1,h=e.length;++c<h;){var p=e[c],m=i(p);if(m!=null&&(w===r?m===m&&!St(m):a(m,w)))var w=m,I=p}return I}function U0(e,i,a,c){var h=e.length;for(a=ne(a),a<0&&(a=-a>h?0:h+a),c=c===r||c>h?h:ne(c),c<0&&(c+=h),c=a>c?0:Vf(c);a<c;)e[a++]=i;return e}function Ol(e,i){var a=[];return Nr(e,function(c,h,p){i(c,h,p)&&a.push(c)}),a}function nt(e,i,a,c,h){var p=-1,m=e.length;for(a||(a=Rw),h||(h=[]);++p<m;){var w=e[p];i>0&&a(w)?i>1?nt(w,i-1,a,c,h):Tr(h,w):c||(h[h.length]=w)}return h}var Na=ef(),Tl=ef(!0);function Jt(e,i){return e&&Na(e,i,rt)}function Da(e,i){return e&&Tl(e,i,rt)}function xn(e,i){return Or(i,function(a){return pr(e[a])})}function ii(e,i){i=Lr(i,e);for(var a=0,c=i.length;e!=null&&a<c;)e=e[Xt(i[a++])];return a&&a==c?e:r}function Al(e,i,a){var c=i(e);return ie(e)?c:Tr(c,a(e))}function lt(e){return e==null?e===r?dm:fm:Zr&&Zr in Ee(e)?bw(e):Lw(e)}function La(e,i){return e>i}function z0(e,i){return e!=null&&ve.call(e,i)}function $0(e,i){return e!=null&&i in Ee(e)}function H0(e,i,a){return e>=ct(i,a)&&e<Ze(i,a)}function Fa(e,i,a){for(var c=a?ma:nn,h=e[0].length,p=e.length,m=p,w=O(p),I=1/0,L=[];m--;){var F=e[m];m&&i&&(F=Ce(F,xt(i))),I=ct(F.length,I),w[m]=!a&&(i||h>=120&&F.length>=120)?new ti(m&&F):r}F=e[0];var j=-1,k=w[0];e:for(;++j<h&&L.length<I;){var G=F[j],Q=i?i(G):G;if(G=a||G!==0?G:0,!(k?as(k,Q):c(L,Q,a))){for(m=p;--m;){var oe=w[m];if(!(oe?as(oe,Q):c(e[m],Q,a)))continue e}k&&k.push(Q),L.push(G)}}return L}function k0(e,i,a,c){return Jt(e,function(h,p,m){i(c,a(h),p,m)}),c}function gs(e,i,a){i=Lr(i,e),e=vf(e,i);var c=e==null?e:e[Xt(Ut(i))];return c==null?r:It(c,e,a)}function Cl(e){return Me(e)&&lt(e)==Se}function B0(e){return Me(e)&&lt(e)==os}function V0(e){return Me(e)&&lt(e)==Te}function ys(e,i,a,c,h){return e===i?!0:e==null||i==null||!Me(e)&&!Me(i)?e!==e&&i!==i:K0(e,i,a,c,ys,h)}function K0(e,i,a,c,h,p){var m=ie(e),w=ie(i),I=m?De:ut(e),L=w?De:ut(i);I=I==Se?or:I,L=L==Se?or:L;var F=I==or,j=L==or,k=I==L;if(k&&qr(e)){if(!qr(i))return!1;m=!0,F=!1}if(k&&!F)return p||(p=new Vt),m||Di(e)?lf(e,i,a,c,h,p):ww(e,i,I,a,c,h,p);if(!(a&A)){var G=F&&ve.call(e,"__wrapped__"),Q=j&&ve.call(i,"__wrapped__");if(G||Q){var oe=G?e.value():e,Z=Q?i.value():i;return p||(p=new Vt),h(oe,Z,a,c,p)}}return k?(p||(p=new Vt),_w(e,i,a,c,h,p)):!1}function G0(e){return Me(e)&&ut(e)==_e}function qa(e,i,a,c){var h=a.length,p=h,m=!c;if(e==null)return!p;for(e=Ee(e);h--;){var w=a[h];if(m&&w[2]?w[1]!==e[w[0]]:!(w[0]in e))return!1}for(;++h<p;){w=a[h];var I=w[0],L=e[I],F=w[1];if(m&&w[2]){if(L===r&&!(I in e))return!1}else{var j=new Vt;if(c)var k=c(L,F,I,e,i,j);if(!(k===r?ys(F,L,A|M,c,j):k))return!1}}return!0}function Nl(e){if(!Fe(e)||Tw(e))return!1;var i=pr(e)?Gv:Mm;return i.test(ni(e))}function W0(e){return Me(e)&&lt(e)==is}function J0(e){return Me(e)&&ut(e)==kt}function Y0(e){return Me(e)&&$n(e.length)&&!!Re[lt(e)]}function Dl(e){return typeof e=="function"?e:e==null?_t:typeof e=="object"?ie(e)?ql(e[0],e[1]):Fl(e):rp(e)}function Ma(e){if(!ws(e))return Zv(e);var i=[];for(var a in Ee(e))ve.call(e,a)&&a!="constructor"&&i.push(a);return i}function X0(e){if(!Fe(e))return Dw(e);var i=ws(e),a=[];for(var c in e)c=="constructor"&&(i||!ve.call(e,c))||a.push(c);return a}function ja(e,i){return e<i}function Ll(e,i){var a=-1,c=vt(e)?O(e.length):[];return Nr(e,function(h,p,m){c[++a]=i(h,p,m)}),c}function Fl(e){var i=Za(e);return i.length==1&&i[0][2]?yf(i[0][0],i[0][1]):function(a){return a===e||qa(a,e,i)}}function ql(e,i){return tc(e)&&gf(i)?yf(Xt(e),i):function(a){var c=lc(a,e);return c===r&&c===i?fc(a,e):ys(i,c,A|M)}}function Pn(e,i,a,c,h){e!==i&&Na(i,function(p,m){if(h||(h=new Vt),Fe(p))Q0(e,i,m,a,Pn,c,h);else{var w=c?c(ic(e,m),p,m+"",e,i,h):r;w===r&&(w=p),Aa(e,m,w)}},wt)}function Q0(e,i,a,c,h,p,m){var w=ic(e,a),I=ic(i,a),L=m.get(I);if(L){Aa(e,a,L);return}var F=p?p(w,I,a+"",e,i,m):r,j=F===r;if(j){var k=ie(I),G=!k&&qr(I),Q=!k&&!G&&Di(I);F=I,k||G||Q?ie(w)?F=w:$e(w)?F=mt(w):G?(j=!1,F=Wl(I,!0)):Q?(j=!1,F=Jl(I,!0)):F=[]:bs(I)||oi(I)?(F=w,oi(w)?F=Kf(w):(!Fe(w)||pr(w))&&(F=df(I))):j=!1}j&&(m.set(I,F),h(F,I,c,p,m),m.delete(I)),Aa(e,a,F)}function Ml(e,i){var a=e.length;if(a)return i+=i<0?a:0,fr(i,a)?e[i]:r}function jl(e,i,a){i.length?i=Ce(i,function(p){return ie(p)?function(m){return ii(m,p.length===1?p[0]:p)}:p}):i=[_t];var c=-1;i=Ce(i,xt(Y()));var h=Ll(e,function(p,m,w){var I=Ce(i,function(L){return L(p)});return{criteria:I,index:++c,value:p}});return Pv(h,function(p,m){return lw(p,m,a)})}function Z0(e,i){return Ul(e,i,function(a,c){return fc(e,c)})}function Ul(e,i,a){for(var c=-1,h=i.length,p={};++c<h;){var m=i[c],w=ii(e,m);a(w,m)&&ms(p,Lr(m,e),w)}return p}function ew(e){return function(i){return ii(i,e)}}function Ua(e,i,a,c){var h=c?xv:Ei,p=-1,m=i.length,w=e;for(e===i&&(i=mt(i)),a&&(w=Ce(e,xt(a)));++p<m;)for(var I=0,L=i[p],F=a?a(L):L;(I=h(w,F,I,c))>-1;)w!==e&&gn.call(w,I,1),gn.call(e,I,1);return e}function zl(e,i){for(var a=e?i.length:0,c=a-1;a--;){var h=i[a];if(a==c||h!==p){var p=h;fr(h)?gn.call(e,h,1):ka(e,h)}}return e}function za(e,i){return e+vn(_l()*(i-e+1))}function tw(e,i,a,c){for(var h=-1,p=Ze(mn((i-e)/(a||1)),0),m=O(p);p--;)m[c?p:++h]=e,e+=a;return m}function $a(e,i){var a="";if(!e||i<1||i>tt)return a;do i%2&&(a+=e),i=vn(i/2),i&&(e+=e);while(i);return a}function ae(e,i){return sc(mf(e,i,_t),e+"")}function rw(e){return Il(Li(e))}function iw(e,i){var a=Li(e);return Fn(a,ri(i,0,a.length))}function ms(e,i,a,c){if(!Fe(e))return e;i=Lr(i,e);for(var h=-1,p=i.length,m=p-1,w=e;w!=null&&++h<p;){var I=Xt(i[h]),L=a;if(I==="__proto__"||I==="constructor"||I==="prototype")return e;if(h!=m){var F=w[I];L=c?c(F,I,w):r,L===r&&(L=Fe(F)?F:fr(i[h+1])?[]:{})}ps(w,I,L),w=w[I]}return e}var $l=wn?function(e,i){return wn.set(e,i),e}:_t,sw=yn?function(e,i){return yn(e,"toString",{configurable:!0,enumerable:!1,value:dc(i),writable:!0})}:_t;function nw(e){return Fn(Li(e))}function jt(e,i,a){var c=-1,h=e.length;i<0&&(i=-i>h?0:h+i),a=a>h?h:a,a<0&&(a+=h),h=i>a?0:a-i>>>0,i>>>=0;for(var p=O(h);++c<h;)p[c]=e[c+i];return p}function ow(e,i){var a;return Nr(e,function(c,h,p){return a=i(c,h,p),!a}),!!a}function Sn(e,i,a){var c=0,h=e==null?c:e.length;if(typeof i=="number"&&i===i&&h<=Ke){for(;c<h;){var p=c+h>>>1,m=e[p];m!==null&&!St(m)&&(a?m<=i:m<i)?c=p+1:h=p}return h}return Ha(e,i,_t,a)}function Ha(e,i,a,c){var h=0,p=e==null?0:e.length;if(p===0)return 0;i=a(i);for(var m=i!==i,w=i===null,I=St(i),L=i===r;h<p;){var F=vn((h+p)/2),j=a(e[F]),k=j!==r,G=j===null,Q=j===j,oe=St(j);if(m)var Z=c||Q;else L?Z=Q&&(c||k):w?Z=Q&&k&&(c||!G):I?Z=Q&&k&&!G&&(c||!oe):G||oe?Z=!1:Z=c?j<=i:j<i;Z?h=F+1:p=F}return ct(p,Ve)}function Hl(e,i){for(var a=-1,c=e.length,h=0,p=[];++a<c;){var m=e[a],w=i?i(m):m;if(!a||!Kt(w,I)){var I=w;p[h++]=m===0?0:m}}return p}function kl(e){return typeof e=="number"?e:St(e)?Pe:+e}function Pt(e){if(typeof e=="string")return e;if(ie(e))return Ce(e,Pt)+"";if(St(e))return bl?bl.call(e):"";var i=e+"";return i=="0"&&1/e==-Be?"-0":i}function Dr(e,i,a){var c=-1,h=nn,p=e.length,m=!0,w=[],I=w;if(a)m=!1,h=ma;else if(p>=o){var L=i?null:mw(e);if(L)return an(L);m=!1,h=as,I=new ti}else I=i?[]:w;e:for(;++c<p;){var F=e[c],j=i?i(F):F;if(F=a||F!==0?F:0,m&&j===j){for(var k=I.length;k--;)if(I[k]===j)continue e;i&&I.push(j),w.push(F)}else h(I,j,a)||(I!==w&&I.push(j),w.push(F))}return w}function ka(e,i){return i=Lr(i,e),e=vf(e,i),e==null||delete e[Xt(Ut(i))]}function Bl(e,i,a,c){return ms(e,i,a(ii(e,i)),c)}function Rn(e,i,a,c){for(var h=e.length,p=c?h:-1;(c?p--:++p<h)&&i(e[p],p,e););return a?jt(e,c?0:p,c?p+1:h):jt(e,c?p+1:0,c?h:p)}function Vl(e,i){var a=e;return a instanceof ue&&(a=a.value()),va(i,function(c,h){return h.func.apply(h.thisArg,Tr([c],h.args))},a)}function Ba(e,i,a){var c=e.length;if(c<2)return c?Dr(e[0]):[];for(var h=-1,p=O(c);++h<c;)for(var m=e[h],w=-1;++w<c;)w!=h&&(p[h]=ds(p[h]||m,e[w],i,a));return Dr(nt(p,1),i,a)}function Kl(e,i,a){for(var c=-1,h=e.length,p=i.length,m={};++c<h;){var w=c<p?i[c]:r;a(m,e[c],w)}return m}function Va(e){return $e(e)?e:[]}function Ka(e){return typeof e=="function"?e:_t}function Lr(e,i){return ie(e)?e:tc(e,i)?[e]:Ef(ge(e))}var aw=ae;function Fr(e,i,a){var c=e.length;return a=a===r?c:a,!i&&a>=c?e:jt(e,i,a)}var Gl=Wv||function(e){return st.clearTimeout(e)};function Wl(e,i){if(i)return e.slice();var a=e.length,c=gl?gl(a):new e.constructor(a);return e.copy(c),c}function Ga(e){var i=new e.constructor(e.byteLength);return new pn(i).set(new pn(e)),i}function cw(e,i){var a=i?Ga(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.byteLength)}function uw(e){var i=new e.constructor(e.source,Ch.exec(e));return i.lastIndex=e.lastIndex,i}function hw(e){return fs?Ee(fs.call(e)):{}}function Jl(e,i){var a=i?Ga(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function Yl(e,i){if(e!==i){var a=e!==r,c=e===null,h=e===e,p=St(e),m=i!==r,w=i===null,I=i===i,L=St(i);if(!w&&!L&&!p&&e>i||p&&m&&I&&!w&&!L||c&&m&&I||!a&&I||!h)return 1;if(!c&&!p&&!L&&e<i||L&&a&&h&&!c&&!p||w&&a&&h||!m&&h||!I)return-1}return 0}function lw(e,i,a){for(var c=-1,h=e.criteria,p=i.criteria,m=h.length,w=a.length;++c<m;){var I=Yl(h[c],p[c]);if(I){if(c>=w)return I;var L=a[c];return I*(L=="desc"?-1:1)}}return e.index-i.index}function Xl(e,i,a,c){for(var h=-1,p=e.length,m=a.length,w=-1,I=i.length,L=Ze(p-m,0),F=O(I+L),j=!c;++w<I;)F[w]=i[w];for(;++h<m;)(j||h<p)&&(F[a[h]]=e[h]);for(;L--;)F[w++]=e[h++];return F}function Ql(e,i,a,c){for(var h=-1,p=e.length,m=-1,w=a.length,I=-1,L=i.length,F=Ze(p-w,0),j=O(F+L),k=!c;++h<F;)j[h]=e[h];for(var G=h;++I<L;)j[G+I]=i[I];for(;++m<w;)(k||h<p)&&(j[G+a[m]]=e[h++]);return j}function mt(e,i){var a=-1,c=e.length;for(i||(i=O(c));++a<c;)i[a]=e[a];return i}function Yt(e,i,a,c){var h=!a;a||(a={});for(var p=-1,m=i.length;++p<m;){var w=i[p],I=c?c(a[w],e[w],w,a,e):r;I===r&&(I=e[w]),h?ur(a,w,I):ps(a,w,I)}return a}function fw(e,i){return Yt(e,ec(e),i)}function pw(e,i){return Yt(e,ff(e),i)}function On(e,i){return function(a,c){var h=ie(a)?vv:F0,p=i?i():{};return h(a,e,Y(c,2),p)}}function Ai(e){return ae(function(i,a){var c=-1,h=a.length,p=h>1?a[h-1]:r,m=h>2?a[2]:r;for(p=e.length>3&&typeof p=="function"?(h--,p):r,m&&ft(a[0],a[1],m)&&(p=h<3?r:p,h=1),i=Ee(i);++c<h;){var w=a[c];w&&e(i,w,c,p)}return i})}function Zl(e,i){return function(a,c){if(a==null)return a;if(!vt(a))return e(a,c);for(var h=a.length,p=i?h:-1,m=Ee(a);(i?p--:++p<h)&&c(m[p],p,m)!==!1;);return a}}function ef(e){return function(i,a,c){for(var h=-1,p=Ee(i),m=c(i),w=m.length;w--;){var I=m[e?w:++h];if(a(p[I],I,p)===!1)break}return i}}function dw(e,i,a){var c=i&q,h=vs(e);function p(){var m=this&&this!==st&&this instanceof p?h:e;return m.apply(c?a:this,arguments)}return p}function tf(e){return function(i){i=ge(i);var a=Ii(i)?Bt(i):r,c=a?a[0]:i.charAt(0),h=a?Fr(a,1).join(""):i.slice(1);return c[e]()+h}}function Ci(e){return function(i){return va(ep(Zf(i).replace(sv,"")),e,"")}}function vs(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=Ti(e.prototype),c=e.apply(a,i);return Fe(c)?c:a}}function gw(e,i,a){var c=vs(e);function h(){for(var p=arguments.length,m=O(p),w=p,I=Ni(h);w--;)m[w]=arguments[w];var L=p<3&&m[0]!==I&&m[p-1]!==I?[]:Ar(m,I);if(p-=L.length,p<a)return af(e,i,Tn,h.placeholder,r,m,L,r,r,a-p);var F=this&&this!==st&&this instanceof h?c:e;return It(F,this,m)}return h}function rf(e){return function(i,a,c){var h=Ee(i);if(!vt(i)){var p=Y(a,3);i=rt(i),a=function(w){return p(h[w],w,h)}}var m=e(i,a,c);return m>-1?h[p?i[m]:m]:r}}function sf(e){return lr(function(i){var a=i.length,c=a,h=qt.prototype.thru;for(e&&i.reverse();c--;){var p=i[c];if(typeof p!="function")throw new Ft(l);if(h&&!m&&Dn(p)=="wrapper")var m=new qt([],!0)}for(c=m?c:a;++c<a;){p=i[c];var w=Dn(p),I=w=="wrapper"?Qa(p):r;I&&rc(I[0])&&I[1]==(T|H|ee|N)&&!I[4].length&&I[9]==1?m=m[Dn(I[0])].apply(m,I[3]):m=p.length==1&&rc(p)?m[w]():m.thru(p)}return function(){var L=arguments,F=L[0];if(m&&L.length==1&&ie(F))return m.plant(F).value();for(var j=0,k=a?i[j].apply(this,L):F;++j<a;)k=i[j].call(this,k);return k}})}function Tn(e,i,a,c,h,p,m,w,I,L){var F=i&T,j=i&q,k=i&B,G=i&(H|z),Q=i&re,oe=k?r:vs(e);function Z(){for(var ce=arguments.length,he=O(ce),Rt=ce;Rt--;)he[Rt]=arguments[Rt];if(G)var pt=Ni(Z),Ot=Rv(he,pt);if(c&&(he=Xl(he,c,h,G)),p&&(he=Ql(he,p,m,G)),ce-=Ot,G&&ce<L){var He=Ar(he,pt);return af(e,i,Tn,Z.placeholder,a,he,He,w,I,L-ce)}var Gt=j?a:this,gr=k?Gt[e]:e;return ce=he.length,w?he=Fw(he,w):Q&&ce>1&&he.reverse(),F&&I<ce&&(he.length=I),this&&this!==st&&this instanceof Z&&(gr=oe||vs(gr)),gr.apply(Gt,he)}return Z}function nf(e,i){return function(a,c){return k0(a,e,i(c),{})}}function An(e,i){return function(a,c){var h;if(a===r&&c===r)return i;if(a!==r&&(h=a),c!==r){if(h===r)return c;typeof a=="string"||typeof c=="string"?(a=Pt(a),c=Pt(c)):(a=kl(a),c=kl(c)),h=e(a,c)}return h}}function Wa(e){return lr(function(i){return i=Ce(i,xt(Y())),ae(function(a){var c=this;return e(i,function(h){return It(h,c,a)})})})}function Cn(e,i){i=i===r?" ":Pt(i);var a=i.length;if(a<2)return a?$a(i,e):i;var c=$a(i,mn(e/xi(i)));return Ii(i)?Fr(Bt(c),0,e).join(""):c.slice(0,e)}function yw(e,i,a,c){var h=i&q,p=vs(e);function m(){for(var w=-1,I=arguments.length,L=-1,F=c.length,j=O(F+I),k=this&&this!==st&&this instanceof m?p:e;++L<F;)j[L]=c[L];for(;I--;)j[L++]=arguments[++w];return It(k,h?a:this,j)}return m}function of(e){return function(i,a,c){return c&&typeof c!="number"&&ft(i,a,c)&&(a=c=r),i=dr(i),a===r?(a=i,i=0):a=dr(a),c=c===r?i<a?1:-1:dr(c),tw(i,a,c,e)}}function Nn(e){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=zt(i),a=zt(a)),e(i,a)}}function af(e,i,a,c,h,p,m,w,I,L){var F=i&H,j=F?m:r,k=F?r:m,G=F?p:r,Q=F?r:p;i|=F?ee:se,i&=~(F?se:ee),i&J||(i&=~(q|B));var oe=[e,i,h,G,j,Q,k,w,I,L],Z=a.apply(r,oe);return rc(e)&&wf(Z,oe),Z.placeholder=c,_f(Z,e,i)}function Ja(e){var i=Qe[e];return function(a,c){if(a=zt(a),c=c==null?0:ct(ne(c),292),c&&wl(a)){var h=(ge(a)+"e").split("e"),p=i(h[0]+"e"+(+h[1]+c));return h=(ge(p)+"e").split("e"),+(h[0]+"e"+(+h[1]-c))}return i(a)}}var mw=Ri&&1/an(new Ri([,-0]))[1]==Be?function(e){return new Ri(e)}:mc;function cf(e){return function(i){var a=ut(i);return a==_e?Pa(i):a==kt?Lv(i):Sv(i,e(i))}}function hr(e,i,a,c,h,p,m,w){var I=i&B;if(!I&&typeof e!="function")throw new Ft(l);var L=c?c.length:0;if(L||(i&=~(ee|se),c=h=r),m=m===r?m:Ze(ne(m),0),w=w===r?w:ne(w),L-=h?h.length:0,i&se){var F=c,j=h;c=h=r}var k=I?r:Qa(e),G=[e,i,a,c,h,F,j,p,m,w];if(k&&Nw(G,k),e=G[0],i=G[1],a=G[2],c=G[3],h=G[4],w=G[9]=G[9]===r?I?0:e.length:Ze(G[9]-L,0),!w&&i&(H|z)&&(i&=~(H|z)),!i||i==q)var Q=dw(e,i,a);else i==H||i==z?Q=gw(e,i,w):(i==ee||i==(q|ee))&&!h.length?Q=yw(e,i,a,c):Q=Tn.apply(r,G);var oe=k?$l:wf;return _f(oe(Q,G),e,i)}function uf(e,i,a,c){return e===r||Kt(e,Si[a])&&!ve.call(c,a)?i:e}function hf(e,i,a,c,h,p){return Fe(e)&&Fe(i)&&(p.set(i,e),Pn(e,i,r,hf,p),p.delete(i)),e}function vw(e){return bs(e)?r:e}function lf(e,i,a,c,h,p){var m=a&A,w=e.length,I=i.length;if(w!=I&&!(m&&I>w))return!1;var L=p.get(e),F=p.get(i);if(L&&F)return L==i&&F==e;var j=-1,k=!0,G=a&M?new ti:r;for(p.set(e,i),p.set(i,e);++j<w;){var Q=e[j],oe=i[j];if(c)var Z=m?c(oe,Q,j,i,e,p):c(Q,oe,j,e,i,p);if(Z!==r){if(Z)continue;k=!1;break}if(G){if(!wa(i,function(ce,he){if(!as(G,he)&&(Q===ce||h(Q,ce,a,c,p)))return G.push(he)})){k=!1;break}}else if(!(Q===oe||h(Q,oe,a,c,p))){k=!1;break}}return p.delete(e),p.delete(i),k}function ww(e,i,a,c,h,p,m){switch(a){case _i:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case os:return!(e.byteLength!=i.byteLength||!p(new pn(e),new pn(i)));case Ie:case Te:case qe:return Kt(+e,+i);case Le:return e.name==i.name&&e.message==i.message;case is:case ss:return e==i+"";case _e:var w=Pa;case kt:var I=c&A;if(w||(w=an),e.size!=i.size&&!I)return!1;var L=m.get(e);if(L)return L==i;c|=M,m.set(e,i);var F=lf(w(e),w(i),c,h,p,m);return m.delete(e),F;case en:if(fs)return fs.call(e)==fs.call(i)}return!1}function _w(e,i,a,c,h,p){var m=a&A,w=Ya(e),I=w.length,L=Ya(i),F=L.length;if(I!=F&&!m)return!1;for(var j=I;j--;){var k=w[j];if(!(m?k in i:ve.call(i,k)))return!1}var G=p.get(e),Q=p.get(i);if(G&&Q)return G==i&&Q==e;var oe=!0;p.set(e,i),p.set(i,e);for(var Z=m;++j<I;){k=w[j];var ce=e[k],he=i[k];if(c)var Rt=m?c(he,ce,k,i,e,p):c(ce,he,k,e,i,p);if(!(Rt===r?ce===he||h(ce,he,a,c,p):Rt)){oe=!1;break}Z||(Z=k=="constructor")}if(oe&&!Z){var pt=e.constructor,Ot=i.constructor;pt!=Ot&&"constructor"in e&&"constructor"in i&&!(typeof pt=="function"&&pt instanceof pt&&typeof Ot=="function"&&Ot instanceof Ot)&&(oe=!1)}return p.delete(e),p.delete(i),oe}function lr(e){return sc(mf(e,r,Sf),e+"")}function Ya(e){return Al(e,rt,ec)}function Xa(e){return Al(e,wt,ff)}var Qa=wn?function(e){return wn.get(e)}:mc;function Dn(e){for(var i=e.name+"",a=Oi[i],c=ve.call(Oi,i)?a.length:0;c--;){var h=a[c],p=h.func;if(p==null||p==e)return h.name}return i}function Ni(e){var i=ve.call(f,"placeholder")?f:e;return i.placeholder}function Y(){var e=f.iteratee||gc;return e=e===gc?Dl:e,arguments.length?e(arguments[0],arguments[1]):e}function Ln(e,i){var a=e.__data__;return Ow(i)?a[typeof i=="string"?"string":"hash"]:a.map}function Za(e){for(var i=rt(e),a=i.length;a--;){var c=i[a],h=e[c];i[a]=[c,h,gf(h)]}return i}function si(e,i){var a=Cv(e,i);return Nl(a)?a:r}function bw(e){var i=ve.call(e,Zr),a=e[Zr];try{e[Zr]=r;var c=!0}catch{}var h=ln.call(e);return c&&(i?e[Zr]=a:delete e[Zr]),h}var ec=Ra?function(e){return e==null?[]:(e=Ee(e),Or(Ra(e),function(i){return ml.call(e,i)}))}:vc,ff=Ra?function(e){for(var i=[];e;)Tr(i,ec(e)),e=dn(e);return i}:vc,ut=lt;(Oa&&ut(new Oa(new ArrayBuffer(1)))!=_i||us&&ut(new us)!=_e||Ta&&ut(Ta.resolve())!=Rh||Ri&&ut(new Ri)!=kt||hs&&ut(new hs)!=ns)&&(ut=function(e){var i=lt(e),a=i==or?e.constructor:r,c=a?ni(a):"";if(c)switch(c){case i0:return _i;case s0:return _e;case n0:return Rh;case o0:return kt;case a0:return ns}return i});function Ew(e,i,a){for(var c=-1,h=a.length;++c<h;){var p=a[c],m=p.size;switch(p.type){case"drop":e+=m;break;case"dropRight":i-=m;break;case"take":i=ct(i,e+m);break;case"takeRight":e=Ze(e,i-m);break}}return{start:e,end:i}}function Iw(e){var i=e.match(Tm);return i?i[1].split(Am):[]}function pf(e,i,a){i=Lr(i,e);for(var c=-1,h=i.length,p=!1;++c<h;){var m=Xt(i[c]);if(!(p=e!=null&&a(e,m)))break;e=e[m]}return p||++c!=h?p:(h=e==null?0:e.length,!!h&&$n(h)&&fr(m,h)&&(ie(e)||oi(e)))}function xw(e){var i=e.length,a=new e.constructor(i);return i&&typeof e[0]=="string"&&ve.call(e,"index")&&(a.index=e.index,a.input=e.input),a}function df(e){return typeof e.constructor=="function"&&!ws(e)?Ti(dn(e)):{}}function Pw(e,i,a){var c=e.constructor;switch(i){case os:return Ga(e);case Ie:case Te:return new c(+e);case _i:return cw(e,a);case Zo:case ea:case ta:case ra:case ia:case sa:case na:case oa:case aa:return Jl(e,a);case _e:return new c;case qe:case ss:return new c(e);case is:return uw(e);case kt:return new c;case en:return hw(e)}}function Sw(e,i){var a=i.length;if(!a)return e;var c=a-1;return i[c]=(a>1?"& ":"")+i[c],i=i.join(a>2?", ":" "),e.replace(Om,`{
/* [wrapped with `+i+`] */
`)}function Rw(e){return ie(e)||oi(e)||!!(vl&&e&&e[vl])}function fr(e,i){var a=typeof e;return i=i??tt,!!i&&(a=="number"||a!="symbol"&&Um.test(e))&&e>-1&&e%1==0&&e<i}function ft(e,i,a){if(!Fe(a))return!1;var c=typeof i;return(c=="number"?vt(a)&&fr(i,a.length):c=="string"&&i in a)?Kt(a[i],e):!1}function tc(e,i){if(ie(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||St(e)?!0:xm.test(e)||!Im.test(e)||i!=null&&e in Ee(i)}function Ow(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function rc(e){var i=Dn(e),a=f[i];if(typeof a!="function"||!(i in ue.prototype))return!1;if(e===a)return!0;var c=Qa(a);return!!c&&e===c[0]}function Tw(e){return!!dl&&dl in e}var Aw=un?pr:wc;function ws(e){var i=e&&e.constructor,a=typeof i=="function"&&i.prototype||Si;return e===a}function gf(e){return e===e&&!Fe(e)}function yf(e,i){return function(a){return a==null?!1:a[e]===i&&(i!==r||e in Ee(a))}}function Cw(e){var i=Un(e,function(c){return a.size===b&&a.clear(),c}),a=i.cache;return i}function Nw(e,i){var a=e[1],c=i[1],h=a|c,p=h<(q|B|T),m=c==T&&a==H||c==T&&a==N&&e[7].length<=i[8]||c==(T|N)&&i[7].length<=i[8]&&a==H;if(!(p||m))return e;c&q&&(e[2]=i[2],h|=a&q?0:J);var w=i[3];if(w){var I=e[3];e[3]=I?Xl(I,w,i[4]):w,e[4]=I?Ar(e[3],y):i[4]}return w=i[5],w&&(I=e[5],e[5]=I?Ql(I,w,i[6]):w,e[6]=I?Ar(e[5],y):i[6]),w=i[7],w&&(e[7]=w),c&T&&(e[8]=e[8]==null?i[8]:ct(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=h,e}function Dw(e){var i=[];if(e!=null)for(var a in Ee(e))i.push(a);return i}function Lw(e){return ln.call(e)}function mf(e,i,a){return i=Ze(i===r?e.length-1:i,0),function(){for(var c=arguments,h=-1,p=Ze(c.length-i,0),m=O(p);++h<p;)m[h]=c[i+h];h=-1;for(var w=O(i+1);++h<i;)w[h]=c[h];return w[i]=a(m),It(e,this,w)}}function vf(e,i){return i.length<2?e:ii(e,jt(i,0,-1))}function Fw(e,i){for(var a=e.length,c=ct(i.length,a),h=mt(e);c--;){var p=i[c];e[c]=fr(p,a)?h[p]:r}return e}function ic(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var wf=bf($l),_s=Yv||function(e,i){return st.setTimeout(e,i)},sc=bf(sw);function _f(e,i,a){var c=i+"";return sc(e,Sw(c,qw(Iw(c),a)))}function bf(e){var i=0,a=0;return function(){var c=e0(),h=U-(c-a);if(a=c,h>0){if(++i>=D)return arguments[0]}else i=0;return e.apply(r,arguments)}}function Fn(e,i){var a=-1,c=e.length,h=c-1;for(i=i===r?c:i;++a<i;){var p=za(a,h),m=e[p];e[p]=e[a],e[a]=m}return e.length=i,e}var Ef=Cw(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Pm,function(a,c,h,p){i.push(h?p.replace(Dm,"$1"):c||a)}),i});function Xt(e){if(typeof e=="string"||St(e))return e;var i=e+"";return i=="0"&&1/e==-Be?"-0":i}function ni(e){if(e!=null){try{return hn.call(e)}catch{}try{return e+""}catch{}}return""}function qw(e,i){return Lt(ze,function(a){var c="_."+a[0];i&a[1]&&!nn(e,c)&&e.push(c)}),e.sort()}function If(e){if(e instanceof ue)return e.clone();var i=new qt(e.__wrapped__,e.__chain__);return i.__actions__=mt(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function Mw(e,i,a){(a?ft(e,i,a):i===r)?i=1:i=Ze(ne(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var h=0,p=0,m=O(mn(c/i));h<c;)m[p++]=jt(e,h,h+=i);return m}function jw(e){for(var i=-1,a=e==null?0:e.length,c=0,h=[];++i<a;){var p=e[i];p&&(h[c++]=p)}return h}function Uw(){var e=arguments.length;if(!e)return[];for(var i=O(e-1),a=arguments[0],c=e;c--;)i[c-1]=arguments[c];return Tr(ie(a)?mt(a):[a],nt(i,1))}var zw=ae(function(e,i){return $e(e)?ds(e,nt(i,1,$e,!0)):[]}),$w=ae(function(e,i){var a=Ut(i);return $e(a)&&(a=r),$e(e)?ds(e,nt(i,1,$e,!0),Y(a,2)):[]}),Hw=ae(function(e,i){var a=Ut(i);return $e(a)&&(a=r),$e(e)?ds(e,nt(i,1,$e,!0),r,a):[]});function kw(e,i,a){var c=e==null?0:e.length;return c?(i=a||i===r?1:ne(i),jt(e,i<0?0:i,c)):[]}function Bw(e,i,a){var c=e==null?0:e.length;return c?(i=a||i===r?1:ne(i),i=c-i,jt(e,0,i<0?0:i)):[]}function Vw(e,i){return e&&e.length?Rn(e,Y(i,3),!0,!0):[]}function Kw(e,i){return e&&e.length?Rn(e,Y(i,3),!0):[]}function Gw(e,i,a,c){var h=e==null?0:e.length;return h?(a&&typeof a!="number"&&ft(e,i,a)&&(a=0,c=h),U0(e,i,a,c)):[]}function xf(e,i,a){var c=e==null?0:e.length;if(!c)return-1;var h=a==null?0:ne(a);return h<0&&(h=Ze(c+h,0)),on(e,Y(i,3),h)}function Pf(e,i,a){var c=e==null?0:e.length;if(!c)return-1;var h=c-1;return a!==r&&(h=ne(a),h=a<0?Ze(c+h,0):ct(h,c-1)),on(e,Y(i,3),h,!0)}function Sf(e){var i=e==null?0:e.length;return i?nt(e,1):[]}function Ww(e){var i=e==null?0:e.length;return i?nt(e,Be):[]}function Jw(e,i){var a=e==null?0:e.length;return a?(i=i===r?1:ne(i),nt(e,i)):[]}function Yw(e){for(var i=-1,a=e==null?0:e.length,c={};++i<a;){var h=e[i];c[h[0]]=h[1]}return c}function Rf(e){return e&&e.length?e[0]:r}function Xw(e,i,a){var c=e==null?0:e.length;if(!c)return-1;var h=a==null?0:ne(a);return h<0&&(h=Ze(c+h,0)),Ei(e,i,h)}function Qw(e){var i=e==null?0:e.length;return i?jt(e,0,-1):[]}var Zw=ae(function(e){var i=Ce(e,Va);return i.length&&i[0]===e[0]?Fa(i):[]}),e_=ae(function(e){var i=Ut(e),a=Ce(e,Va);return i===Ut(a)?i=r:a.pop(),a.length&&a[0]===e[0]?Fa(a,Y(i,2)):[]}),t_=ae(function(e){var i=Ut(e),a=Ce(e,Va);return i=typeof i=="function"?i:r,i&&a.pop(),a.length&&a[0]===e[0]?Fa(a,r,i):[]});function r_(e,i){return e==null?"":Qv.call(e,i)}function Ut(e){var i=e==null?0:e.length;return i?e[i-1]:r}function i_(e,i,a){var c=e==null?0:e.length;if(!c)return-1;var h=c;return a!==r&&(h=ne(a),h=h<0?Ze(c+h,0):ct(h,c-1)),i===i?qv(e,i,h):on(e,ol,h,!0)}function s_(e,i){return e&&e.length?Ml(e,ne(i)):r}var n_=ae(Of);function Of(e,i){return e&&e.length&&i&&i.length?Ua(e,i):e}function o_(e,i,a){return e&&e.length&&i&&i.length?Ua(e,i,Y(a,2)):e}function a_(e,i,a){return e&&e.length&&i&&i.length?Ua(e,i,r,a):e}var c_=lr(function(e,i){var a=e==null?0:e.length,c=Ca(e,i);return zl(e,Ce(i,function(h){return fr(h,a)?+h:h}).sort(Yl)),c});function u_(e,i){var a=[];if(!(e&&e.length))return a;var c=-1,h=[],p=e.length;for(i=Y(i,3);++c<p;){var m=e[c];i(m,c,e)&&(a.push(m),h.push(c))}return zl(e,h),a}function nc(e){return e==null?e:r0.call(e)}function h_(e,i,a){var c=e==null?0:e.length;return c?(a&&typeof a!="number"&&ft(e,i,a)?(i=0,a=c):(i=i==null?0:ne(i),a=a===r?c:ne(a)),jt(e,i,a)):[]}function l_(e,i){return Sn(e,i)}function f_(e,i,a){return Ha(e,i,Y(a,2))}function p_(e,i){var a=e==null?0:e.length;if(a){var c=Sn(e,i);if(c<a&&Kt(e[c],i))return c}return-1}function d_(e,i){return Sn(e,i,!0)}function g_(e,i,a){return Ha(e,i,Y(a,2),!0)}function y_(e,i){var a=e==null?0:e.length;if(a){var c=Sn(e,i,!0)-1;if(Kt(e[c],i))return c}return-1}function m_(e){return e&&e.length?Hl(e):[]}function v_(e,i){return e&&e.length?Hl(e,Y(i,2)):[]}function w_(e){var i=e==null?0:e.length;return i?jt(e,1,i):[]}function __(e,i,a){return e&&e.length?(i=a||i===r?1:ne(i),jt(e,0,i<0?0:i)):[]}function b_(e,i,a){var c=e==null?0:e.length;return c?(i=a||i===r?1:ne(i),i=c-i,jt(e,i<0?0:i,c)):[]}function E_(e,i){return e&&e.length?Rn(e,Y(i,3),!1,!0):[]}function I_(e,i){return e&&e.length?Rn(e,Y(i,3)):[]}var x_=ae(function(e){return Dr(nt(e,1,$e,!0))}),P_=ae(function(e){var i=Ut(e);return $e(i)&&(i=r),Dr(nt(e,1,$e,!0),Y(i,2))}),S_=ae(function(e){var i=Ut(e);return i=typeof i=="function"?i:r,Dr(nt(e,1,$e,!0),r,i)});function R_(e){return e&&e.length?Dr(e):[]}function O_(e,i){return e&&e.length?Dr(e,Y(i,2)):[]}function T_(e,i){return i=typeof i=="function"?i:r,e&&e.length?Dr(e,r,i):[]}function oc(e){if(!(e&&e.length))return[];var i=0;return e=Or(e,function(a){if($e(a))return i=Ze(a.length,i),!0}),Ia(i,function(a){return Ce(e,_a(a))})}function Tf(e,i){if(!(e&&e.length))return[];var a=oc(e);return i==null?a:Ce(a,function(c){return It(i,r,c)})}var A_=ae(function(e,i){return $e(e)?ds(e,i):[]}),C_=ae(function(e){return Ba(Or(e,$e))}),N_=ae(function(e){var i=Ut(e);return $e(i)&&(i=r),Ba(Or(e,$e),Y(i,2))}),D_=ae(function(e){var i=Ut(e);return i=typeof i=="function"?i:r,Ba(Or(e,$e),r,i)}),L_=ae(oc);function F_(e,i){return Kl(e||[],i||[],ps)}function q_(e,i){return Kl(e||[],i||[],ms)}var M_=ae(function(e){var i=e.length,a=i>1?e[i-1]:r;return a=typeof a=="function"?(e.pop(),a):r,Tf(e,a)});function Af(e){var i=f(e);return i.__chain__=!0,i}function j_(e,i){return i(e),e}function qn(e,i){return i(e)}var U_=lr(function(e){var i=e.length,a=i?e[0]:0,c=this.__wrapped__,h=function(p){return Ca(p,e)};return i>1||this.__actions__.length||!(c instanceof ue)||!fr(a)?this.thru(h):(c=c.slice(a,+a+(i?1:0)),c.__actions__.push({func:qn,args:[h],thisArg:r}),new qt(c,this.__chain__).thru(function(p){return i&&!p.length&&p.push(r),p}))});function z_(){return Af(this)}function $_(){return new qt(this.value(),this.__chain__)}function H_(){this.__values__===r&&(this.__values__=Bf(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function k_(){return this}function B_(e){for(var i,a=this;a instanceof bn;){var c=If(a);c.__index__=0,c.__values__=r,i?h.__wrapped__=c:i=c;var h=c;a=a.__wrapped__}return h.__wrapped__=e,i}function V_(){var e=this.__wrapped__;if(e instanceof ue){var i=e;return this.__actions__.length&&(i=new ue(this)),i=i.reverse(),i.__actions__.push({func:qn,args:[nc],thisArg:r}),new qt(i,this.__chain__)}return this.thru(nc)}function K_(){return Vl(this.__wrapped__,this.__actions__)}var G_=On(function(e,i,a){ve.call(e,a)?++e[a]:ur(e,a,1)});function W_(e,i,a){var c=ie(e)?sl:j0;return a&&ft(e,i,a)&&(i=r),c(e,Y(i,3))}function J_(e,i){var a=ie(e)?Or:Ol;return a(e,Y(i,3))}var Y_=rf(xf),X_=rf(Pf);function Q_(e,i){return nt(Mn(e,i),1)}function Z_(e,i){return nt(Mn(e,i),Be)}function e1(e,i,a){return a=a===r?1:ne(a),nt(Mn(e,i),a)}function Cf(e,i){var a=ie(e)?Lt:Nr;return a(e,Y(i,3))}function Nf(e,i){var a=ie(e)?wv:Rl;return a(e,Y(i,3))}var t1=On(function(e,i,a){ve.call(e,a)?e[a].push(i):ur(e,a,[i])});function r1(e,i,a,c){e=vt(e)?e:Li(e),a=a&&!c?ne(a):0;var h=e.length;return a<0&&(a=Ze(h+a,0)),Hn(e)?a<=h&&e.indexOf(i,a)>-1:!!h&&Ei(e,i,a)>-1}var i1=ae(function(e,i,a){var c=-1,h=typeof i=="function",p=vt(e)?O(e.length):[];return Nr(e,function(m){p[++c]=h?It(i,m,a):gs(m,i,a)}),p}),s1=On(function(e,i,a){ur(e,a,i)});function Mn(e,i){var a=ie(e)?Ce:Ll;return a(e,Y(i,3))}function n1(e,i,a,c){return e==null?[]:(ie(i)||(i=i==null?[]:[i]),a=c?r:a,ie(a)||(a=a==null?[]:[a]),jl(e,i,a))}var o1=On(function(e,i,a){e[a?0:1].push(i)},function(){return[[],[]]});function a1(e,i,a){var c=ie(e)?va:cl,h=arguments.length<3;return c(e,Y(i,4),a,h,Nr)}function c1(e,i,a){var c=ie(e)?_v:cl,h=arguments.length<3;return c(e,Y(i,4),a,h,Rl)}function u1(e,i){var a=ie(e)?Or:Ol;return a(e,zn(Y(i,3)))}function h1(e){var i=ie(e)?Il:rw;return i(e)}function l1(e,i,a){(a?ft(e,i,a):i===r)?i=1:i=ne(i);var c=ie(e)?D0:iw;return c(e,i)}function f1(e){var i=ie(e)?L0:nw;return i(e)}function p1(e){if(e==null)return 0;if(vt(e))return Hn(e)?xi(e):e.length;var i=ut(e);return i==_e||i==kt?e.size:Ma(e).length}function d1(e,i,a){var c=ie(e)?wa:ow;return a&&ft(e,i,a)&&(i=r),c(e,Y(i,3))}var g1=ae(function(e,i){if(e==null)return[];var a=i.length;return a>1&&ft(e,i[0],i[1])?i=[]:a>2&&ft(i[0],i[1],i[2])&&(i=[i[0]]),jl(e,nt(i,1),[])}),jn=Jv||function(){return st.Date.now()};function y1(e,i){if(typeof i!="function")throw new Ft(l);return e=ne(e),function(){if(--e<1)return i.apply(this,arguments)}}function Df(e,i,a){return i=a?r:i,i=e&&i==null?e.length:i,hr(e,T,r,r,r,r,i)}function Lf(e,i){var a;if(typeof i!="function")throw new Ft(l);return e=ne(e),function(){return--e>0&&(a=i.apply(this,arguments)),e<=1&&(i=r),a}}var ac=ae(function(e,i,a){var c=q;if(a.length){var h=Ar(a,Ni(ac));c|=ee}return hr(e,c,i,a,h)}),Ff=ae(function(e,i,a){var c=q|B;if(a.length){var h=Ar(a,Ni(Ff));c|=ee}return hr(i,c,e,a,h)});function qf(e,i,a){i=a?r:i;var c=hr(e,H,r,r,r,r,r,i);return c.placeholder=qf.placeholder,c}function Mf(e,i,a){i=a?r:i;var c=hr(e,z,r,r,r,r,r,i);return c.placeholder=Mf.placeholder,c}function jf(e,i,a){var c,h,p,m,w,I,L=0,F=!1,j=!1,k=!0;if(typeof e!="function")throw new Ft(l);i=zt(i)||0,Fe(a)&&(F=!!a.leading,j="maxWait"in a,p=j?Ze(zt(a.maxWait)||0,i):p,k="trailing"in a?!!a.trailing:k);function G(He){var Gt=c,gr=h;return c=h=r,L=He,m=e.apply(gr,Gt),m}function Q(He){return L=He,w=_s(ce,i),F?G(He):m}function oe(He){var Gt=He-I,gr=He-L,ip=i-Gt;return j?ct(ip,p-gr):ip}function Z(He){var Gt=He-I,gr=He-L;return I===r||Gt>=i||Gt<0||j&&gr>=p}function ce(){var He=jn();if(Z(He))return he(He);w=_s(ce,oe(He))}function he(He){return w=r,k&&c?G(He):(c=h=r,m)}function Rt(){w!==r&&Gl(w),L=0,c=I=h=w=r}function pt(){return w===r?m:he(jn())}function Ot(){var He=jn(),Gt=Z(He);if(c=arguments,h=this,I=He,Gt){if(w===r)return Q(I);if(j)return Gl(w),w=_s(ce,i),G(I)}return w===r&&(w=_s(ce,i)),m}return Ot.cancel=Rt,Ot.flush=pt,Ot}var m1=ae(function(e,i){return Sl(e,1,i)}),v1=ae(function(e,i,a){return Sl(e,zt(i)||0,a)});function w1(e){return hr(e,re)}function Un(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Ft(l);var a=function(){var c=arguments,h=i?i.apply(this,c):c[0],p=a.cache;if(p.has(h))return p.get(h);var m=e.apply(this,c);return a.cache=p.set(h,m)||p,m};return a.cache=new(Un.Cache||cr),a}Un.Cache=cr;function zn(e){if(typeof e!="function")throw new Ft(l);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function _1(e){return Lf(2,e)}var b1=aw(function(e,i){i=i.length==1&&ie(i[0])?Ce(i[0],xt(Y())):Ce(nt(i,1),xt(Y()));var a=i.length;return ae(function(c){for(var h=-1,p=ct(c.length,a);++h<p;)c[h]=i[h].call(this,c[h]);return It(e,this,c)})}),cc=ae(function(e,i){var a=Ar(i,Ni(cc));return hr(e,ee,r,i,a)}),Uf=ae(function(e,i){var a=Ar(i,Ni(Uf));return hr(e,se,r,i,a)}),E1=lr(function(e,i){return hr(e,N,r,r,r,i)});function I1(e,i){if(typeof e!="function")throw new Ft(l);return i=i===r?i:ne(i),ae(e,i)}function x1(e,i){if(typeof e!="function")throw new Ft(l);return i=i==null?0:Ze(ne(i),0),ae(function(a){var c=a[i],h=Fr(a,0,i);return c&&Tr(h,c),It(e,this,h)})}function P1(e,i,a){var c=!0,h=!0;if(typeof e!="function")throw new Ft(l);return Fe(a)&&(c="leading"in a?!!a.leading:c,h="trailing"in a?!!a.trailing:h),jf(e,i,{leading:c,maxWait:i,trailing:h})}function S1(e){return Df(e,1)}function R1(e,i){return cc(Ka(i),e)}function O1(){if(!arguments.length)return[];var e=arguments[0];return ie(e)?e:[e]}function T1(e){return Mt(e,S)}function A1(e,i){return i=typeof i=="function"?i:r,Mt(e,S,i)}function C1(e){return Mt(e,_|S)}function N1(e,i){return i=typeof i=="function"?i:r,Mt(e,_|S,i)}function D1(e,i){return i==null||Pl(e,i,rt(i))}function Kt(e,i){return e===i||e!==e&&i!==i}var L1=Nn(La),F1=Nn(function(e,i){return e>=i}),oi=Cl(function(){return arguments}())?Cl:function(e){return Me(e)&&ve.call(e,"callee")&&!ml.call(e,"callee")},ie=O.isArray,q1=Qh?xt(Qh):B0;function vt(e){return e!=null&&$n(e.length)&&!pr(e)}function $e(e){return Me(e)&&vt(e)}function M1(e){return e===!0||e===!1||Me(e)&&lt(e)==Ie}var qr=Xv||wc,j1=Zh?xt(Zh):V0;function U1(e){return Me(e)&&e.nodeType===1&&!bs(e)}function z1(e){if(e==null)return!0;if(vt(e)&&(ie(e)||typeof e=="string"||typeof e.splice=="function"||qr(e)||Di(e)||oi(e)))return!e.length;var i=ut(e);if(i==_e||i==kt)return!e.size;if(ws(e))return!Ma(e).length;for(var a in e)if(ve.call(e,a))return!1;return!0}function $1(e,i){return ys(e,i)}function H1(e,i,a){a=typeof a=="function"?a:r;var c=a?a(e,i):r;return c===r?ys(e,i,r,a):!!c}function uc(e){if(!Me(e))return!1;var i=lt(e);return i==Le||i==We||typeof e.message=="string"&&typeof e.name=="string"&&!bs(e)}function k1(e){return typeof e=="number"&&wl(e)}function pr(e){if(!Fe(e))return!1;var i=lt(e);return i==Ae||i==Xe||i==Ge||i==pm}function zf(e){return typeof e=="number"&&e==ne(e)}function $n(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=tt}function Fe(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function Me(e){return e!=null&&typeof e=="object"}var $f=el?xt(el):G0;function B1(e,i){return e===i||qa(e,i,Za(i))}function V1(e,i,a){return a=typeof a=="function"?a:r,qa(e,i,Za(i),a)}function K1(e){return Hf(e)&&e!=+e}function G1(e){if(Aw(e))throw new te(u);return Nl(e)}function W1(e){return e===null}function J1(e){return e==null}function Hf(e){return typeof e=="number"||Me(e)&&lt(e)==qe}function bs(e){if(!Me(e)||lt(e)!=or)return!1;var i=dn(e);if(i===null)return!0;var a=ve.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&hn.call(a)==Vv}var hc=tl?xt(tl):W0;function Y1(e){return zf(e)&&e>=-tt&&e<=tt}var kf=rl?xt(rl):J0;function Hn(e){return typeof e=="string"||!ie(e)&&Me(e)&&lt(e)==ss}function St(e){return typeof e=="symbol"||Me(e)&&lt(e)==en}var Di=il?xt(il):Y0;function X1(e){return e===r}function Q1(e){return Me(e)&&ut(e)==ns}function Z1(e){return Me(e)&&lt(e)==gm}var eb=Nn(ja),tb=Nn(function(e,i){return e<=i});function Bf(e){if(!e)return[];if(vt(e))return Hn(e)?Bt(e):mt(e);if(cs&&e[cs])return Dv(e[cs]());var i=ut(e),a=i==_e?Pa:i==kt?an:Li;return a(e)}function dr(e){if(!e)return e===0?e:0;if(e=zt(e),e===Be||e===-Be){var i=e<0?-1:1;return i*wi}return e===e?e:0}function ne(e){var i=dr(e),a=i%1;return i===i?a?i-a:i:0}function Vf(e){return e?ri(ne(e),0,me):0}function zt(e){if(typeof e=="number")return e;if(St(e))return Pe;if(Fe(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=Fe(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=ul(e);var a=qm.test(e);return a||jm.test(e)?yv(e.slice(2),a?2:8):Fm.test(e)?Pe:+e}function Kf(e){return Yt(e,wt(e))}function rb(e){return e?ri(ne(e),-tt,tt):e===0?e:0}function ge(e){return e==null?"":Pt(e)}var ib=Ai(function(e,i){if(ws(i)||vt(i)){Yt(i,rt(i),e);return}for(var a in i)ve.call(i,a)&&ps(e,a,i[a])}),Gf=Ai(function(e,i){Yt(i,wt(i),e)}),kn=Ai(function(e,i,a,c){Yt(i,wt(i),e,c)}),sb=Ai(function(e,i,a,c){Yt(i,rt(i),e,c)}),nb=lr(Ca);function ob(e,i){var a=Ti(e);return i==null?a:xl(a,i)}var ab=ae(function(e,i){e=Ee(e);var a=-1,c=i.length,h=c>2?i[2]:r;for(h&&ft(i[0],i[1],h)&&(c=1);++a<c;)for(var p=i[a],m=wt(p),w=-1,I=m.length;++w<I;){var L=m[w],F=e[L];(F===r||Kt(F,Si[L])&&!ve.call(e,L))&&(e[L]=p[L])}return e}),cb=ae(function(e){return e.push(r,hf),It(Wf,r,e)});function ub(e,i){return nl(e,Y(i,3),Jt)}function hb(e,i){return nl(e,Y(i,3),Da)}function lb(e,i){return e==null?e:Na(e,Y(i,3),wt)}function fb(e,i){return e==null?e:Tl(e,Y(i,3),wt)}function pb(e,i){return e&&Jt(e,Y(i,3))}function db(e,i){return e&&Da(e,Y(i,3))}function gb(e){return e==null?[]:xn(e,rt(e))}function yb(e){return e==null?[]:xn(e,wt(e))}function lc(e,i,a){var c=e==null?r:ii(e,i);return c===r?a:c}function mb(e,i){return e!=null&&pf(e,i,z0)}function fc(e,i){return e!=null&&pf(e,i,$0)}var vb=nf(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=ln.call(i)),e[i]=a},dc(_t)),wb=nf(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=ln.call(i)),ve.call(e,i)?e[i].push(a):e[i]=[a]},Y),_b=ae(gs);function rt(e){return vt(e)?El(e):Ma(e)}function wt(e){return vt(e)?El(e,!0):X0(e)}function bb(e,i){var a={};return i=Y(i,3),Jt(e,function(c,h,p){ur(a,i(c,h,p),c)}),a}function Eb(e,i){var a={};return i=Y(i,3),Jt(e,function(c,h,p){ur(a,h,i(c,h,p))}),a}var Ib=Ai(function(e,i,a){Pn(e,i,a)}),Wf=Ai(function(e,i,a,c){Pn(e,i,a,c)}),xb=lr(function(e,i){var a={};if(e==null)return a;var c=!1;i=Ce(i,function(p){return p=Lr(p,e),c||(c=p.length>1),p}),Yt(e,Xa(e),a),c&&(a=Mt(a,_|P|S,vw));for(var h=i.length;h--;)ka(a,i[h]);return a});function Pb(e,i){return Jf(e,zn(Y(i)))}var Sb=lr(function(e,i){return e==null?{}:Z0(e,i)});function Jf(e,i){if(e==null)return{};var a=Ce(Xa(e),function(c){return[c]});return i=Y(i),Ul(e,a,function(c,h){return i(c,h[0])})}function Rb(e,i,a){i=Lr(i,e);var c=-1,h=i.length;for(h||(h=1,e=r);++c<h;){var p=e==null?r:e[Xt(i[c])];p===r&&(c=h,p=a),e=pr(p)?p.call(e):p}return e}function Ob(e,i,a){return e==null?e:ms(e,i,a)}function Tb(e,i,a,c){return c=typeof c=="function"?c:r,e==null?e:ms(e,i,a,c)}var Yf=cf(rt),Xf=cf(wt);function Ab(e,i,a){var c=ie(e),h=c||qr(e)||Di(e);if(i=Y(i,4),a==null){var p=e&&e.constructor;h?a=c?new p:[]:Fe(e)?a=pr(p)?Ti(dn(e)):{}:a={}}return(h?Lt:Jt)(e,function(m,w,I){return i(a,m,w,I)}),a}function Cb(e,i){return e==null?!0:ka(e,i)}function Nb(e,i,a){return e==null?e:Bl(e,i,Ka(a))}function Db(e,i,a,c){return c=typeof c=="function"?c:r,e==null?e:Bl(e,i,Ka(a),c)}function Li(e){return e==null?[]:xa(e,rt(e))}function Lb(e){return e==null?[]:xa(e,wt(e))}function Fb(e,i,a){return a===r&&(a=i,i=r),a!==r&&(a=zt(a),a=a===a?a:0),i!==r&&(i=zt(i),i=i===i?i:0),ri(zt(e),i,a)}function qb(e,i,a){return i=dr(i),a===r?(a=i,i=0):a=dr(a),e=zt(e),H0(e,i,a)}function Mb(e,i,a){if(a&&typeof a!="boolean"&&ft(e,i,a)&&(i=a=r),a===r&&(typeof i=="boolean"?(a=i,i=r):typeof e=="boolean"&&(a=e,e=r)),e===r&&i===r?(e=0,i=1):(e=dr(e),i===r?(i=e,e=0):i=dr(i)),e>i){var c=e;e=i,i=c}if(a||e%1||i%1){var h=_l();return ct(e+h*(i-e+gv("1e-"+((h+"").length-1))),i)}return za(e,i)}var jb=Ci(function(e,i,a){return i=i.toLowerCase(),e+(a?Qf(i):i)});function Qf(e){return pc(ge(e).toLowerCase())}function Zf(e){return e=ge(e),e&&e.replace(zm,Ov).replace(nv,"")}function Ub(e,i,a){e=ge(e),i=Pt(i);var c=e.length;a=a===r?c:ri(ne(a),0,c);var h=a;return a-=i.length,a>=0&&e.slice(a,h)==i}function zb(e){return e=ge(e),e&&_m.test(e)?e.replace(Th,Tv):e}function $b(e){return e=ge(e),e&&Sm.test(e)?e.replace(ca,"\\$&"):e}var Hb=Ci(function(e,i,a){return e+(a?"-":"")+i.toLowerCase()}),kb=Ci(function(e,i,a){return e+(a?" ":"")+i.toLowerCase()}),Bb=tf("toLowerCase");function Vb(e,i,a){e=ge(e),i=ne(i);var c=i?xi(e):0;if(!i||c>=i)return e;var h=(i-c)/2;return Cn(vn(h),a)+e+Cn(mn(h),a)}function Kb(e,i,a){e=ge(e),i=ne(i);var c=i?xi(e):0;return i&&c<i?e+Cn(i-c,a):e}function Gb(e,i,a){e=ge(e),i=ne(i);var c=i?xi(e):0;return i&&c<i?Cn(i-c,a)+e:e}function Wb(e,i,a){return a||i==null?i=0:i&&(i=+i),t0(ge(e).replace(ua,""),i||0)}function Jb(e,i,a){return(a?ft(e,i,a):i===r)?i=1:i=ne(i),$a(ge(e),i)}function Yb(){var e=arguments,i=ge(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Xb=Ci(function(e,i,a){return e+(a?"_":"")+i.toLowerCase()});function Qb(e,i,a){return a&&typeof a!="number"&&ft(e,i,a)&&(i=a=r),a=a===r?me:a>>>0,a?(e=ge(e),e&&(typeof i=="string"||i!=null&&!hc(i))&&(i=Pt(i),!i&&Ii(e))?Fr(Bt(e),0,a):e.split(i,a)):[]}var Zb=Ci(function(e,i,a){return e+(a?" ":"")+pc(i)});function eE(e,i,a){return e=ge(e),a=a==null?0:ri(ne(a),0,e.length),i=Pt(i),e.slice(a,a+i.length)==i}function tE(e,i,a){var c=f.templateSettings;a&&ft(e,i,a)&&(i=r),e=ge(e),i=kn({},i,c,uf);var h=kn({},i.imports,c.imports,uf),p=rt(h),m=xa(h,p),w,I,L=0,F=i.interpolate||tn,j="__p += '",k=Sa((i.escape||tn).source+"|"+F.source+"|"+(F===Ah?Lm:tn).source+"|"+(i.evaluate||tn).source+"|$","g"),G="//# sourceURL="+(ve.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++hv+"]")+`
`;e.replace(k,function(Z,ce,he,Rt,pt,Ot){return he||(he=Rt),j+=e.slice(L,Ot).replace($m,Av),ce&&(w=!0,j+=`' +
__e(`+ce+`) +
'`),pt&&(I=!0,j+=`';
`+pt+`;
__p += '`),he&&(j+=`' +
((__t = (`+he+`)) == null ? '' : __t) +
'`),L=Ot+Z.length,Z}),j+=`';
`;var Q=ve.call(i,"variable")&&i.variable;if(!Q)j=`with (obj) {
`+j+`
}
`;else if(Nm.test(Q))throw new te(d);j=(I?j.replace(ym,""):j).replace(mm,"$1").replace(vm,"$1;"),j="function("+(Q||"obj")+`) {
`+(Q?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(I?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+j+`return __p
}`;var oe=tp(function(){return de(p,G+"return "+j).apply(r,m)});if(oe.source=j,uc(oe))throw oe;return oe}function rE(e){return ge(e).toLowerCase()}function iE(e){return ge(e).toUpperCase()}function sE(e,i,a){if(e=ge(e),e&&(a||i===r))return ul(e);if(!e||!(i=Pt(i)))return e;var c=Bt(e),h=Bt(i),p=hl(c,h),m=ll(c,h)+1;return Fr(c,p,m).join("")}function nE(e,i,a){if(e=ge(e),e&&(a||i===r))return e.slice(0,pl(e)+1);if(!e||!(i=Pt(i)))return e;var c=Bt(e),h=ll(c,Bt(i))+1;return Fr(c,0,h).join("")}function oE(e,i,a){if(e=ge(e),e&&(a||i===r))return e.replace(ua,"");if(!e||!(i=Pt(i)))return e;var c=Bt(e),h=hl(c,Bt(i));return Fr(c,h).join("")}function aE(e,i){var a=x,c=R;if(Fe(i)){var h="separator"in i?i.separator:h;a="length"in i?ne(i.length):a,c="omission"in i?Pt(i.omission):c}e=ge(e);var p=e.length;if(Ii(e)){var m=Bt(e);p=m.length}if(a>=p)return e;var w=a-xi(c);if(w<1)return c;var I=m?Fr(m,0,w).join(""):e.slice(0,w);if(h===r)return I+c;if(m&&(w+=I.length-w),hc(h)){if(e.slice(w).search(h)){var L,F=I;for(h.global||(h=Sa(h.source,ge(Ch.exec(h))+"g")),h.lastIndex=0;L=h.exec(F);)var j=L.index;I=I.slice(0,j===r?w:j)}}else if(e.indexOf(Pt(h),w)!=w){var k=I.lastIndexOf(h);k>-1&&(I=I.slice(0,k))}return I+c}function cE(e){return e=ge(e),e&&wm.test(e)?e.replace(Oh,Mv):e}var uE=Ci(function(e,i,a){return e+(a?" ":"")+i.toUpperCase()}),pc=tf("toUpperCase");function ep(e,i,a){return e=ge(e),i=a?r:i,i===r?Nv(e)?zv(e):Iv(e):e.match(i)||[]}var tp=ae(function(e,i){try{return It(e,r,i)}catch(a){return uc(a)?a:new te(a)}}),hE=lr(function(e,i){return Lt(i,function(a){a=Xt(a),ur(e,a,ac(e[a],e))}),e});function lE(e){var i=e==null?0:e.length,a=Y();return e=i?Ce(e,function(c){if(typeof c[1]!="function")throw new Ft(l);return[a(c[0]),c[1]]}):[],ae(function(c){for(var h=-1;++h<i;){var p=e[h];if(It(p[0],this,c))return It(p[1],this,c)}})}function fE(e){return M0(Mt(e,_))}function dc(e){return function(){return e}}function pE(e,i){return e==null||e!==e?i:e}var dE=sf(),gE=sf(!0);function _t(e){return e}function gc(e){return Dl(typeof e=="function"?e:Mt(e,_))}function yE(e){return Fl(Mt(e,_))}function mE(e,i){return ql(e,Mt(i,_))}var vE=ae(function(e,i){return function(a){return gs(a,e,i)}}),wE=ae(function(e,i){return function(a){return gs(e,a,i)}});function yc(e,i,a){var c=rt(i),h=xn(i,c);a==null&&!(Fe(i)&&(h.length||!c.length))&&(a=i,i=e,e=this,h=xn(i,rt(i)));var p=!(Fe(a)&&"chain"in a)||!!a.chain,m=pr(e);return Lt(h,function(w){var I=i[w];e[w]=I,m&&(e.prototype[w]=function(){var L=this.__chain__;if(p||L){var F=e(this.__wrapped__),j=F.__actions__=mt(this.__actions__);return j.push({func:I,args:arguments,thisArg:e}),F.__chain__=L,F}return I.apply(e,Tr([this.value()],arguments))})}),e}function _E(){return st._===this&&(st._=Kv),this}function mc(){}function bE(e){return e=ne(e),ae(function(i){return Ml(i,e)})}var EE=Wa(Ce),IE=Wa(sl),xE=Wa(wa);function rp(e){return tc(e)?_a(Xt(e)):ew(e)}function PE(e){return function(i){return e==null?r:ii(e,i)}}var SE=of(),RE=of(!0);function vc(){return[]}function wc(){return!1}function OE(){return{}}function TE(){return""}function AE(){return!0}function CE(e,i){if(e=ne(e),e<1||e>tt)return[];var a=me,c=ct(e,me);i=Y(i),e-=me;for(var h=Ia(c,i);++a<e;)i(a);return h}function NE(e){return ie(e)?Ce(e,Xt):St(e)?[e]:mt(Ef(ge(e)))}function DE(e){var i=++Bv;return ge(e)+i}var LE=An(function(e,i){return e+i},0),FE=Ja("ceil"),qE=An(function(e,i){return e/i},1),ME=Ja("floor");function jE(e){return e&&e.length?In(e,_t,La):r}function UE(e,i){return e&&e.length?In(e,Y(i,2),La):r}function zE(e){return al(e,_t)}function $E(e,i){return al(e,Y(i,2))}function HE(e){return e&&e.length?In(e,_t,ja):r}function kE(e,i){return e&&e.length?In(e,Y(i,2),ja):r}var BE=An(function(e,i){return e*i},1),VE=Ja("round"),KE=An(function(e,i){return e-i},0);function GE(e){return e&&e.length?Ea(e,_t):0}function WE(e,i){return e&&e.length?Ea(e,Y(i,2)):0}return f.after=y1,f.ary=Df,f.assign=ib,f.assignIn=Gf,f.assignInWith=kn,f.assignWith=sb,f.at=nb,f.before=Lf,f.bind=ac,f.bindAll=hE,f.bindKey=Ff,f.castArray=O1,f.chain=Af,f.chunk=Mw,f.compact=jw,f.concat=Uw,f.cond=lE,f.conforms=fE,f.constant=dc,f.countBy=G_,f.create=ob,f.curry=qf,f.curryRight=Mf,f.debounce=jf,f.defaults=ab,f.defaultsDeep=cb,f.defer=m1,f.delay=v1,f.difference=zw,f.differenceBy=$w,f.differenceWith=Hw,f.drop=kw,f.dropRight=Bw,f.dropRightWhile=Vw,f.dropWhile=Kw,f.fill=Gw,f.filter=J_,f.flatMap=Q_,f.flatMapDeep=Z_,f.flatMapDepth=e1,f.flatten=Sf,f.flattenDeep=Ww,f.flattenDepth=Jw,f.flip=w1,f.flow=dE,f.flowRight=gE,f.fromPairs=Yw,f.functions=gb,f.functionsIn=yb,f.groupBy=t1,f.initial=Qw,f.intersection=Zw,f.intersectionBy=e_,f.intersectionWith=t_,f.invert=vb,f.invertBy=wb,f.invokeMap=i1,f.iteratee=gc,f.keyBy=s1,f.keys=rt,f.keysIn=wt,f.map=Mn,f.mapKeys=bb,f.mapValues=Eb,f.matches=yE,f.matchesProperty=mE,f.memoize=Un,f.merge=Ib,f.mergeWith=Wf,f.method=vE,f.methodOf=wE,f.mixin=yc,f.negate=zn,f.nthArg=bE,f.omit=xb,f.omitBy=Pb,f.once=_1,f.orderBy=n1,f.over=EE,f.overArgs=b1,f.overEvery=IE,f.overSome=xE,f.partial=cc,f.partialRight=Uf,f.partition=o1,f.pick=Sb,f.pickBy=Jf,f.property=rp,f.propertyOf=PE,f.pull=n_,f.pullAll=Of,f.pullAllBy=o_,f.pullAllWith=a_,f.pullAt=c_,f.range=SE,f.rangeRight=RE,f.rearg=E1,f.reject=u1,f.remove=u_,f.rest=I1,f.reverse=nc,f.sampleSize=l1,f.set=Ob,f.setWith=Tb,f.shuffle=f1,f.slice=h_,f.sortBy=g1,f.sortedUniq=m_,f.sortedUniqBy=v_,f.split=Qb,f.spread=x1,f.tail=w_,f.take=__,f.takeRight=b_,f.takeRightWhile=E_,f.takeWhile=I_,f.tap=j_,f.throttle=P1,f.thru=qn,f.toArray=Bf,f.toPairs=Yf,f.toPairsIn=Xf,f.toPath=NE,f.toPlainObject=Kf,f.transform=Ab,f.unary=S1,f.union=x_,f.unionBy=P_,f.unionWith=S_,f.uniq=R_,f.uniqBy=O_,f.uniqWith=T_,f.unset=Cb,f.unzip=oc,f.unzipWith=Tf,f.update=Nb,f.updateWith=Db,f.values=Li,f.valuesIn=Lb,f.without=A_,f.words=ep,f.wrap=R1,f.xor=C_,f.xorBy=N_,f.xorWith=D_,f.zip=L_,f.zipObject=F_,f.zipObjectDeep=q_,f.zipWith=M_,f.entries=Yf,f.entriesIn=Xf,f.extend=Gf,f.extendWith=kn,yc(f,f),f.add=LE,f.attempt=tp,f.camelCase=jb,f.capitalize=Qf,f.ceil=FE,f.clamp=Fb,f.clone=T1,f.cloneDeep=C1,f.cloneDeepWith=N1,f.cloneWith=A1,f.conformsTo=D1,f.deburr=Zf,f.defaultTo=pE,f.divide=qE,f.endsWith=Ub,f.eq=Kt,f.escape=zb,f.escapeRegExp=$b,f.every=W_,f.find=Y_,f.findIndex=xf,f.findKey=ub,f.findLast=X_,f.findLastIndex=Pf,f.findLastKey=hb,f.floor=ME,f.forEach=Cf,f.forEachRight=Nf,f.forIn=lb,f.forInRight=fb,f.forOwn=pb,f.forOwnRight=db,f.get=lc,f.gt=L1,f.gte=F1,f.has=mb,f.hasIn=fc,f.head=Rf,f.identity=_t,f.includes=r1,f.indexOf=Xw,f.inRange=qb,f.invoke=_b,f.isArguments=oi,f.isArray=ie,f.isArrayBuffer=q1,f.isArrayLike=vt,f.isArrayLikeObject=$e,f.isBoolean=M1,f.isBuffer=qr,f.isDate=j1,f.isElement=U1,f.isEmpty=z1,f.isEqual=$1,f.isEqualWith=H1,f.isError=uc,f.isFinite=k1,f.isFunction=pr,f.isInteger=zf,f.isLength=$n,f.isMap=$f,f.isMatch=B1,f.isMatchWith=V1,f.isNaN=K1,f.isNative=G1,f.isNil=J1,f.isNull=W1,f.isNumber=Hf,f.isObject=Fe,f.isObjectLike=Me,f.isPlainObject=bs,f.isRegExp=hc,f.isSafeInteger=Y1,f.isSet=kf,f.isString=Hn,f.isSymbol=St,f.isTypedArray=Di,f.isUndefined=X1,f.isWeakMap=Q1,f.isWeakSet=Z1,f.join=r_,f.kebabCase=Hb,f.last=Ut,f.lastIndexOf=i_,f.lowerCase=kb,f.lowerFirst=Bb,f.lt=eb,f.lte=tb,f.max=jE,f.maxBy=UE,f.mean=zE,f.meanBy=$E,f.min=HE,f.minBy=kE,f.stubArray=vc,f.stubFalse=wc,f.stubObject=OE,f.stubString=TE,f.stubTrue=AE,f.multiply=BE,f.nth=s_,f.noConflict=_E,f.noop=mc,f.now=jn,f.pad=Vb,f.padEnd=Kb,f.padStart=Gb,f.parseInt=Wb,f.random=Mb,f.reduce=a1,f.reduceRight=c1,f.repeat=Jb,f.replace=Yb,f.result=Rb,f.round=VE,f.runInContext=E,f.sample=h1,f.size=p1,f.snakeCase=Xb,f.some=d1,f.sortedIndex=l_,f.sortedIndexBy=f_,f.sortedIndexOf=p_,f.sortedLastIndex=d_,f.sortedLastIndexBy=g_,f.sortedLastIndexOf=y_,f.startCase=Zb,f.startsWith=eE,f.subtract=KE,f.sum=GE,f.sumBy=WE,f.template=tE,f.times=CE,f.toFinite=dr,f.toInteger=ne,f.toLength=Vf,f.toLower=rE,f.toNumber=zt,f.toSafeInteger=rb,f.toString=ge,f.toUpper=iE,f.trim=sE,f.trimEnd=nE,f.trimStart=oE,f.truncate=aE,f.unescape=cE,f.uniqueId=DE,f.upperCase=uE,f.upperFirst=pc,f.each=Cf,f.eachRight=Nf,f.first=Rf,yc(f,function(){var e={};return Jt(f,function(i,a){ve.call(f.prototype,a)||(e[a]=i)}),e}(),{chain:!1}),f.VERSION=s,Lt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),Lt(["drop","take"],function(e,i){ue.prototype[e]=function(a){a=a===r?1:Ze(ne(a),0);var c=this.__filtered__&&!i?new ue(this):this.clone();return c.__filtered__?c.__takeCount__=ct(a,c.__takeCount__):c.__views__.push({size:ct(a,me),type:e+(c.__dir__<0?"Right":"")}),c},ue.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),Lt(["filter","map","takeWhile"],function(e,i){var a=i+1,c=a==$||a==we;ue.prototype[e]=function(h){var p=this.clone();return p.__iteratees__.push({iteratee:Y(h,3),type:a}),p.__filtered__=p.__filtered__||c,p}}),Lt(["head","last"],function(e,i){var a="take"+(i?"Right":"");ue.prototype[e]=function(){return this[a](1).value()[0]}}),Lt(["initial","tail"],function(e,i){var a="drop"+(i?"":"Right");ue.prototype[e]=function(){return this.__filtered__?new ue(this):this[a](1)}}),ue.prototype.compact=function(){return this.filter(_t)},ue.prototype.find=function(e){return this.filter(e).head()},ue.prototype.findLast=function(e){return this.reverse().find(e)},ue.prototype.invokeMap=ae(function(e,i){return typeof e=="function"?new ue(this):this.map(function(a){return gs(a,e,i)})}),ue.prototype.reject=function(e){return this.filter(zn(Y(e)))},ue.prototype.slice=function(e,i){e=ne(e);var a=this;return a.__filtered__&&(e>0||i<0)?new ue(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),i!==r&&(i=ne(i),a=i<0?a.dropRight(-i):a.take(i-e)),a)},ue.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},ue.prototype.toArray=function(){return this.take(me)},Jt(ue.prototype,function(e,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),h=f[c?"take"+(i=="last"?"Right":""):i],p=c||/^find/.test(i);h&&(f.prototype[i]=function(){var m=this.__wrapped__,w=c?[1]:arguments,I=m instanceof ue,L=w[0],F=I||ie(m),j=function(ce){var he=h.apply(f,Tr([ce],w));return c&&k?he[0]:he};F&&a&&typeof L=="function"&&L.length!=1&&(I=F=!1);var k=this.__chain__,G=!!this.__actions__.length,Q=p&&!k,oe=I&&!G;if(!p&&F){m=oe?m:new ue(this);var Z=e.apply(m,w);return Z.__actions__.push({func:qn,args:[j],thisArg:r}),new qt(Z,k)}return Q&&oe?e.apply(this,w):(Z=this.thru(j),Q?c?Z.value()[0]:Z.value():Z)})}),Lt(["pop","push","shift","sort","splice","unshift"],function(e){var i=cn[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var h=arguments;if(c&&!this.__chain__){var p=this.value();return i.apply(ie(p)?p:[],h)}return this[a](function(m){return i.apply(ie(m)?m:[],h)})}}),Jt(ue.prototype,function(e,i){var a=f[i];if(a){var c=a.name+"";ve.call(Oi,c)||(Oi[c]=[]),Oi[c].push({name:i,func:a})}}),Oi[Tn(r,B).name]=[{name:"wrapper",func:r}],ue.prototype.clone=c0,ue.prototype.reverse=u0,ue.prototype.value=h0,f.prototype.at=U_,f.prototype.chain=z_,f.prototype.commit=$_,f.prototype.next=H_,f.prototype.plant=B_,f.prototype.reverse=V_,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=K_,f.prototype.first=f.prototype.head,cs&&(f.prototype[cs]=k_),f},Pi=$v();Qr?((Qr.exports=Pi)._=Pi,ga._=Pi):st._=Pi}).call(Qs)})(ph,ph.exports);var w6=Object.defineProperty,_6=Object.defineProperties,b6=Object.getOwnPropertyDescriptors,Zy=Object.getOwnPropertySymbols,E6=Object.prototype.hasOwnProperty,I6=Object.prototype.propertyIsEnumerable,em=(n,t,r)=>t in n?w6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Jo=(n,t)=>{for(var r in t||(t={}))E6.call(t,r)&&em(n,r,t[r]);if(Zy)for(var r of Zy(t))I6.call(t,r)&&em(n,r,t[r]);return n},x6=(n,t)=>_6(n,b6(t));function Xr(n,t,r){var s;let o=ap(n);return((s=t.rpcMap)==null?void 0:s[o.reference])||`${v6}?chainId=${o.namespace}:${o.reference}&projectId=${r}`}function vi(n){return n.includes(":")?n.split(":")[1]:n}function nm(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function P6(n,t){let r=Object.keys(t.namespaces).filter(o=>o.includes(n));if(!r.length)return[];let s=[];return r.forEach(o=>{let u=t.namespaces[o].accounts;s.push(...u)}),s}function S6(n={},t={}){let r=tm(n),s=tm(t);return ph.exports.merge(r,s)}function tm(n){var t,r,s,o;let u={};if(!zi(n))return u;for(let[l,d]of Object.entries(n)){let v=Sc(l)?[l]:d.chains,b=d.methods||[],y=d.events||[],_=d.rpcMap||{},P=Ui(l);u[P]=x6(Jo(Jo({},u[P]),d),{chains:Yn(v,(t=u[P])==null?void 0:t.chains),methods:Yn(b,(r=u[P])==null?void 0:r.methods),events:Yn(y,(s=u[P])==null?void 0:s.events),rpcMap:Jo(Jo({},_),(o=u[P])==null?void 0:o.rpcMap)})}return u}function R6(n){return n.includes(":")?n.split(":")[2]:n}function O6(n){let t={};for(let[r,s]of Object.entries(n)){let o=s.methods||[],u=s.events||[],l=s.accounts||[],d=Sc(r)?[r]:s.chains?s.chains:nm(s.accounts);t[r]={chains:d,methods:o,events:u,accounts:l}}return t}function hh(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}var om={},Ne=n=>om[n],lh=(n,t)=>{om[n]=t},dh=class{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){let t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){let t={};return this.namespace.chains.forEach(r=>{var s;let o=vi(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){let t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){let s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){let s=r||Xr(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ct(new Yr(s,Ne("disableProviderPing")))}},gh=class{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Ne("events"),this.client=Ne("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}request(t){return g(this,null,function*(){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return yield this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?yield this.client.request(t):this.getHttpProvider().request(t.request)})}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){let s=r||Xr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ct(new Xs(s,Ne("disableProviderPing")))}setHttpProvider(t,r){let s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){let t={};return this.namespace.chains.forEach(r=>{var s;let o=parseInt(vi(r));t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){let t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}handleSwitchChain(t){return g(this,null,function*(){var r,s;let o=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;let u=parseInt(o,16);if(this.isChainApproved(u))this.setDefaultChain(`${u}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))yield this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${u}`);else throw new Error(`Failed to switch to chain 'eip155:${u}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null})}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}},yh=class{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){let t={};return this.namespace.chains.forEach(r=>{var s;let o=vi(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){let t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){let s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){let s=r||Xr(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ct(new Yr(s,Ne("disableProviderPing")))}},mh=class{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){let t={};return this.namespace.chains.forEach(r=>{var s;let o=vi(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){let t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){let s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){let s=r||Xr(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ct(new Yr(s,Ne("disableProviderPing")))}},vh=class{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){let t={};return this.namespace.chains.forEach(r=>{let s=this.getCardanoRPCUrl(r),o=vi(r);t[o]=this.createHttpProvider(o,s)}),t}getHttpProvider(){let t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){let r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){let s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){let s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ct(new Yr(s,Ne("disableProviderPing")))}},wh=class{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){let t={};return this.namespace.chains.forEach(r=>{var s;let o=vi(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){let t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){let s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){let s=r||Xr(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ct(new Yr(s,Ne("disableProviderPing")))}},_h=class{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){let t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){let t={};return this.namespace.chains.forEach(r=>{var s;let o=vi(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){let t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){let s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){let s=r||Xr(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ct(new Yr(s,Ne("disableProviderPing")))}},bh=class{constructor(t){this.name="near",this.namespace=t.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){let s=r||Xr(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){let t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){let t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){let s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){let s=r||Xr(t,this.namespace);return typeof s>"u"?void 0:new Ct(new Yr(s,Ne("disableProviderPing")))}},T6=Object.defineProperty,A6=Object.defineProperties,C6=Object.getOwnPropertyDescriptors,rm=Object.getOwnPropertySymbols,N6=Object.prototype.hasOwnProperty,D6=Object.prototype.propertyIsEnumerable,im=(n,t,r)=>t in n?T6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Yo=(n,t)=>{for(var r in t||(t={}))N6.call(t,r)&&im(n,r,t[r]);if(rm)for(var r of rm(t))D6.call(t,r)&&im(n,r,t[r]);return n},fh=(n,t)=>A6(n,C6(t)),Eh=class n{constructor(t){this.events=new sm.default,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:(0,Xo.pino)((0,Xo.getDefaultLoggerOptions)({level:t?.logger||Xy})),this.disableProviderPing=t?.disableProviderPing||!1}static init(t){return g(this,null,function*(){let r=new n(t);return yield r.initialize(),r})}request(t,r){return g(this,null,function*(){let[s,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return yield this.getProvider(s).request({request:Yo({},t),chainId:`${s}:${o}`,topic:this.session.topic})})}sendAsync(t,r,s){let o=new Date().getTime();this.request(t,s).then(u=>r(null,Br(o,u))).catch(u=>r(u,void 0))}enable(){return g(this,null,function*(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||(yield this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties})),yield this.requestAccounts()})}disconnect(){return g(this,null,function*(){var t;if(!this.session)throw new Error("Please call connect() before enable()");yield this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Ye("USER_DISCONNECTED")}),yield this.cleanup()})}connect(t){return g(this,null,function*(){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),yield this.cleanupPendingPairings(),!t.skipPairing)return yield this.pair(t.pairingTopic)})}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}pair(t){return g(this,null,function*(){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");let{uri:s,approval:o}=yield this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),yield o().then(u=>{this.session=u,this.namespaces||(this.namespaces=O6(u.namespaces),this.persist("namespaces",this.namespaces))}).catch(u=>{if(u.message!==ch)throw u;r++})}while(!this.session);return this.onConnect(),this.session})}setDefaultChain(t,r){try{if(!this.session)return;let[s,o]=this.validateChain(t);this.getProvider(s).setDefaultChain(o,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}cleanupPendingPairings(){return g(this,arguments,function*(t={}){this.logger.info("Cleaning up inactive pairings...");let r=this.client.pairing.getAll();if(vr(r)){for(let s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):yield this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}})}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}checkStorage(){return g(this,null,function*(){if(this.namespaces=yield this.getFromStore("namespaces"),this.optionalNamespaces=(yield this.getFromStore("optionalNamespaces"))||{},this.client.session.length){let t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}})}initialize(){return g(this,null,function*(){this.logger.trace("Initialized"),yield this.createClient(),yield this.checkStorage(),this.registerEventListeners()})}createClient(){return g(this,null,function*(){this.client=this.providerOpts.client||(yield Ko.init({logger:this.providerOpts.logger||Xy,relayUrl:this.providerOpts.relayUrl||g6,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name})),this.logger.trace("SignClient Initialized")})}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");let t=[...new Set(Object.keys(this.session.namespaces).map(r=>Ui(r)))];lh("client",this.client),lh("events",this.events),lh("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;let s=P6(r,this.session),o=nm(s),u=S6(this.namespaces,this.optionalNamespaces),l=fh(Yo({},u[r]),{accounts:s,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new gh({namespace:l});break;case"solana":this.rpcProviders[r]=new yh({namespace:l});break;case"cosmos":this.rpcProviders[r]=new mh({namespace:l});break;case"polkadot":this.rpcProviders[r]=new dh({namespace:l});break;case"cip34":this.rpcProviders[r]=new vh({namespace:l});break;case"elrond":this.rpcProviders[r]=new wh({namespace:l});break;case"multiversx":this.rpcProviders[r]=new _h({namespace:l});break;case"near":this.rpcProviders[r]=new bh({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{let{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){let o=s.data;o&&vr(o)&&this.events.emit("accountsChanged",o.map(R6))}else if(s.name==="chainChanged"){let o=r.chainId,u=r.event.data,l=Ui(o),d=hh(o)!==hh(u)?`${l}:${hh(u)}`:o;this.onChainChanged(d)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;let{namespaces:o}=r,u=(s=this.client)==null?void 0:s.session.get(t);this.session=fh(Yo({},u),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",t=>g(this,null,function*(){yield this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",fh(Yo({},Ye("USER_DISCONNECTED")),{data:t.topic}))})),this.on(Rr.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){let{namespaces:r,optionalNamespaces:s,sessionProperties:o}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){let[r,s]=t?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(l=>Ui(l)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];let o=Ui(Object.keys(this.namespaces)[0]),u=this.rpcProviders[o].getDefaultChain();return[o,u]}requestAccounts(){return g(this,null,function*(){let[t]=this.validateChain();return yield this.getProvider(t).requestAccounts()})}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;let[o,u]=this.validateChain(t);r||this.getProvider(o).setDefaultChain(u),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${u}`]).defaultChain=u,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",u)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}cleanup(){return g(this,null,function*(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),yield this.cleanupPendingPairings({deletePairings:!0})})}persist(t,r){this.client.core.storage.setItem(`${Qy}/${t}`,r)}getFromStore(t){return g(this,null,function*(){return yield this.client.core.storage.getItem(`${Qy}/${t}`)})}},am=Eh;var L6="wc",F6="ethereum_provider",q6=`${L6}@2:${F6}:`,M6="https://rpc.walletconnect.com/v1/",xh=["eth_sendTransaction","personal_sign"],j6=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Ph=["chainChanged","accountsChanged"],U6=["chainChanged","accountsChanged","message","disconnect","connect"],z6=Object.defineProperty,$6=Object.defineProperties,H6=Object.getOwnPropertyDescriptors,cm=Object.getOwnPropertySymbols,k6=Object.prototype.hasOwnProperty,B6=Object.prototype.propertyIsEnumerable,um=(n,t,r)=>t in n?z6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Zs=(n,t)=>{for(var r in t||(t={}))k6.call(t,r)&&um(n,r,t[r]);if(cm)for(var r of cm(t))B6.call(t,r)&&um(n,r,t[r]);return n},hm=(n,t)=>$6(n,H6(t));function Qo(n){return Number(n[0].split(":")[1])}function Ih(n){return`0x${n.toString(16)}`}function V6(n){let{chains:t,optionalChains:r,methods:s,optionalMethods:o,events:u,optionalEvents:l,rpcMap:d}=n;if(!vr(t))throw new Error("Invalid chains");let v={chains:t,methods:s||xh,events:u||Ph,rpcMap:Zs({},t.length?{[Qo(t)]:d[Qo(t)]}:{})},b=u?.filter(S=>!Ph.includes(S)),y=s?.filter(S=>!xh.includes(S));if(!r&&!l&&!o&&!(b!=null&&b.length)&&!(y!=null&&y.length))return{required:t.length?v:void 0};let _=b?.length&&y?.length||!r,P={chains:[...new Set(_?v.chains.concat(r||[]):r)],methods:[...new Set(v.methods.concat(o!=null&&o.length?o:j6))],events:[...new Set(v.events.concat(l!=null&&l.length?l:U6))],rpcMap:d};return{required:t.length?v:void 0,optional:r.length?P:void 0}}var Sh=class n{constructor(){this.events=new lm.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=q6,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static init(t){return g(this,null,function*(){let r=new n;return yield r.initialize(t),r})}request(t){return g(this,null,function*(){return yield this.signer.request(t,this.formatChainId(this.chainId))})}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}enable(){return g(this,null,function*(){return this.session||(yield this.connect()),yield this.request({method:"eth_requestAccounts"})})}connect(t){return g(this,null,function*(){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);let{required:r,optional:s}=V6(this.rpc);try{let o=yield new Promise((l,d)=>g(this,null,function*(){var v;this.rpc.showQrModal&&((v=this.modal)==null||v.subscribeModal(b=>{!b.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),d(new Error("Connection request reset. Please try again.")))})),yield this.signer.connect(hm(Zs({namespaces:Zs({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t?.pairingTopic})).then(b=>{l(b)}).catch(b=>{d(new Error(b.message))})}));if(!o)return;let u=cp(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:u),this.setAccounts(u),this.events.emit("connect",{chainId:Ih(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}})}disconnect(){return g(this,null,function*(){this.session&&(yield this.signer.disconnect()),this.reset()})}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{let{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{let r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Ih(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",hm(Zs({},Ye("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){let r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Ih(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){let r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){let[r,s,o]=t.split(":");return{chainId:`${r}:${s}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;let o=(r=t?.chains)!=null?r:[],u=(s=t?.optionalChains)!=null?s:[],l=o.concat(u);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");let d=o.length?t?.methods||xh:[],v=o.length?t?.events||Ph:[],b=t?.optionalMethods||[],y=t?.optionalEvents||[],_=t?.rpcMap||this.buildRpcMap(l,t.projectId),P=t?.qrModalOptions||void 0;return{chains:o?.map(S=>this.formatChainId(S)),optionalChains:u.map(S=>this.formatChainId(S)),methods:d,events:v,optionalMethods:b,optionalEvents:y,rpcMap:_,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:P,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){let s={};return t.forEach(o=>{s[o]=this.getRpcUrl(o,r)}),s}initialize(t){return g(this,null,function*(){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Qo(this.rpc.chains):Qo(this.rpc.optionalChains),this.signer=yield am.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),yield this.loadPersistedSession(),this.rpc.showQrModal){let r;try{let{WalletConnectModal:s}=yield import("./chunk-DO3T5QRJ.js");r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Zs({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}})}loadConnectOpts(t){if(!t)return;let{chains:r,optionalChains:s,rpcMap:o}=t;r&&vr(r)&&(this.rpc.chains=r.map(u=>this.formatChainId(u)),r.forEach(u=>{this.rpc.rpcMap[u]=o?.[u]||this.getRpcUrl(u)})),s&&vr(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s?.map(u=>this.formatChainId(u)),s.forEach(u=>{this.rpc.rpcMap[u]=o?.[u]||this.getRpcUrl(u)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${M6}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}loadPersistedSession(){return g(this,null,function*(){if(!this.session)return;let t=yield this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r?.accounts),this.setAccounts(r?.accounts)})}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}},l2=Sh;export{l2 as EthereumProvider,U6 as OPTIONAL_EVENTS,j6 as OPTIONAL_METHODS,Ph as REQUIRED_EVENTS,xh as REQUIRED_METHODS,Sh as default};
