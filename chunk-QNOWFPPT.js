import{$ as zi,A as Np,B as Dp,C as Lp,D as Pc,E as Rc,F as Mr,G as Mi,H as Fp,I as jp,J as Zn,K as At,L as Qt,M as Ue,N as eo,O as qp,P as Mp,Q as to,R as xs,S as Oc,T as Up,U as zp,V as Tc,W as Ui,Y as k,Z as Ye,_ as vr,a as dx,aa as Zt,b as yp,ba as Ur,c as mp,ca as $p,d as vp,da as Hp,e as Jn,ea as Bp,f as qi,fa as Vp,g as Es,ga as kp,h as _p,ha as Kp,i as wp,ia as ro,j as bp,ja as Gp,k as Yn,ka as Wp,l as Ep,la as Jp,m as Xn,ma as ht,n as xp,na as Yp,o as Ip,oa as Xp,p as qr,pa as Qp,q as Sp,qa as Zp,r as Pp,ra as Ac,s as Rp,sa as ed,t as Ic,ta as td,u as Op,ua as Cc,v as Tp,va as rd,w as Sc,wa as Nc,x as Ap,xa as id,y as Cp,ya as Is,z as Qn}from"./chunk-BQWDY45O.js";import{a as mr}from"./chunk-Z57W7EBI.js";import{a as Be,e as ji,f as Je,g as ai,h as Tt,i as Me,j as yr,l as m}from"./chunk-DDVT2JBD.js";var As={};ai(As,{__assign:()=>$c,__asyncDelegator:()=>Wx,__asyncGenerator:()=>Gx,__asyncValues:()=>Jx,__await:()=>Ts,__awaiter:()=>$x,__classPrivateFieldGet:()=>Zx,__classPrivateFieldSet:()=>eI,__createBinding:()=>Bx,__decorate:()=>Mx,__exportStar:()=>Vx,__extends:()=>jx,__generator:()=>Hx,__importDefault:()=>Qx,__importStar:()=>Xx,__makeTemplateObject:()=>Yx,__metadata:()=>zx,__param:()=>Ux,__read:()=>yd,__rest:()=>qx,__spread:()=>kx,__spreadArrays:()=>Kx,__values:()=>Hc});function jx(n,e){zc(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function qx(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}function Mx(n,e,t,i){var o=arguments.length,c=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,i);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(c=(o<3?h(c):o>3?h(e,t,c):h(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Ux(n,e){return function(t,i){e(t,i,n)}}function zx(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function $x(n,e,t,i){function o(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function f(g){try{y(i.next(g))}catch(w){h(w)}}function v(g){try{y(i.throw(g))}catch(w){h(w)}}function y(g){g.done?c(g.value):o(g.value).then(f,v)}y((i=i.apply(n,e||[])).next())})}function Hx(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(y){return function(g){return v([y,g])}}function v(y){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(c=y[0]&2?o.return:y[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,y[1])).done)return c;switch(o=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,o=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=e.call(n,t)}catch(g){y=[6,g],o=0}finally{i=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function Bx(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}function Vx(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function Hc(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function yd(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),o,c=[],h;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)c.push(o.value)}catch(f){h={error:f}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(h)throw h.error}}return c}function kx(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(yd(arguments[e]));return n}function Kx(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var i=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],h=0,f=c.length;h<f;h++,o++)i[o]=c[h];return i}function Ts(n){return this instanceof Ts?(this.v=n,this):new Ts(n)}function Gx(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,c=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(E){i[E]&&(o[E]=function(S){return new Promise(function(R,j){c.push([E,S,R,j])>1||f(E,S)})})}function f(E,S){try{v(i[E](S))}catch(R){w(c[0][3],R)}}function v(E){E.value instanceof Ts?Promise.resolve(E.value.v).then(y,g):w(c[0][2],E)}function y(E){f("next",E)}function g(E){f("throw",E)}function w(E,S){E(S),c.shift(),c.length&&f(c[0][0],c[0][1])}}function Wx(n){var e,t;return e={},i("next"),i("throw",function(o){throw o}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(o,c){e[o]=n[o]?function(h){return(t=!t)?{value:Ts(n[o](h)),done:o==="return"}:c?c(h):h}:c}}function Jx(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Hc=="function"?Hc(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=n[c]&&function(h){return new Promise(function(f,v){h=n[c](h),o(f,v,h.done,h.value)})}}function o(c,h,f,v){Promise.resolve(v).then(function(y){c({value:y,done:f})},h)}}function Yx(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function Xx(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function Qx(n){return n&&n.__esModule?n:{default:n}}function Zx(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function eI(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var zc,$c,Cs=ji(()=>{"use strict";zc=function(n,e){return zc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])},zc(n,e)};$c=function(){return $c=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++){t=arguments[i];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},$c.apply(this,arguments)}});var tr,md=ji(()=>{"use strict";tr=class{}});var vd={};ai(vd,{IEvents:()=>tr});var Bc=ji(()=>{"use strict";md()});var _d=Je(no=>{"use strict";Object.defineProperty(no,"__esModule",{value:!0});no.IHeartBeat=void 0;var tI=(Bc(),yr(vd)),Vc=class extends tI.IEvents{constructor(e){super()}};no.IHeartBeat=Vc});var Kc=Je(kc=>{"use strict";Object.defineProperty(kc,"__esModule",{value:!0});var rI=(Cs(),yr(As));rI.__exportStar(_d(),kc)});var wd=Je($i=>{"use strict";Object.defineProperty($i,"__esModule",{value:!0});$i.HEARTBEAT_EVENTS=$i.HEARTBEAT_INTERVAL=void 0;var iI=Es();$i.HEARTBEAT_INTERVAL=iI.FIVE_SECONDS;$i.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"}});var Wc=Je(Gc=>{"use strict";Object.defineProperty(Gc,"__esModule",{value:!0});var sI=(Cs(),yr(As));sI.__exportStar(wd(),Gc)});var bd=Je(oo=>{"use strict";Object.defineProperty(oo,"__esModule",{value:!0});oo.HeartBeat=void 0;var Jc=(Cs(),yr(As)),nI=mr(),oI=Es(),aI=Kc(),Yc=Wc(),Xc=class n extends aI.IHeartBeat{constructor(e){super(e),this.events=new nI.EventEmitter,this.interval=Yc.HEARTBEAT_INTERVAL,this.interval=e?.interval||Yc.HEARTBEAT_INTERVAL}static init(e){return Jc.__awaiter(this,void 0,void 0,function*(){let t=new n(e);return yield t.init(),t})}init(){return Jc.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}initialize(){return Jc.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),oI.toMiliseconds(this.interval))})}pulse(){this.events.emit(Yc.HEARTBEAT_EVENTS.pulse)}};oo.HeartBeat=Xc});var Ed=Je(Ns=>{"use strict";Object.defineProperty(Ns,"__esModule",{value:!0});var Qc=(Cs(),yr(As));Qc.__exportStar(bd(),Ns);Qc.__exportStar(Kc(),Ns);Qc.__exportStar(Wc(),Ns)});var Id={};ai(Id,{__assign:()=>eu,__asyncDelegator:()=>wI,__asyncGenerator:()=>_I,__asyncValues:()=>bI,__await:()=>Ds,__awaiter:()=>pI,__classPrivateFieldGet:()=>SI,__classPrivateFieldSet:()=>PI,__createBinding:()=>gI,__decorate:()=>hI,__exportStar:()=>yI,__extends:()=>cI,__generator:()=>dI,__importDefault:()=>II,__importStar:()=>xI,__makeTemplateObject:()=>EI,__metadata:()=>fI,__param:()=>lI,__read:()=>xd,__rest:()=>uI,__spread:()=>mI,__spreadArrays:()=>vI,__values:()=>tu});function cI(n,e){Zc(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function uI(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}function hI(n,e,t,i){var o=arguments.length,c=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,i);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(c=(o<3?h(c):o>3?h(e,t,c):h(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function lI(n,e){return function(t,i){e(t,i,n)}}function fI(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function pI(n,e,t,i){function o(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function f(g){try{y(i.next(g))}catch(w){h(w)}}function v(g){try{y(i.throw(g))}catch(w){h(w)}}function y(g){g.done?c(g.value):o(g.value).then(f,v)}y((i=i.apply(n,e||[])).next())})}function dI(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(y){return function(g){return v([y,g])}}function v(y){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(c=y[0]&2?o.return:y[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,y[1])).done)return c;switch(o=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,o=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=e.call(n,t)}catch(g){y=[6,g],o=0}finally{i=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function gI(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}function yI(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function tu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xd(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),o,c=[],h;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)c.push(o.value)}catch(f){h={error:f}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(h)throw h.error}}return c}function mI(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(xd(arguments[e]));return n}function vI(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var i=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],h=0,f=c.length;h<f;h++,o++)i[o]=c[h];return i}function Ds(n){return this instanceof Ds?(this.v=n,this):new Ds(n)}function _I(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,c=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(E){i[E]&&(o[E]=function(S){return new Promise(function(R,j){c.push([E,S,R,j])>1||f(E,S)})})}function f(E,S){try{v(i[E](S))}catch(R){w(c[0][3],R)}}function v(E){E.value instanceof Ds?Promise.resolve(E.value.v).then(y,g):w(c[0][2],E)}function y(E){f("next",E)}function g(E){f("throw",E)}function w(E,S){E(S),c.shift(),c.length&&f(c[0][0],c[0][1])}}function wI(n){var e,t;return e={},i("next"),i("throw",function(o){throw o}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(o,c){e[o]=n[o]?function(h){return(t=!t)?{value:Ds(n[o](h)),done:o==="return"}:c?c(h):h}:c}}function bI(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof tu=="function"?tu(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=n[c]&&function(h){return new Promise(function(f,v){h=n[c](h),o(f,v,h.done,h.value)})}}function o(c,h,f,v){Promise.resolve(v).then(function(y){c({value:y,done:f})},h)}}function EI(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function xI(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function II(n){return n&&n.__esModule?n:{default:n}}function SI(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function PI(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var Zc,eu,Sd=ji(()=>{"use strict";Zc=function(n,e){return Zc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])},Zc(n,e)};eu=function(){return eu=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++){t=arguments[i];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},eu.apply(this,arguments)}});var Rd=Je((MT,Pd)=>{"use strict";function RI(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}Pd.exports=OI;function OI(n,e,t){var i=t&&t.stringify||RI,o=1;if(typeof n=="object"&&n!==null){var c=e.length+o;if(c===1)return n;var h=new Array(c);h[0]=i(n);for(var f=1;f<c;f++)h[f]=i(e[f]);return h.join(" ")}if(typeof n!="string")return n;var v=e.length;if(v===0)return n;for(var y="",g=1-o,w=-1,E=n&&n.length||0,S=0;S<E;){if(n.charCodeAt(S)===37&&S+1<E){switch(w=w>-1?w:0,n.charCodeAt(S+1)){case 100:case 102:if(g>=v||e[g]==null)break;w<S&&(y+=n.slice(w,S)),y+=Number(e[g]),w=S+2,S++;break;case 105:if(g>=v||e[g]==null)break;w<S&&(y+=n.slice(w,S)),y+=Math.floor(Number(e[g])),w=S+2,S++;break;case 79:case 111:case 106:if(g>=v||e[g]===void 0)break;w<S&&(y+=n.slice(w,S));var R=typeof e[g];if(R==="string"){y+="'"+e[g]+"'",w=S+2,S++;break}if(R==="function"){y+=e[g].name||"<anonymous>",w=S+2,S++;break}y+=i(e[g]),w=S+2,S++;break;case 115:if(g>=v)break;w<S&&(y+=n.slice(w,S)),y+=String(e[g]),w=S+2,S++;break;case 37:w<S&&(y+=n.slice(w,S)),y+="%",w=S+2,S++,g--;break}++g}++S}return w===-1?n:(w<E&&(y+=n.slice(w)),y)}});var Nd=Je((UT,Cd)=>{"use strict";var Od=Rd();Cd.exports=rr;var Ls=MI().console||{},TI={mapHttpRequest:ao,mapHttpResponse:ao,wrapRequestSerializer:ru,wrapResponseSerializer:ru,wrapErrorSerializer:ru,req:ao,res:ao,err:LI};function AI(n,e){return Array.isArray(n)?n.filter(function(i){return i!=="!stdSerializers.err"}):n===!0?Object.keys(e):!1}function rr(n){n=n||{},n.browser=n.browser||{};let e=n.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");let t=n.browser.write||Ls;n.browser.write&&(n.browser.asObject=!0);let i=n.serializers||{},o=AI(n.browser.serialize,i),c=n.browser.serialize;Array.isArray(n.browser.serialize)&&n.browser.serialize.indexOf("!stdSerializers.err")>-1&&(c=!1);let h=["error","fatal","warn","info","debug","trace"];typeof t=="function"&&(t.error=t.fatal=t.warn=t.info=t.debug=t.trace=t),n.enabled===!1&&(n.level="silent");let f=n.level||"info",v=Object.create(t);v.log||(v.log=Fs),Object.defineProperty(v,"levelVal",{get:g}),Object.defineProperty(v,"level",{get:w,set:E});let y={transmit:e,serialize:o,asObject:n.browser.asObject,levels:h,timestamp:FI(n)};v.levels=rr.levels,v.level=f,v.setMaxListeners=v.getMaxListeners=v.emit=v.addListener=v.on=v.prependListener=v.once=v.prependOnceListener=v.removeListener=v.removeAllListeners=v.listeners=v.listenerCount=v.eventNames=v.write=v.flush=Fs,v.serializers=i,v._serialize=o,v._stdErrSerialize=c,v.child=S,e&&(v._logEvent=iu());function g(){return this.level==="silent"?1/0:this.levels.values[this.level]}function w(){return this._level}function E(R){if(R!=="silent"&&!this.levels.values[R])throw Error("unknown level "+R);this._level=R,Hi(y,v,"error","log"),Hi(y,v,"fatal","error"),Hi(y,v,"warn","error"),Hi(y,v,"info","log"),Hi(y,v,"debug","log"),Hi(y,v,"trace","log")}function S(R,j){if(!R)throw new Error("missing bindings for child Pino");j=j||{},o&&R.serializers&&(j.serializers=R.serializers);let q=j.serializers;if(o&&q){var V=Object.assign({},i,q),J=n.browser.serialize===!0?Object.keys(V):o;delete R.serializers,co([R],J,V,this._stdErrSerialize)}function H(z){this._childLevel=(z._childLevel|0)+1,this.error=Bi(z,R,"error"),this.fatal=Bi(z,R,"fatal"),this.warn=Bi(z,R,"warn"),this.info=Bi(z,R,"info"),this.debug=Bi(z,R,"debug"),this.trace=Bi(z,R,"trace"),V&&(this.serializers=V,this._serialize=J),e&&(this._logEvent=iu([].concat(z._logEvent.bindings,R)))}return H.prototype=this,new H(this)}return v}rr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};rr.stdSerializers=TI;rr.stdTimeFunctions=Object.assign({},{nullTime:Td,epochTime:Ad,unixTime:jI,isoTime:qI});function Hi(n,e,t,i){let o=Object.getPrototypeOf(e);e[t]=e.levelVal>e.levels.values[t]?Fs:o[t]?o[t]:Ls[t]||Ls[i]||Fs,CI(n,e,t)}function CI(n,e,t){!n.transmit&&e[t]===Fs||(e[t]=function(i){return function(){let c=n.timestamp(),h=new Array(arguments.length),f=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Ls?Ls:this;for(var v=0;v<h.length;v++)h[v]=arguments[v];if(n.serialize&&!n.asObject&&co(h,this._serialize,this.serializers,this._stdErrSerialize),n.asObject?i.call(f,NI(this,t,h,c)):i.apply(f,h),n.transmit){let y=n.transmit.level||e.level,g=rr.levels.values[y],w=rr.levels.values[t];if(w<g)return;DI(this,{ts:c,methodLevel:t,methodValue:w,transmitLevel:y,transmitValue:rr.levels.values[n.transmit.level||e.level],send:n.transmit.send,val:e.levelVal},h)}}}(e[t]))}function NI(n,e,t,i){n._serialize&&co(t,n._serialize,n.serializers,n._stdErrSerialize);let o=t.slice(),c=o[0],h={};i&&(h.time=i),h.level=rr.levels.values[e];let f=(n._childLevel|0)+1;if(f<1&&(f=1),c!==null&&typeof c=="object"){for(;f--&&typeof o[0]=="object";)Object.assign(h,o.shift());c=o.length?Od(o.shift(),o):void 0}else typeof c=="string"&&(c=Od(o.shift(),o));return c!==void 0&&(h.msg=c),h}function co(n,e,t,i){for(let o in n)if(i&&n[o]instanceof Error)n[o]=rr.stdSerializers.err(n[o]);else if(typeof n[o]=="object"&&!Array.isArray(n[o]))for(let c in n[o])e&&e.indexOf(c)>-1&&c in t&&(n[o][c]=t[c](n[o][c]))}function Bi(n,e,t){return function(){let i=new Array(1+arguments.length);i[0]=e;for(var o=1;o<i.length;o++)i[o]=arguments[o-1];return n[t].apply(this,i)}}function DI(n,e,t){let i=e.send,o=e.ts,c=e.methodLevel,h=e.methodValue,f=e.val,v=n._logEvent.bindings;co(t,n._serialize||Object.keys(n.serializers),n.serializers,n._stdErrSerialize===void 0?!0:n._stdErrSerialize),n._logEvent.ts=o,n._logEvent.messages=t.filter(function(y){return v.indexOf(y)===-1}),n._logEvent.level.label=c,n._logEvent.level.value=h,i(c,n._logEvent,f),n._logEvent=iu(v)}function iu(n){return{ts:0,messages:[],bindings:n||[],level:{label:"",value:0}}}function LI(n){let e={type:n.constructor.name,msg:n.message,stack:n.stack};for(let t in n)e[t]===void 0&&(e[t]=n[t]);return e}function FI(n){return typeof n.timestamp=="function"?n.timestamp:n.timestamp===!1?Td:Ad}function ao(){return{}}function ru(n){return n}function Fs(){}function Td(){return!1}function Ad(){return Date.now()}function jI(){return Math.round(Date.now()/1e3)}function qI(){return new Date(Date.now()).toISOString()}function MI(){function n(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return n(self)||n(window)||n(this)||{}}}});var su=Je(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.PINO_CUSTOM_CONTEXT_KEY=Vi.PINO_LOGGER_DEFAULTS=void 0;Vi.PINO_LOGGER_DEFAULTS={level:"info"};Vi.PINO_CUSTOM_CONTEXT_KEY="custom_context"});var qd=Je(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.generateChildLogger=bt.formatChildLoggerContext=bt.getLoggerContext=bt.setBrowserLoggerContext=bt.getBrowserLoggerContext=bt.getDefaultLoggerOptions=void 0;var ki=su();function UI(n){return Object.assign(Object.assign({},n),{level:n?.level||ki.PINO_LOGGER_DEFAULTS.level})}bt.getDefaultLoggerOptions=UI;function Dd(n,e=ki.PINO_CUSTOM_CONTEXT_KEY){return n[e]||""}bt.getBrowserLoggerContext=Dd;function Ld(n,e,t=ki.PINO_CUSTOM_CONTEXT_KEY){return n[t]=e,n}bt.setBrowserLoggerContext=Ld;function Fd(n,e=ki.PINO_CUSTOM_CONTEXT_KEY){let t="";return typeof n.bindings>"u"?t=Dd(n,e):t=n.bindings().context||"",t}bt.getLoggerContext=Fd;function jd(n,e,t=ki.PINO_CUSTOM_CONTEXT_KEY){let i=Fd(n,t);return i.trim()?`${i}/${e}`:e}bt.formatChildLoggerContext=jd;function zI(n,e,t=ki.PINO_CUSTOM_CONTEXT_KEY){let i=jd(n,e,t),o=n.child({context:i});return Ld(o,i,t)}bt.generateChildLogger=zI});var uo=Je(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});Ki.pino=void 0;var nu=(Sd(),yr(Id)),$I=nu.__importDefault(Nd());Object.defineProperty(Ki,"pino",{enumerable:!0,get:function(){return $I.default}});nu.__exportStar(su(),Ki);nu.__exportStar(qd(),Ki)});var $d=Je(_r=>{"use strict";Object.defineProperty(_r,"__esModule",{value:!0});var Wi=dx(),Gi=yp();_r.DIGEST_LENGTH=64;_r.BLOCK_SIZE=128;var zd=function(){function n(){this.digestLength=_r.DIGEST_LENGTH,this.blockSize=_r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return n.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},n.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},n.prototype.clean=function(){Gi.wipe(this._buffer),Gi.wipe(this._tempHi),Gi.wipe(this._tempLo),this.reset()},n.prototype.update=function(e,t){if(t===void 0&&(t=e.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var i=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<_r.BLOCK_SIZE&&t>0;)this._buffer[this._bufferLength++]=e[i++],t--;this._bufferLength===this.blockSize&&(ou(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(i=ou(this._tempHi,this._tempLo,this._stateHi,this._stateLo,e,i,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[i++],t--;return this},n.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,i=this._bufferLength,o=t/536870912|0,c=t<<3,h=t%128<112?128:256;this._buffer[i]=128;for(var f=i+1;f<h-8;f++)this._buffer[f]=0;Wi.writeUint32BE(o,this._buffer,h-8),Wi.writeUint32BE(c,this._buffer,h-4),ou(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,h),this._finished=!0}for(var f=0;f<this.digestLength/8;f++)Wi.writeUint32BE(this._stateHi[f],e,f*8),Wi.writeUint32BE(this._stateLo[f],e,f*8+4);return this},n.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},n.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},n.prototype.restoreState=function(e){return this._stateHi.set(e.stateHi),this._stateLo.set(e.stateLo),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},n.prototype.cleanSavedState=function(e){Gi.wipe(e.stateHi),Gi.wipe(e.stateLo),e.buffer&&Gi.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},n}();_r.SHA512=zd;var Ud=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function ou(n,e,t,i,o,c,h){for(var f=t[0],v=t[1],y=t[2],g=t[3],w=t[4],E=t[5],S=t[6],R=t[7],j=i[0],q=i[1],V=i[2],J=i[3],H=i[4],z=i[5],ee=i[6],se=i[7],A,N,re,P,O,D,U,$;h>=128;){for(var X=0;X<16;X++){var _e=8*X+c;n[X]=Wi.readUint32BE(o,_e),e[X]=Wi.readUint32BE(o,_e+4)}for(var X=0;X<80;X++){var Ve=f,tt=v,wi=y,Se=g,me=w,ke=E,Ke=S,ze=R,Pe=j,De=q,Ge=V,xe=J,Te=H,We=z,Le=ee,Ae=se;if(A=R,N=se,O=N&65535,D=N>>>16,U=A&65535,$=A>>>16,A=(w>>>14|H<<32-14)^(w>>>18|H<<32-18)^(H>>>41-32|w<<32-(41-32)),N=(H>>>14|w<<32-14)^(H>>>18|w<<32-18)^(w>>>41-32|H<<32-(41-32)),O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,A=w&E^~w&S,N=H&z^~H&ee,O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,A=Ud[X*2],N=Ud[X*2+1],O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,A=n[X%16],N=e[X%16],O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,D+=O>>>16,U+=D>>>16,$+=U>>>16,re=U&65535|$<<16,P=O&65535|D<<16,A=re,N=P,O=N&65535,D=N>>>16,U=A&65535,$=A>>>16,A=(f>>>28|j<<32-28)^(j>>>34-32|f<<32-(34-32))^(j>>>39-32|f<<32-(39-32)),N=(j>>>28|f<<32-28)^(f>>>34-32|j<<32-(34-32))^(f>>>39-32|j<<32-(39-32)),O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,A=f&v^f&y^v&y,N=j&q^j&V^q&V,O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,D+=O>>>16,U+=D>>>16,$+=U>>>16,ze=U&65535|$<<16,Ae=O&65535|D<<16,A=Se,N=xe,O=N&65535,D=N>>>16,U=A&65535,$=A>>>16,A=re,N=P,O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,D+=O>>>16,U+=D>>>16,$+=U>>>16,Se=U&65535|$<<16,xe=O&65535|D<<16,v=Ve,y=tt,g=wi,w=Se,E=me,S=ke,R=Ke,f=ze,q=Pe,V=De,J=Ge,H=xe,z=Te,ee=We,se=Le,j=Ae,X%16===15)for(var _e=0;_e<16;_e++)A=n[_e],N=e[_e],O=N&65535,D=N>>>16,U=A&65535,$=A>>>16,A=n[(_e+9)%16],N=e[(_e+9)%16],O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,re=n[(_e+1)%16],P=e[(_e+1)%16],A=(re>>>1|P<<32-1)^(re>>>8|P<<32-8)^re>>>7,N=(P>>>1|re<<32-1)^(P>>>8|re<<32-8)^(P>>>7|re<<32-7),O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,re=n[(_e+14)%16],P=e[(_e+14)%16],A=(re>>>19|P<<32-19)^(P>>>61-32|re<<32-(61-32))^re>>>6,N=(P>>>19|re<<32-19)^(re>>>61-32|P<<32-(61-32))^(P>>>6|re<<32-6),O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,D+=O>>>16,U+=D>>>16,$+=U>>>16,n[_e]=U&65535|$<<16,e[_e]=O&65535|D<<16}A=f,N=j,O=N&65535,D=N>>>16,U=A&65535,$=A>>>16,A=t[0],N=i[0],O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,D+=O>>>16,U+=D>>>16,$+=U>>>16,t[0]=f=U&65535|$<<16,i[0]=j=O&65535|D<<16,A=v,N=q,O=N&65535,D=N>>>16,U=A&65535,$=A>>>16,A=t[1],N=i[1],O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,D+=O>>>16,U+=D>>>16,$+=U>>>16,t[1]=v=U&65535|$<<16,i[1]=q=O&65535|D<<16,A=y,N=V,O=N&65535,D=N>>>16,U=A&65535,$=A>>>16,A=t[2],N=i[2],O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,D+=O>>>16,U+=D>>>16,$+=U>>>16,t[2]=y=U&65535|$<<16,i[2]=V=O&65535|D<<16,A=g,N=J,O=N&65535,D=N>>>16,U=A&65535,$=A>>>16,A=t[3],N=i[3],O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,D+=O>>>16,U+=D>>>16,$+=U>>>16,t[3]=g=U&65535|$<<16,i[3]=J=O&65535|D<<16,A=w,N=H,O=N&65535,D=N>>>16,U=A&65535,$=A>>>16,A=t[4],N=i[4],O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,D+=O>>>16,U+=D>>>16,$+=U>>>16,t[4]=w=U&65535|$<<16,i[4]=H=O&65535|D<<16,A=E,N=z,O=N&65535,D=N>>>16,U=A&65535,$=A>>>16,A=t[5],N=i[5],O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,D+=O>>>16,U+=D>>>16,$+=U>>>16,t[5]=E=U&65535|$<<16,i[5]=z=O&65535|D<<16,A=S,N=ee,O=N&65535,D=N>>>16,U=A&65535,$=A>>>16,A=t[6],N=i[6],O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,D+=O>>>16,U+=D>>>16,$+=U>>>16,t[6]=S=U&65535|$<<16,i[6]=ee=O&65535|D<<16,A=R,N=se,O=N&65535,D=N>>>16,U=A&65535,$=A>>>16,A=t[7],N=i[7],O+=N&65535,D+=N>>>16,U+=A&65535,$+=A>>>16,D+=O>>>16,U+=D>>>16,$+=U>>>16,t[7]=R=U&65535|$<<16,i[7]=se=O&65535|D<<16,c+=128,h-=128}return c}function HI(n){var e=new zd;e.update(n);var t=e.digest();return e.clean(),t}_r.hash=HI});var tg=Je(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.convertSecretKeyToX25519=ye.convertPublicKeyToX25519=ye.verify=ye.sign=ye.extractPublicKeyFromSecretKey=ye.generateKeyPair=ye.generateKeyPairFromSeed=ye.SEED_LENGTH=ye.SECRET_KEY_LENGTH=ye.PUBLIC_KEY_LENGTH=ye.SIGNATURE_LENGTH=void 0;var BI=mp(),js=$d(),Kd=yp();ye.SIGNATURE_LENGTH=64;ye.PUBLIC_KEY_LENGTH=32;ye.SECRET_KEY_LENGTH=64;ye.SEED_LENGTH=32;function W(n){let e=new Float64Array(16);if(n)for(let t=0;t<n.length;t++)e[t]=n[t];return e}var VI=new Uint8Array(32);VI[0]=9;var uu=W(),Ji=W([1]),kI=W([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),KI=W([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),Hd=W([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Bd=W([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),GI=W([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function zr(n,e){for(let t=0;t<16;t++)n[t]=e[t]|0}function au(n){let e=1;for(let t=0;t<16;t++){let i=n[t]+e+65535;e=Math.floor(i/65536),n[t]=i-e*65536}n[0]+=e-1+37*(e-1)}function Gd(n,e,t){let i=~(t-1);for(let o=0;o<16;o++){let c=i&(n[o]^e[o]);n[o]^=c,e[o]^=c}}function qs(n,e){let t=W(),i=W();for(let o=0;o<16;o++)i[o]=e[o];au(i),au(i),au(i);for(let o=0;o<2;o++){t[0]=i[0]-65517;for(let h=1;h<15;h++)t[h]=i[h]-65535-(t[h-1]>>16&1),t[h-1]&=65535;t[15]=i[15]-32767-(t[14]>>16&1);let c=t[15]>>16&1;t[14]&=65535,Gd(i,t,1-c)}for(let o=0;o<16;o++)n[2*o]=i[o]&255,n[2*o+1]=i[o]>>8}function Wd(n,e){let t=0;for(let i=0;i<32;i++)t|=n[i]^e[i];return(1&t-1>>>8)-1}function Vd(n,e){let t=new Uint8Array(32),i=new Uint8Array(32);return qs(t,n),qs(i,e),Wd(t,i)}function Jd(n){let e=new Uint8Array(32);return qs(e,n),e[0]&1}function WI(n,e){for(let t=0;t<16;t++)n[t]=e[2*t]+(e[2*t+1]<<8);n[15]&=32767}function ui(n,e,t){for(let i=0;i<16;i++)n[i]=e[i]+t[i]}function li(n,e,t){for(let i=0;i<16;i++)n[i]=e[i]-t[i]}function be(n,e,t){let i,o,c=0,h=0,f=0,v=0,y=0,g=0,w=0,E=0,S=0,R=0,j=0,q=0,V=0,J=0,H=0,z=0,ee=0,se=0,A=0,N=0,re=0,P=0,O=0,D=0,U=0,$=0,X=0,_e=0,Ve=0,tt=0,wi=0,Se=t[0],me=t[1],ke=t[2],Ke=t[3],ze=t[4],Pe=t[5],De=t[6],Ge=t[7],xe=t[8],Te=t[9],We=t[10],Le=t[11],Ae=t[12],Xe=t[13],we=t[14],je=t[15];i=e[0],c+=i*Se,h+=i*me,f+=i*ke,v+=i*Ke,y+=i*ze,g+=i*Pe,w+=i*De,E+=i*Ge,S+=i*xe,R+=i*Te,j+=i*We,q+=i*Le,V+=i*Ae,J+=i*Xe,H+=i*we,z+=i*je,i=e[1],h+=i*Se,f+=i*me,v+=i*ke,y+=i*Ke,g+=i*ze,w+=i*Pe,E+=i*De,S+=i*Ge,R+=i*xe,j+=i*Te,q+=i*We,V+=i*Le,J+=i*Ae,H+=i*Xe,z+=i*we,ee+=i*je,i=e[2],f+=i*Se,v+=i*me,y+=i*ke,g+=i*Ke,w+=i*ze,E+=i*Pe,S+=i*De,R+=i*Ge,j+=i*xe,q+=i*Te,V+=i*We,J+=i*Le,H+=i*Ae,z+=i*Xe,ee+=i*we,se+=i*je,i=e[3],v+=i*Se,y+=i*me,g+=i*ke,w+=i*Ke,E+=i*ze,S+=i*Pe,R+=i*De,j+=i*Ge,q+=i*xe,V+=i*Te,J+=i*We,H+=i*Le,z+=i*Ae,ee+=i*Xe,se+=i*we,A+=i*je,i=e[4],y+=i*Se,g+=i*me,w+=i*ke,E+=i*Ke,S+=i*ze,R+=i*Pe,j+=i*De,q+=i*Ge,V+=i*xe,J+=i*Te,H+=i*We,z+=i*Le,ee+=i*Ae,se+=i*Xe,A+=i*we,N+=i*je,i=e[5],g+=i*Se,w+=i*me,E+=i*ke,S+=i*Ke,R+=i*ze,j+=i*Pe,q+=i*De,V+=i*Ge,J+=i*xe,H+=i*Te,z+=i*We,ee+=i*Le,se+=i*Ae,A+=i*Xe,N+=i*we,re+=i*je,i=e[6],w+=i*Se,E+=i*me,S+=i*ke,R+=i*Ke,j+=i*ze,q+=i*Pe,V+=i*De,J+=i*Ge,H+=i*xe,z+=i*Te,ee+=i*We,se+=i*Le,A+=i*Ae,N+=i*Xe,re+=i*we,P+=i*je,i=e[7],E+=i*Se,S+=i*me,R+=i*ke,j+=i*Ke,q+=i*ze,V+=i*Pe,J+=i*De,H+=i*Ge,z+=i*xe,ee+=i*Te,se+=i*We,A+=i*Le,N+=i*Ae,re+=i*Xe,P+=i*we,O+=i*je,i=e[8],S+=i*Se,R+=i*me,j+=i*ke,q+=i*Ke,V+=i*ze,J+=i*Pe,H+=i*De,z+=i*Ge,ee+=i*xe,se+=i*Te,A+=i*We,N+=i*Le,re+=i*Ae,P+=i*Xe,O+=i*we,D+=i*je,i=e[9],R+=i*Se,j+=i*me,q+=i*ke,V+=i*Ke,J+=i*ze,H+=i*Pe,z+=i*De,ee+=i*Ge,se+=i*xe,A+=i*Te,N+=i*We,re+=i*Le,P+=i*Ae,O+=i*Xe,D+=i*we,U+=i*je,i=e[10],j+=i*Se,q+=i*me,V+=i*ke,J+=i*Ke,H+=i*ze,z+=i*Pe,ee+=i*De,se+=i*Ge,A+=i*xe,N+=i*Te,re+=i*We,P+=i*Le,O+=i*Ae,D+=i*Xe,U+=i*we,$+=i*je,i=e[11],q+=i*Se,V+=i*me,J+=i*ke,H+=i*Ke,z+=i*ze,ee+=i*Pe,se+=i*De,A+=i*Ge,N+=i*xe,re+=i*Te,P+=i*We,O+=i*Le,D+=i*Ae,U+=i*Xe,$+=i*we,X+=i*je,i=e[12],V+=i*Se,J+=i*me,H+=i*ke,z+=i*Ke,ee+=i*ze,se+=i*Pe,A+=i*De,N+=i*Ge,re+=i*xe,P+=i*Te,O+=i*We,D+=i*Le,U+=i*Ae,$+=i*Xe,X+=i*we,_e+=i*je,i=e[13],J+=i*Se,H+=i*me,z+=i*ke,ee+=i*Ke,se+=i*ze,A+=i*Pe,N+=i*De,re+=i*Ge,P+=i*xe,O+=i*Te,D+=i*We,U+=i*Le,$+=i*Ae,X+=i*Xe,_e+=i*we,Ve+=i*je,i=e[14],H+=i*Se,z+=i*me,ee+=i*ke,se+=i*Ke,A+=i*ze,N+=i*Pe,re+=i*De,P+=i*Ge,O+=i*xe,D+=i*Te,U+=i*We,$+=i*Le,X+=i*Ae,_e+=i*Xe,Ve+=i*we,tt+=i*je,i=e[15],z+=i*Se,ee+=i*me,se+=i*ke,A+=i*Ke,N+=i*ze,re+=i*Pe,P+=i*De,O+=i*Ge,D+=i*xe,U+=i*Te,$+=i*We,X+=i*Le,_e+=i*Ae,Ve+=i*Xe,tt+=i*we,wi+=i*je,c+=38*ee,h+=38*se,f+=38*A,v+=38*N,y+=38*re,g+=38*P,w+=38*O,E+=38*D,S+=38*U,R+=38*$,j+=38*X,q+=38*_e,V+=38*Ve,J+=38*tt,H+=38*wi,o=1,i=c+o+65535,o=Math.floor(i/65536),c=i-o*65536,i=h+o+65535,o=Math.floor(i/65536),h=i-o*65536,i=f+o+65535,o=Math.floor(i/65536),f=i-o*65536,i=v+o+65535,o=Math.floor(i/65536),v=i-o*65536,i=y+o+65535,o=Math.floor(i/65536),y=i-o*65536,i=g+o+65535,o=Math.floor(i/65536),g=i-o*65536,i=w+o+65535,o=Math.floor(i/65536),w=i-o*65536,i=E+o+65535,o=Math.floor(i/65536),E=i-o*65536,i=S+o+65535,o=Math.floor(i/65536),S=i-o*65536,i=R+o+65535,o=Math.floor(i/65536),R=i-o*65536,i=j+o+65535,o=Math.floor(i/65536),j=i-o*65536,i=q+o+65535,o=Math.floor(i/65536),q=i-o*65536,i=V+o+65535,o=Math.floor(i/65536),V=i-o*65536,i=J+o+65535,o=Math.floor(i/65536),J=i-o*65536,i=H+o+65535,o=Math.floor(i/65536),H=i-o*65536,i=z+o+65535,o=Math.floor(i/65536),z=i-o*65536,c+=o-1+37*(o-1),o=1,i=c+o+65535,o=Math.floor(i/65536),c=i-o*65536,i=h+o+65535,o=Math.floor(i/65536),h=i-o*65536,i=f+o+65535,o=Math.floor(i/65536),f=i-o*65536,i=v+o+65535,o=Math.floor(i/65536),v=i-o*65536,i=y+o+65535,o=Math.floor(i/65536),y=i-o*65536,i=g+o+65535,o=Math.floor(i/65536),g=i-o*65536,i=w+o+65535,o=Math.floor(i/65536),w=i-o*65536,i=E+o+65535,o=Math.floor(i/65536),E=i-o*65536,i=S+o+65535,o=Math.floor(i/65536),S=i-o*65536,i=R+o+65535,o=Math.floor(i/65536),R=i-o*65536,i=j+o+65535,o=Math.floor(i/65536),j=i-o*65536,i=q+o+65535,o=Math.floor(i/65536),q=i-o*65536,i=V+o+65535,o=Math.floor(i/65536),V=i-o*65536,i=J+o+65535,o=Math.floor(i/65536),J=i-o*65536,i=H+o+65535,o=Math.floor(i/65536),H=i-o*65536,i=z+o+65535,o=Math.floor(i/65536),z=i-o*65536,c+=o-1+37*(o-1),n[0]=c,n[1]=h,n[2]=f,n[3]=v,n[4]=y,n[5]=g,n[6]=w,n[7]=E,n[8]=S,n[9]=R,n[10]=j,n[11]=q,n[12]=V,n[13]=J,n[14]=H,n[15]=z}function hi(n,e){be(n,e,e)}function Yd(n,e){let t=W(),i;for(i=0;i<16;i++)t[i]=e[i];for(i=253;i>=0;i--)hi(t,t),i!==2&&i!==4&&be(t,t,e);for(i=0;i<16;i++)n[i]=t[i]}function JI(n,e){let t=W(),i;for(i=0;i<16;i++)t[i]=e[i];for(i=250;i>=0;i--)hi(t,t),i!==1&&be(t,t,e);for(i=0;i<16;i++)n[i]=t[i]}function hu(n,e){let t=W(),i=W(),o=W(),c=W(),h=W(),f=W(),v=W(),y=W(),g=W();li(t,n[1],n[0]),li(g,e[1],e[0]),be(t,t,g),ui(i,n[0],n[1]),ui(g,e[0],e[1]),be(i,i,g),be(o,n[3],e[3]),be(o,o,KI),be(c,n[2],e[2]),ui(c,c,c),li(h,i,t),li(f,c,o),ui(v,c,o),ui(y,i,t),be(n[0],h,f),be(n[1],y,v),be(n[2],v,f),be(n[3],h,y)}function kd(n,e,t){for(let i=0;i<4;i++)Gd(n[i],e[i],t)}function fu(n,e){let t=W(),i=W(),o=W();Yd(o,e[2]),be(t,e[0],o),be(i,e[1],o),qs(n,i),n[31]^=Jd(t)<<7}function Xd(n,e,t){zr(n[0],uu),zr(n[1],Ji),zr(n[2],Ji),zr(n[3],uu);for(let i=255;i>=0;--i){let o=t[i/8|0]>>(i&7)&1;kd(n,e,o),hu(e,n),hu(n,n),kd(n,e,o)}}function pu(n,e){let t=[W(),W(),W(),W()];zr(t[0],Hd),zr(t[1],Bd),zr(t[2],Ji),be(t[3],Hd,Bd),Xd(n,t,e)}function Qd(n){if(n.length!==ye.SEED_LENGTH)throw new Error(`ed25519: seed must be ${ye.SEED_LENGTH} bytes`);let e=(0,js.hash)(n);e[0]&=248,e[31]&=127,e[31]|=64;let t=new Uint8Array(32),i=[W(),W(),W(),W()];pu(i,e),fu(t,i);let o=new Uint8Array(64);return o.set(n),o.set(t,32),{publicKey:t,secretKey:o}}ye.generateKeyPairFromSeed=Qd;function YI(n){let e=(0,BI.randomBytes)(32,n),t=Qd(e);return(0,Kd.wipe)(e),t}ye.generateKeyPair=YI;function XI(n){if(n.length!==ye.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${ye.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(n.subarray(32))}ye.extractPublicKeyFromSecretKey=XI;var cu=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Zd(n,e){let t,i,o,c;for(i=63;i>=32;--i){for(t=0,o=i-32,c=i-12;o<c;++o)e[o]+=t-16*e[i]*cu[o-(i-32)],t=Math.floor((e[o]+128)/256),e[o]-=t*256;e[o]+=t,e[i]=0}for(t=0,o=0;o<32;o++)e[o]+=t-(e[31]>>4)*cu[o],t=e[o]>>8,e[o]&=255;for(o=0;o<32;o++)e[o]-=t*cu[o];for(i=0;i<32;i++)e[i+1]+=e[i]>>8,n[i]=e[i]&255}function lu(n){let e=new Float64Array(64);for(let t=0;t<64;t++)e[t]=n[t];for(let t=0;t<64;t++)n[t]=0;Zd(n,e)}function QI(n,e){let t=new Float64Array(64),i=[W(),W(),W(),W()],o=(0,js.hash)(n.subarray(0,32));o[0]&=248,o[31]&=127,o[31]|=64;let c=new Uint8Array(64);c.set(o.subarray(32),32);let h=new js.SHA512;h.update(c.subarray(32)),h.update(e);let f=h.digest();h.clean(),lu(f),pu(i,f),fu(c,i),h.reset(),h.update(c.subarray(0,32)),h.update(n.subarray(32)),h.update(e);let v=h.digest();lu(v);for(let y=0;y<32;y++)t[y]=f[y];for(let y=0;y<32;y++)for(let g=0;g<32;g++)t[y+g]+=v[y]*o[g];return Zd(c.subarray(32),t),c}ye.sign=QI;function eg(n,e){let t=W(),i=W(),o=W(),c=W(),h=W(),f=W(),v=W();return zr(n[2],Ji),WI(n[1],e),hi(o,n[1]),be(c,o,kI),li(o,o,n[2]),ui(c,n[2],c),hi(h,c),hi(f,h),be(v,f,h),be(t,v,o),be(t,t,c),JI(t,t),be(t,t,o),be(t,t,c),be(t,t,c),be(n[0],t,c),hi(i,n[0]),be(i,i,c),Vd(i,o)&&be(n[0],n[0],GI),hi(i,n[0]),be(i,i,c),Vd(i,o)?-1:(Jd(n[0])===e[31]>>7&&li(n[0],uu,n[0]),be(n[3],n[0],n[1]),0)}function ZI(n,e,t){let i=new Uint8Array(32),o=[W(),W(),W(),W()],c=[W(),W(),W(),W()];if(t.length!==ye.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${ye.SIGNATURE_LENGTH} bytes`);if(eg(c,n))return!1;let h=new js.SHA512;h.update(t.subarray(0,32)),h.update(n),h.update(e);let f=h.digest();return lu(f),Xd(o,c,f),pu(c,t.subarray(32)),hu(o,c),fu(i,o),!Wd(t,i)}ye.verify=ZI;function eS(n){let e=[W(),W(),W(),W()];if(eg(e,n))throw new Error("Ed25519: invalid public key");let t=W(),i=W(),o=e[1];ui(t,Ji,o),li(i,Ji,o),Yd(i,i),be(t,t,i);let c=new Uint8Array(32);return qs(c,t),c}ye.convertPublicKeyToX25519=eS;function tS(n){let e=(0,js.hash)(n.subarray(0,32));e[0]&=248,e[31]&=127,e[31]|=64;let t=new Uint8Array(e.subarray(0,32));return(0,Kd.wipe)(e),t}ye.convertSecretKeyToX25519=tS});var Eg={};ai(Eg,{__assign:()=>wu,__asyncDelegator:()=>_S,__asyncGenerator:()=>vS,__asyncValues:()=>wS,__await:()=>Hs,__awaiter:()=>fS,__classPrivateFieldGet:()=>IS,__classPrivateFieldSet:()=>SS,__createBinding:()=>dS,__decorate:()=>uS,__exportStar:()=>gS,__extends:()=>aS,__generator:()=>pS,__importDefault:()=>xS,__importStar:()=>ES,__makeTemplateObject:()=>bS,__metadata:()=>lS,__param:()=>hS,__read:()=>bg,__rest:()=>cS,__spread:()=>yS,__spreadArrays:()=>mS,__values:()=>bu});function aS(n,e){_u(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function cS(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}function uS(n,e,t,i){var o=arguments.length,c=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,i);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(c=(o<3?h(c):o>3?h(e,t,c):h(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function hS(n,e){return function(t,i){e(t,i,n)}}function lS(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function fS(n,e,t,i){function o(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function f(g){try{y(i.next(g))}catch(w){h(w)}}function v(g){try{y(i.throw(g))}catch(w){h(w)}}function y(g){g.done?c(g.value):o(g.value).then(f,v)}y((i=i.apply(n,e||[])).next())})}function pS(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(y){return function(g){return v([y,g])}}function v(y){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(c=y[0]&2?o.return:y[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,y[1])).done)return c;switch(o=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,o=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=e.call(n,t)}catch(g){y=[6,g],o=0}finally{i=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function dS(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}function gS(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function bu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function bg(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),o,c=[],h;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)c.push(o.value)}catch(f){h={error:f}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(h)throw h.error}}return c}function yS(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(bg(arguments[e]));return n}function mS(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var i=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],h=0,f=c.length;h<f;h++,o++)i[o]=c[h];return i}function Hs(n){return this instanceof Hs?(this.v=n,this):new Hs(n)}function vS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,c=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(E){i[E]&&(o[E]=function(S){return new Promise(function(R,j){c.push([E,S,R,j])>1||f(E,S)})})}function f(E,S){try{v(i[E](S))}catch(R){w(c[0][3],R)}}function v(E){E.value instanceof Hs?Promise.resolve(E.value.v).then(y,g):w(c[0][2],E)}function y(E){f("next",E)}function g(E){f("throw",E)}function w(E,S){E(S),c.shift(),c.length&&f(c[0][0],c[0][1])}}function _S(n){var e,t;return e={},i("next"),i("throw",function(o){throw o}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(o,c){e[o]=n[o]?function(h){return(t=!t)?{value:Hs(n[o](h)),done:o==="return"}:c?c(h):h}:c}}function wS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof bu=="function"?bu(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=n[c]&&function(h){return new Promise(function(f,v){h=n[c](h),o(f,v,h.done,h.value)})}}function o(c,h,f,v){Promise.resolve(v).then(function(y){c({value:y,done:f})},h)}}function bS(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function ES(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function xS(n){return n&&n.__esModule?n:{default:n}}function IS(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function SS(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var _u,wu,xg=ji(()=>{"use strict";_u=function(n,e){return _u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])},_u(n,e)};wu=function(){return wu=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++){t=arguments[i];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},wu.apply(this,arguments)}});var Sg=Je(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.isBrowserCryptoAvailable=Hr.getSubtleCrypto=Hr.getBrowerCrypto=void 0;function Eu(){return(global==null?void 0:global.crypto)||(global==null?void 0:global.msCrypto)||{}}Hr.getBrowerCrypto=Eu;function Ig(){let n=Eu();return n.subtle||n.webkitSubtle}Hr.getSubtleCrypto=Ig;function PS(){return!!Eu()&&!!Ig()}Hr.isBrowserCryptoAvailable=PS});var Og=Je(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.isBrowser=Br.isNode=Br.isReactNative=void 0;function Pg(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Br.isReactNative=Pg;function Rg(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Br.isNode=Rg;function RS(){return!Pg()&&!Rg()}Br.isBrowser=RS});var xu=Je(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});var Tg=(xg(),yr(Eg));Tg.__exportStar(Sg(),Ao);Tg.__exportStar(Og(),Ao)});var jg=Je((J2,Fg)=>{"use strict";Fg.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var wy=Je((Ks,Zi)=>{"use strict";var MS=200,qu="__lodash_hash_undefined__",Vo=1,Xg=2,Qg=9007199254740991,qo="[object Arguments]",Au="[object Array]",US="[object AsyncFunction]",Zg="[object Boolean]",ey="[object Date]",ty="[object Error]",ry="[object Function]",zS="[object GeneratorFunction]",Mo="[object Map]",iy="[object Number]",$S="[object Null]",Qi="[object Object]",zg="[object Promise]",HS="[object Proxy]",sy="[object RegExp]",Uo="[object Set]",ny="[object String]",BS="[object Symbol]",VS="[object Undefined]",Cu="[object WeakMap]",oy="[object ArrayBuffer]",zo="[object DataView]",kS="[object Float32Array]",KS="[object Float64Array]",GS="[object Int8Array]",WS="[object Int16Array]",JS="[object Int32Array]",YS="[object Uint8Array]",XS="[object Uint8ClampedArray]",QS="[object Uint16Array]",ZS="[object Uint32Array]",eP=/[\\^$.*+?()[\]{}|]/g,tP=/^\[object .+?Constructor\]$/,rP=/^(?:0|[1-9]\d*)$/,Oe={};Oe[kS]=Oe[KS]=Oe[GS]=Oe[WS]=Oe[JS]=Oe[YS]=Oe[XS]=Oe[QS]=Oe[ZS]=!0;Oe[qo]=Oe[Au]=Oe[oy]=Oe[Zg]=Oe[zo]=Oe[ey]=Oe[ty]=Oe[ry]=Oe[Mo]=Oe[iy]=Oe[Qi]=Oe[sy]=Oe[Uo]=Oe[ny]=Oe[Cu]=!1;var ay=typeof global=="object"&&global&&global.Object===Object&&global,iP=typeof self=="object"&&self&&self.Object===Object&&self,br=ay||iP||Function("return this")(),cy=typeof Ks=="object"&&Ks&&!Ks.nodeType&&Ks,$g=cy&&typeof Zi=="object"&&Zi&&!Zi.nodeType&&Zi,uy=$g&&$g.exports===cy,Ru=uy&&ay.process,Hg=function(){try{return Ru&&Ru.binding&&Ru.binding("util")}catch{}}(),Bg=Hg&&Hg.isTypedArray;function sP(n,e){for(var t=-1,i=n==null?0:n.length,o=0,c=[];++t<i;){var h=n[t];e(h,t,n)&&(c[o++]=h)}return c}function nP(n,e){for(var t=-1,i=e.length,o=n.length;++t<i;)n[o+t]=e[t];return n}function oP(n,e){for(var t=-1,i=n==null?0:n.length;++t<i;)if(e(n[t],t,n))return!0;return!1}function aP(n,e){for(var t=-1,i=Array(n);++t<n;)i[t]=e(t);return i}function cP(n){return function(e){return n(e)}}function uP(n,e){return n.has(e)}function hP(n,e){return n?.[e]}function lP(n){var e=-1,t=Array(n.size);return n.forEach(function(i,o){t[++e]=[o,i]}),t}function fP(n,e){return function(t){return n(e(t))}}function pP(n){var e=-1,t=Array(n.size);return n.forEach(function(i){t[++e]=i}),t}var dP=Array.prototype,gP=Function.prototype,ko=Object.prototype,Ou=br["__core-js_shared__"],hy=gP.toString,sr=ko.hasOwnProperty,Vg=function(){var n=/[^.]+$/.exec(Ou&&Ou.keys&&Ou.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),ly=ko.toString,yP=RegExp("^"+hy.call(sr).replace(eP,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kg=uy?br.Buffer:void 0,$o=br.Symbol,Kg=br.Uint8Array,fy=ko.propertyIsEnumerable,mP=dP.splice,fi=$o?$o.toStringTag:void 0,Gg=Object.getOwnPropertySymbols,vP=kg?kg.isBuffer:void 0,_P=fP(Object.keys,Object),Nu=es(br,"DataView"),Gs=es(br,"Map"),Du=es(br,"Promise"),Lu=es(br,"Set"),Fu=es(br,"WeakMap"),Ws=es(Object,"create"),wP=gi(Nu),bP=gi(Gs),EP=gi(Du),xP=gi(Lu),IP=gi(Fu),Wg=$o?$o.prototype:void 0,Tu=Wg?Wg.valueOf:void 0;function pi(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}function SP(){this.__data__=Ws?Ws(null):{},this.size=0}function PP(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}function RP(n){var e=this.__data__;if(Ws){var t=e[n];return t===qu?void 0:t}return sr.call(e,n)?e[n]:void 0}function OP(n){var e=this.__data__;return Ws?e[n]!==void 0:sr.call(e,n)}function TP(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=Ws&&e===void 0?qu:e,this}pi.prototype.clear=SP;pi.prototype.delete=PP;pi.prototype.get=RP;pi.prototype.has=OP;pi.prototype.set=TP;function Er(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}function AP(){this.__data__=[],this.size=0}function CP(n){var e=this.__data__,t=Ko(e,n);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():mP.call(e,t,1),--this.size,!0}function NP(n){var e=this.__data__,t=Ko(e,n);return t<0?void 0:e[t][1]}function DP(n){return Ko(this.__data__,n)>-1}function LP(n,e){var t=this.__data__,i=Ko(t,n);return i<0?(++this.size,t.push([n,e])):t[i][1]=e,this}Er.prototype.clear=AP;Er.prototype.delete=CP;Er.prototype.get=NP;Er.prototype.has=DP;Er.prototype.set=LP;function di(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}function FP(){this.size=0,this.__data__={hash:new pi,map:new(Gs||Er),string:new pi}}function jP(n){var e=Go(this,n).delete(n);return this.size-=e?1:0,e}function qP(n){return Go(this,n).get(n)}function MP(n){return Go(this,n).has(n)}function UP(n,e){var t=Go(this,n),i=t.size;return t.set(n,e),this.size+=t.size==i?0:1,this}di.prototype.clear=FP;di.prototype.delete=jP;di.prototype.get=qP;di.prototype.has=MP;di.prototype.set=UP;function Ho(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new di;++e<t;)this.add(n[e])}function zP(n){return this.__data__.set(n,qu),this}function $P(n){return this.__data__.has(n)}Ho.prototype.add=Ho.prototype.push=zP;Ho.prototype.has=$P;function Gr(n){var e=this.__data__=new Er(n);this.size=e.size}function HP(){this.__data__=new Er,this.size=0}function BP(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}function VP(n){return this.__data__.get(n)}function kP(n){return this.__data__.has(n)}function KP(n,e){var t=this.__data__;if(t instanceof Er){var i=t.__data__;if(!Gs||i.length<MS-1)return i.push([n,e]),this.size=++t.size,this;t=this.__data__=new di(i)}return t.set(n,e),this.size=t.size,this}Gr.prototype.clear=HP;Gr.prototype.delete=BP;Gr.prototype.get=VP;Gr.prototype.has=kP;Gr.prototype.set=KP;function GP(n,e){var t=Bo(n),i=!t&&cR(n),o=!t&&!i&&ju(n),c=!t&&!i&&!o&&_y(n),h=t||i||o||c,f=h?aP(n.length,String):[],v=f.length;for(var y in n)(e||sr.call(n,y))&&!(h&&(y=="length"||o&&(y=="offset"||y=="parent")||c&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||iR(y,v)))&&f.push(y);return f}function Ko(n,e){for(var t=n.length;t--;)if(gy(n[t][0],e))return t;return-1}function WP(n,e,t){var i=e(n);return Bo(n)?i:nP(i,t(n))}function Ys(n){return n==null?n===void 0?VS:$S:fi&&fi in Object(n)?tR(n):aR(n)}function Jg(n){return Js(n)&&Ys(n)==qo}function py(n,e,t,i,o){return n===e?!0:n==null||e==null||!Js(n)&&!Js(e)?n!==n&&e!==e:JP(n,e,t,i,py,o)}function JP(n,e,t,i,o,c){var h=Bo(n),f=Bo(e),v=h?Au:Kr(n),y=f?Au:Kr(e);v=v==qo?Qi:v,y=y==qo?Qi:y;var g=v==Qi,w=y==Qi,E=v==y;if(E&&ju(n)){if(!ju(e))return!1;h=!0,g=!1}if(E&&!g)return c||(c=new Gr),h||_y(n)?dy(n,e,t,i,o,c):ZP(n,e,v,t,i,o,c);if(!(t&Vo)){var S=g&&sr.call(n,"__wrapped__"),R=w&&sr.call(e,"__wrapped__");if(S||R){var j=S?n.value():n,q=R?e.value():e;return c||(c=new Gr),o(j,q,t,i,c)}}return E?(c||(c=new Gr),eR(n,e,t,i,o,c)):!1}function YP(n){if(!vy(n)||nR(n))return!1;var e=yy(n)?yP:tP;return e.test(gi(n))}function XP(n){return Js(n)&&my(n.length)&&!!Oe[Ys(n)]}function QP(n){if(!oR(n))return _P(n);var e=[];for(var t in Object(n))sr.call(n,t)&&t!="constructor"&&e.push(t);return e}function dy(n,e,t,i,o,c){var h=t&Vo,f=n.length,v=e.length;if(f!=v&&!(h&&v>f))return!1;var y=c.get(n);if(y&&c.get(e))return y==e;var g=-1,w=!0,E=t&Xg?new Ho:void 0;for(c.set(n,e),c.set(e,n);++g<f;){var S=n[g],R=e[g];if(i)var j=h?i(R,S,g,e,n,c):i(S,R,g,n,e,c);if(j!==void 0){if(j)continue;w=!1;break}if(E){if(!oP(e,function(q,V){if(!uP(E,V)&&(S===q||o(S,q,t,i,c)))return E.push(V)})){w=!1;break}}else if(!(S===R||o(S,R,t,i,c))){w=!1;break}}return c.delete(n),c.delete(e),w}function ZP(n,e,t,i,o,c,h){switch(t){case zo:if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case oy:return!(n.byteLength!=e.byteLength||!c(new Kg(n),new Kg(e)));case Zg:case ey:case iy:return gy(+n,+e);case ty:return n.name==e.name&&n.message==e.message;case sy:case ny:return n==e+"";case Mo:var f=lP;case Uo:var v=i&Vo;if(f||(f=pP),n.size!=e.size&&!v)return!1;var y=h.get(n);if(y)return y==e;i|=Xg,h.set(n,e);var g=dy(f(n),f(e),i,o,c,h);return h.delete(n),g;case BS:if(Tu)return Tu.call(n)==Tu.call(e)}return!1}function eR(n,e,t,i,o,c){var h=t&Vo,f=Yg(n),v=f.length,y=Yg(e),g=y.length;if(v!=g&&!h)return!1;for(var w=v;w--;){var E=f[w];if(!(h?E in e:sr.call(e,E)))return!1}var S=c.get(n);if(S&&c.get(e))return S==e;var R=!0;c.set(n,e),c.set(e,n);for(var j=h;++w<v;){E=f[w];var q=n[E],V=e[E];if(i)var J=h?i(V,q,E,e,n,c):i(q,V,E,n,e,c);if(!(J===void 0?q===V||o(q,V,t,i,c):J)){R=!1;break}j||(j=E=="constructor")}if(R&&!j){var H=n.constructor,z=e.constructor;H!=z&&"constructor"in n&&"constructor"in e&&!(typeof H=="function"&&H instanceof H&&typeof z=="function"&&z instanceof z)&&(R=!1)}return c.delete(n),c.delete(e),R}function Yg(n){return WP(n,lR,rR)}function Go(n,e){var t=n.__data__;return sR(e)?t[typeof e=="string"?"string":"hash"]:t.map}function es(n,e){var t=hP(n,e);return YP(t)?t:void 0}function tR(n){var e=sr.call(n,fi),t=n[fi];try{n[fi]=void 0;var i=!0}catch{}var o=ly.call(n);return i&&(e?n[fi]=t:delete n[fi]),o}var rR=Gg?function(n){return n==null?[]:(n=Object(n),sP(Gg(n),function(e){return fy.call(n,e)}))}:fR,Kr=Ys;(Nu&&Kr(new Nu(new ArrayBuffer(1)))!=zo||Gs&&Kr(new Gs)!=Mo||Du&&Kr(Du.resolve())!=zg||Lu&&Kr(new Lu)!=Uo||Fu&&Kr(new Fu)!=Cu)&&(Kr=function(n){var e=Ys(n),t=e==Qi?n.constructor:void 0,i=t?gi(t):"";if(i)switch(i){case wP:return zo;case bP:return Mo;case EP:return zg;case xP:return Uo;case IP:return Cu}return e});function iR(n,e){return e=e??Qg,!!e&&(typeof n=="number"||rP.test(n))&&n>-1&&n%1==0&&n<e}function sR(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function nR(n){return!!Vg&&Vg in n}function oR(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||ko;return n===t}function aR(n){return ly.call(n)}function gi(n){if(n!=null){try{return hy.call(n)}catch{}try{return n+""}catch{}}return""}function gy(n,e){return n===e||n!==n&&e!==e}var cR=Jg(function(){return arguments}())?Jg:function(n){return Js(n)&&sr.call(n,"callee")&&!fy.call(n,"callee")},Bo=Array.isArray;function uR(n){return n!=null&&my(n.length)&&!yy(n)}var ju=vP||pR;function hR(n,e){return py(n,e)}function yy(n){if(!vy(n))return!1;var e=Ys(n);return e==ry||e==zS||e==US||e==HS}function my(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=Qg}function vy(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}function Js(n){return n!=null&&typeof n=="object"}var _y=Bg?cP(Bg):XP;function lR(n){return uR(n)?GP(n):QP(n)}function fR(){return[]}function pR(){return!1}Zi.exports=hR});var Mu={};ai(Mu,{default:()=>dR});function dR(n,e){return e=e||{},new Promise(function(t,i){var o=new XMLHttpRequest,c=[],h=[],f={},v=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:v,headers:{keys:function(){return c},entries:function(){return h},get:function(g){return f[g.toLowerCase()]},has:function(g){return g.toLowerCase()in f}}}};for(var y in o.open(e.method||"get",n,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(g,w,E){c.push(w=w.toLowerCase()),h.push([w,E]),f[w]=f[w]?f[w]+","+E:E}),t(v())},o.onerror=i,o.withCredentials=e.credentials=="include",e.headers)o.setRequestHeader(y,e.headers[y]);o.send(e.body||null)})}var Uu=ji(()=>{"use strict"});var Ey=Je((eA,by)=>{"use strict";by.exports=self.fetch||(self.fetch=(Uu(),yr(Mu)).default||(Uu(),yr(Mu)))});var lm=Je((Pr,hm)=>{"use strict";var um=typeof self<"u"?self:Pr,Qo=function(){function n(){this.fetch=!1,this.DOMException=um.DOMException}return n.prototype=um,new n}();(function(n){var e=function(t){var i={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n};function o(P){return P&&DataView.prototype.isPrototypeOf(P)}if(i.arrayBuffer)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(P){return P&&c.indexOf(Object.prototype.toString.call(P))>-1};function f(P){if(typeof P!="string"&&(P=String(P)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(P))throw new TypeError("Invalid character in header field name");return P.toLowerCase()}function v(P){return typeof P!="string"&&(P=String(P)),P}function y(P){var O={next:function(){var D=P.shift();return{done:D===void 0,value:D}}};return i.iterable&&(O[Symbol.iterator]=function(){return O}),O}function g(P){this.map={},P instanceof g?P.forEach(function(O,D){this.append(D,O)},this):Array.isArray(P)?P.forEach(function(O){this.append(O[0],O[1])},this):P&&Object.getOwnPropertyNames(P).forEach(function(O){this.append(O,P[O])},this)}g.prototype.append=function(P,O){P=f(P),O=v(O);var D=this.map[P];this.map[P]=D?D+", "+O:O},g.prototype.delete=function(P){delete this.map[f(P)]},g.prototype.get=function(P){return P=f(P),this.has(P)?this.map[P]:null},g.prototype.has=function(P){return this.map.hasOwnProperty(f(P))},g.prototype.set=function(P,O){this.map[f(P)]=v(O)},g.prototype.forEach=function(P,O){for(var D in this.map)this.map.hasOwnProperty(D)&&P.call(O,this.map[D],D,this)},g.prototype.keys=function(){var P=[];return this.forEach(function(O,D){P.push(D)}),y(P)},g.prototype.values=function(){var P=[];return this.forEach(function(O){P.push(O)}),y(P)},g.prototype.entries=function(){var P=[];return this.forEach(function(O,D){P.push([D,O])}),y(P)},i.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function w(P){if(P.bodyUsed)return Promise.reject(new TypeError("Already read"));P.bodyUsed=!0}function E(P){return new Promise(function(O,D){P.onload=function(){O(P.result)},P.onerror=function(){D(P.error)}})}function S(P){var O=new FileReader,D=E(O);return O.readAsArrayBuffer(P),D}function R(P){var O=new FileReader,D=E(O);return O.readAsText(P),D}function j(P){for(var O=new Uint8Array(P),D=new Array(O.length),U=0;U<O.length;U++)D[U]=String.fromCharCode(O[U]);return D.join("")}function q(P){if(P.slice)return P.slice(0);var O=new Uint8Array(P.byteLength);return O.set(new Uint8Array(P)),O.buffer}function V(){return this.bodyUsed=!1,this._initBody=function(P){this._bodyInit=P,P?typeof P=="string"?this._bodyText=P:i.blob&&Blob.prototype.isPrototypeOf(P)?this._bodyBlob=P:i.formData&&FormData.prototype.isPrototypeOf(P)?this._bodyFormData=P:i.searchParams&&URLSearchParams.prototype.isPrototypeOf(P)?this._bodyText=P.toString():i.arrayBuffer&&i.blob&&o(P)?(this._bodyArrayBuffer=q(P.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):i.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(P)||h(P))?this._bodyArrayBuffer=q(P):this._bodyText=P=Object.prototype.toString.call(P):this._bodyText="",this.headers.get("content-type")||(typeof P=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i.searchParams&&URLSearchParams.prototype.isPrototypeOf(P)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i.blob&&(this.blob=function(){var P=w(this);if(P)return P;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?w(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(S)}),this.text=function(){var P=w(this);if(P)return P;if(this._bodyBlob)return R(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(j(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i.formData&&(this.formData=function(){return this.text().then(ee)}),this.json=function(){return this.text().then(JSON.parse)},this}var J=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function H(P){var O=P.toUpperCase();return J.indexOf(O)>-1?O:P}function z(P,O){O=O||{};var D=O.body;if(P instanceof z){if(P.bodyUsed)throw new TypeError("Already read");this.url=P.url,this.credentials=P.credentials,O.headers||(this.headers=new g(P.headers)),this.method=P.method,this.mode=P.mode,this.signal=P.signal,!D&&P._bodyInit!=null&&(D=P._bodyInit,P.bodyUsed=!0)}else this.url=String(P);if(this.credentials=O.credentials||this.credentials||"same-origin",(O.headers||!this.headers)&&(this.headers=new g(O.headers)),this.method=H(O.method||this.method||"GET"),this.mode=O.mode||this.mode||null,this.signal=O.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&D)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(D)}z.prototype.clone=function(){return new z(this,{body:this._bodyInit})};function ee(P){var O=new FormData;return P.trim().split("&").forEach(function(D){if(D){var U=D.split("="),$=U.shift().replace(/\+/g," "),X=U.join("=").replace(/\+/g," ");O.append(decodeURIComponent($),decodeURIComponent(X))}}),O}function se(P){var O=new g,D=P.replace(/\r?\n[\t ]+/g," ");return D.split(/\r?\n/).forEach(function(U){var $=U.split(":"),X=$.shift().trim();if(X){var _e=$.join(":").trim();O.append(X,_e)}}),O}V.call(z.prototype);function A(P,O){O||(O={}),this.type="default",this.status=O.status===void 0?200:O.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in O?O.statusText:"OK",this.headers=new g(O.headers),this.url=O.url||"",this._initBody(P)}V.call(A.prototype),A.prototype.clone=function(){return new A(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},A.error=function(){var P=new A(null,{status:0,statusText:""});return P.type="error",P};var N=[301,302,303,307,308];A.redirect=function(P,O){if(N.indexOf(O)===-1)throw new RangeError("Invalid status code");return new A(null,{status:O,headers:{location:P}})},t.DOMException=n.DOMException;try{new t.DOMException}catch{t.DOMException=function(O,D){this.message=O,this.name=D;var U=Error(O);this.stack=U.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function re(P,O){return new Promise(function(D,U){var $=new z(P,O);if($.signal&&$.signal.aborted)return U(new t.DOMException("Aborted","AbortError"));var X=new XMLHttpRequest;function _e(){X.abort()}X.onload=function(){var Ve={status:X.status,statusText:X.statusText,headers:se(X.getAllResponseHeaders()||"")};Ve.url="responseURL"in X?X.responseURL:Ve.headers.get("X-Request-URL");var tt="response"in X?X.response:X.responseText;D(new A(tt,Ve))},X.onerror=function(){U(new TypeError("Network request failed"))},X.ontimeout=function(){U(new TypeError("Network request failed"))},X.onabort=function(){U(new t.DOMException("Aborted","AbortError"))},X.open($.method,$.url,!0),$.credentials==="include"?X.withCredentials=!0:$.credentials==="omit"&&(X.withCredentials=!1),"responseType"in X&&i.blob&&(X.responseType="blob"),$.headers.forEach(function(Ve,tt){X.setRequestHeader(tt,Ve)}),$.signal&&($.signal.addEventListener("abort",_e),X.onreadystatechange=function(){X.readyState===4&&$.signal.removeEventListener("abort",_e)}),X.send(typeof $._bodyInit>"u"?null:$._bodyInit)})}return re.polyfill=!0,n.fetch||(n.fetch=re,n.Headers=g,n.Request=z,n.Response=A),t.Headers=g,t.Request=z,t.Response=A,t.fetch=re,Object.defineProperty(t,"__esModule",{value:!0}),t}({})})(Qo);Qo.fetch.ponyfill=!0;delete Qo.fetch.polyfill;var rs=Qo;Pr=rs.fetch;Pr.default=rs.fetch;Pr.fetch=rs.fetch;Pr.Headers=rs.Headers;Pr.Request=rs.Request;Pr.Response=rs.Response;hm.exports=Pr});var Am=Me(mr());var Ir=Me(mr());var gx=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,yx=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,mx=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function vx(n,e){if(n==="__proto__"||n==="constructor"&&e&&typeof e=="object"&&"prototype"in e){_x(n);return}return e}function _x(n){console.warn(`[destr] Dropping "${n}" key to prevent prototype pollution.`)}function Ss(n,e={}){if(typeof n!="string")return n;let t=n.trim();if(n[0]==='"'&&n.at(-1)==='"'&&!n.includes("\\"))return t.slice(1,-1);if(t.length<=9){let i=t.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!mx.test(n)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return n}try{if(gx.test(n)||yx.test(n)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(n,vx)}return JSON.parse(n)}catch(i){if(e.strict)throw i;return n}}function wx(n){return!n||typeof n.then!="function"?Promise.resolve(n):n}function et(n,...e){try{return wx(n(...e))}catch(t){return Promise.reject(t)}}function bx(n){let e=typeof n;return n===null||e!=="object"&&e!=="function"}function Ex(n){let e=Object.getPrototypeOf(n);return!e||e.isPrototypeOf(Object)}function Ps(n){if(bx(n))return String(n);if(Ex(n)||Array.isArray(n))return JSON.stringify(n);if(typeof n.toJSON=="function")return Ps(n.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function sd(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}var Dc="base64:";function nd(n){if(typeof n=="string")return n;sd();let e=Buffer.from(n).toString("base64");return Dc+e}function od(n){return typeof n!="string"||!n.startsWith(Dc)?n:(sd(),Buffer.from(n.slice(Dc.length),"base64"))}function dt(n){return n?n.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function ad(...n){return dt(n.join(":"))}function Rs(n){return n=dt(n),n?n+":":""}var xx="memory",Ix=()=>{let n=new Map;return{name:xx,options:{},hasItem(e){return n.has(e)},getItem(e){return n.get(e)??null},getItemRaw(e){return n.get(e)??null},setItem(e,t){n.set(e,t)},setItemRaw(e,t){n.set(e,t)},removeItem(e){n.delete(e)},getKeys(){return Array.from(n.keys())},clear(){n.clear()},dispose(){n.clear()}}};function hd(n={}){let e={mounts:{"":n.driver||Ix()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=g=>{for(let w of e.mountpoints)if(g.startsWith(w))return{base:w,relativeKey:g.slice(w.length),driver:e.mounts[w]};return{base:"",relativeKey:g,driver:e.mounts[""]}},i=(g,w)=>e.mountpoints.filter(E=>E.startsWith(g)||w&&g.startsWith(E)).map(E=>({relativeBase:g.length>E.length?g.slice(E.length):void 0,mountpoint:E,driver:e.mounts[E]})),o=(g,w)=>{if(e.watching){w=dt(w);for(let E of e.watchListeners)E(g,w)}},c=()=>m(this,null,function*(){if(!e.watching){e.watching=!0;for(let g in e.mounts)e.unwatch[g]=yield cd(e.mounts[g],o,g)}}),h=()=>m(this,null,function*(){if(e.watching){for(let g in e.unwatch)yield e.unwatch[g]();e.unwatch={},e.watching=!1}}),f=(g,w,E)=>{let S=new Map,R=j=>{let q=S.get(j.base);return q||(q={driver:j.driver,base:j.base,items:[]},S.set(j.base,q)),q};for(let j of g){let q=typeof j=="string",V=dt(q?j:j.key),J=q?void 0:j.value,H=q||!j.options?w:Be(Be({},w),j.options),z=t(V);R(z).items.push({key:V,value:J,relativeKey:z.relativeKey,options:H})}return Promise.all([...S.values()].map(j=>E(j))).then(j=>j.flat())},v={hasItem(g,w={}){g=dt(g);let{relativeKey:E,driver:S}=t(g);return et(S.hasItem,E,w)},getItem(g,w={}){g=dt(g);let{relativeKey:E,driver:S}=t(g);return et(S.getItem,E,w).then(R=>Ss(R))},getItems(g,w){return f(g,w,E=>E.driver.getItems?et(E.driver.getItems,E.items.map(S=>({key:S.relativeKey,options:S.options})),w).then(S=>S.map(R=>({key:ad(E.base,R.key),value:Ss(R.value)}))):Promise.all(E.items.map(S=>et(E.driver.getItem,S.relativeKey,S.options).then(R=>({key:S.key,value:Ss(R)})))))},getItemRaw(g,w={}){g=dt(g);let{relativeKey:E,driver:S}=t(g);return S.getItemRaw?et(S.getItemRaw,E,w):et(S.getItem,E,w).then(R=>od(R))},setItem(S,R){return m(this,arguments,function*(g,w,E={}){if(w===void 0)return v.removeItem(g);g=dt(g);let{relativeKey:j,driver:q}=t(g);q.setItem&&(yield et(q.setItem,j,Ps(w),E),q.watch||o("update",g))})},setItems(g,w){return m(this,null,function*(){yield f(g,w,E=>m(this,null,function*(){E.driver.setItems&&(yield et(E.driver.setItems,E.items.map(S=>({key:S.relativeKey,value:Ps(S.value),options:S.options})),w)),E.driver.setItem&&(yield Promise.all(E.items.map(S=>et(E.driver.setItem,S.relativeKey,Ps(S.value),S.options))))}))})},setItemRaw(S,R){return m(this,arguments,function*(g,w,E={}){if(w===void 0)return v.removeItem(g,E);g=dt(g);let{relativeKey:j,driver:q}=t(g);if(q.setItemRaw)yield et(q.setItemRaw,j,w,E);else if(q.setItem)yield et(q.setItem,j,nd(w),E);else return;q.watch||o("update",g)})},removeItem(E){return m(this,arguments,function*(g,w={}){typeof w=="boolean"&&(w={removeMeta:w}),g=dt(g);let{relativeKey:S,driver:R}=t(g);R.removeItem&&(yield et(R.removeItem,S,w),(w.removeMeta||w.removeMata)&&(yield et(R.removeItem,S+"$",w)),R.watch||o("remove",g))})},getMeta(E){return m(this,arguments,function*(g,w={}){typeof w=="boolean"&&(w={nativeOnly:w}),g=dt(g);let{relativeKey:S,driver:R}=t(g),j=Object.create(null);if(R.getMeta&&Object.assign(j,yield et(R.getMeta,S,w)),!w.nativeOnly){let q=yield et(R.getItem,S+"$",w).then(V=>Ss(V));q&&typeof q=="object"&&(typeof q.atime=="string"&&(q.atime=new Date(q.atime)),typeof q.mtime=="string"&&(q.mtime=new Date(q.mtime)),Object.assign(j,q))}return j})},setMeta(g,w,E={}){return this.setItem(g+"$",w,E)},removeMeta(g,w={}){return this.removeItem(g+"$",w)},getKeys(E){return m(this,arguments,function*(g,w={}){g=Rs(g);let S=i(g,!0),R=[],j=[];for(let q of S){let J=(yield et(q.driver.getKeys,q.relativeBase,w)).map(H=>q.mountpoint+dt(H)).filter(H=>!R.some(z=>H.startsWith(z)));j.push(...J),R=[q.mountpoint,...R.filter(H=>!H.startsWith(q.mountpoint))]}return g?j.filter(q=>q.startsWith(g)&&!q.endsWith("$")):j.filter(q=>!q.endsWith("$"))})},clear(E){return m(this,arguments,function*(g,w={}){g=Rs(g),yield Promise.all(i(g,!1).map(S=>m(this,null,function*(){if(S.driver.clear)return et(S.driver.clear,S.relativeBase,w);if(S.driver.removeItem){let R=yield S.driver.getKeys(S.relativeBase||"",w);return Promise.all(R.map(j=>S.driver.removeItem(j,w)))}})))})},dispose(){return m(this,null,function*(){yield Promise.all(Object.values(e.mounts).map(g=>ud(g)))})},watch(g){return m(this,null,function*(){return yield c(),e.watchListeners.push(g),()=>m(this,null,function*(){e.watchListeners=e.watchListeners.filter(w=>w!==g),e.watchListeners.length===0&&(yield h())})})},unwatch(){return m(this,null,function*(){e.watchListeners=[],yield h()})},mount(g,w){if(g=Rs(g),g&&e.mounts[g])throw new Error(`already mounted at ${g}`);return g&&(e.mountpoints.push(g),e.mountpoints.sort((E,S)=>S.length-E.length)),e.mounts[g]=w,e.watching&&Promise.resolve(cd(w,o,g)).then(E=>{e.unwatch[g]=E}).catch(console.error),v},unmount(g,w=!0){return m(this,null,function*(){g=Rs(g),!(!g||!e.mounts[g])&&(e.watching&&g in e.unwatch&&(e.unwatch[g](),delete e.unwatch[g]),w&&(yield ud(e.mounts[g])),e.mountpoints=e.mountpoints.filter(E=>E!==g),delete e.mounts[g])})},getMount(g=""){g=dt(g)+":";let w=t(g);return{driver:w.driver,base:w.base}},getMounts(g="",w={}){return g=dt(g),i(g,w.parents).map(S=>({driver:S.driver,base:S.mountpoint}))}};return v}function cd(n,e,t){return n.watch?n.watch((i,o)=>e(i,t+o)):()=>{}}function ud(n){return m(this,null,function*(){typeof n.dispose=="function"&&(yield et(n.dispose))})}function ci(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}function Fc(n,e){let t=indexedDB.open(n);t.onupgradeneeded=()=>t.result.createObjectStore(e);let i=ci(t);return(o,c)=>i.then(h=>c(h.transaction(e,o).objectStore(e)))}var Lc;function Os(){return Lc||(Lc=Fc("keyval-store","keyval")),Lc}function jc(n,e=Os()){return e("readonly",t=>ci(t.get(n)))}function ld(n,e,t=Os()){return t("readwrite",i=>(i.put(e,n),ci(i.transaction)))}function fd(n,e=Os()){return e("readwrite",t=>(t.delete(n),ci(t.transaction)))}function pd(n=Os()){return n("readwrite",e=>(e.clear(),ci(e.transaction)))}function Sx(n,e){return n.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},ci(n.transaction)}function dd(n=Os()){return n("readonly",e=>{if(e.getAllKeys)return ci(e.getAllKeys());let t=[];return Sx(e,i=>t.push(i.key)).then(()=>t)})}var Px=n=>JSON.stringify(n,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),Rx=n=>{let e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=n.replace(e,'$1"$2n"$3');return JSON.parse(t,(i,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function er(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return Rx(n)}catch{return n}}function $t(n){return typeof n=="string"?n:Px(n)||""}var Ox="idb-keyval",Tx=(n={})=>{let e=n.base&&n.base.length>0?`${n.base}:`:"",t=c=>e+c,i;return n.dbName&&n.storeName&&(i=Fc(n.dbName,n.storeName)),{name:Ox,options:n,hasItem(c){return m(this,null,function*(){return!(typeof(yield jc(t(c),i))>"u")})},getItem(c){return m(this,null,function*(){return(yield jc(t(c),i))??null})},setItem(c,h){return ld(t(c),h,i)},removeItem(c){return fd(t(c),i)},getKeys(){return dd(i)},clear(){return pd(i)}}},Ax="WALLET_CONNECT_V2_INDEXED_DB",Cx="keyvaluestorage",Mc=class{constructor(){this.indexedDb=hd({driver:Tx({dbName:Ax,storeName:Cx})})}getKeys(){return m(this,null,function*(){return this.indexedDb.getKeys()})}getEntries(){return m(this,null,function*(){return(yield this.indexedDb.getItems(yield this.indexedDb.getKeys())).map(e=>[e.key,e.value])})}getItem(e){return m(this,null,function*(){let t=yield this.indexedDb.getItem(e);if(t!==null)return t})}setItem(e,t){return m(this,null,function*(){yield this.indexedDb.setItem(e,$t(t))})}removeItem(e){return m(this,null,function*(){yield this.indexedDb.removeItem(e)})}},qc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},io={exports:{}};(function(){let n;function e(){}n=e,n.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},n.prototype.setItem=function(t,i){this[t]=String(i)},n.prototype.removeItem=function(t){delete this[t]},n.prototype.clear=function(){let t=this;Object.keys(t).forEach(function(i){t[i]=void 0,delete t[i]})},n.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof qc<"u"&&qc.localStorage?io.exports=qc.localStorage:typeof window<"u"&&window.localStorage?io.exports=window.localStorage:io.exports=new e})();function Nx(n){var e;return[n[0],er((e=n[1])!=null?e:"")]}var Uc=class{constructor(){this.localStorage=io.exports}getKeys(){return m(this,null,function*(){return Object.keys(this.localStorage)})}getEntries(){return m(this,null,function*(){return Object.entries(this.localStorage).map(Nx)})}getItem(e){return m(this,null,function*(){let t=this.localStorage.getItem(e);if(t!==null)return er(t)})}setItem(e,t){return m(this,null,function*(){this.localStorage.setItem(e,$t(t))})}removeItem(e){return m(this,null,function*(){this.localStorage.removeItem(e)})}},Dx="wc_storage_version",gd=1,Lx=(n,e,t)=>m(void 0,null,function*(){let i=Dx,o=yield e.getItem(i);if(o&&o>=gd){t(e);return}let c=yield n.getKeys();if(!c.length){t(e);return}let h=[];for(;c.length;){let f=c.shift();if(!f)continue;let v=f.toLowerCase();if(v.includes("wc@")||v.includes("walletconnect")||v.includes("wc_")||v.includes("wallet_connect")){let y=yield n.getItem(f);yield e.setItem(f,y),h.push(f)}}yield e.setItem(i,gd),t(e),Fx(n,h)}),Fx=(n,e)=>m(void 0,null,function*(){e.length&&e.forEach(t=>m(void 0,null,function*(){yield n.removeItem(t)}))}),so=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};let e=new Uc;this.storage=e;try{let t=new Mc;Lx(e,t,this.setInitialized)}catch{this.initialized=!0}}getKeys(){return m(this,null,function*(){return yield this.initialize(),this.storage.getKeys()})}getEntries(){return m(this,null,function*(){return yield this.initialize(),this.storage.getEntries()})}getItem(e){return m(this,null,function*(){return yield this.initialize(),this.storage.getItem(e)})}setItem(e,t){return m(this,null,function*(){return yield this.initialize(),this.storage.setItem(e,t)})}removeItem(e){return m(this,null,function*(){return yield this.initialize(),this.storage.removeItem(e)})}initialize(){return m(this,null,function*(){this.initialized||(yield new Promise(e=>{let t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)}))})}};var vi=Me(Ed()),fe=Me(uo());Bc();var Md=Me(mr()),ho=class extends tr{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}};var lo=class extends tr{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}},fo=class{constructor(e,t){this.logger=e,this.core=t}},po=class extends tr{constructor(e,t){super(),this.relayer=e,this.logger=t}},go=class extends tr{constructor(e){super()}},yo=class{constructor(e,t,i,o){this.core=e,this.logger=t,this.name=i}};var mo=class extends tr{constructor(e,t){super(),this.relayer=e,this.logger=t}};var vo=class extends tr{constructor(e,t){super(),this.core=e,this.logger=t}};var _o=class{constructor(e,t){this.projectId=e,this.logger=t}},wo=class{constructor(e,t){this.projectId=e,this.logger=t}};var bo=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}};var Eo=class{constructor(e){this.client=e}};var Ms=Me(tg()),pg=Me(mp()),dg=Me(Es());var rg="EdDSA",ig="JWT",du=".",gu="base64url",sg="utf8",ng="utf8",og=":",ag="did",cg="key",yu="base58btc",ug="z",hg="K36";function xo(n){return qi(Jn($t(n),sg),gu)}function Io(n){let e=Jn(hg,yu),t=ug+qi(vp([e,n]),yu);return[ag,cg,t].join(og)}function rS(n){return qi(n,gu)}function lg(n){return Jn([xo(n.header),xo(n.payload)].join(du),ng)}function fg(n){return[xo(n.header),xo(n.payload),rS(n.signature)].join(du)}function mu(n=(0,pg.randomBytes)(32)){return Ms.generateKeyPairFromSeed(n)}function gg(c,h,f,v){return m(this,arguments,function*(n,e,t,i,o=(0,dg.fromMiliseconds)(Date.now())){let y={alg:rg,typ:ig},g=Io(i.publicKey),w=o+t,E={iss:g,sub:n,aud:e,iat:o,exp:w},S=lg({header:y,payload:E}),R=Ms.sign(i.secretKey,S);return fg({header:y,payload:E,signature:R})})}var le=Me(Es());var Lg=Me(mr());var it={};ai(it,{DEFAULT_ERROR:()=>zs,IBaseJsonRpcProvider:()=>Do,IEvents:()=>Yi,IJsonRpcConnection:()=>Iu,IJsonRpcProvider:()=>ks,INTERNAL_ERROR:()=>So,INVALID_PARAMS:()=>_g,INVALID_REQUEST:()=>mg,METHOD_NOT_FOUND:()=>vg,PARSE_ERROR:()=>yg,RESERVED_ERROR_CODES:()=>vu,SERVER_ERROR:()=>Us,SERVER_ERROR_CODE_RANGE:()=>Po,STANDARD_ERROR_MAP:()=>$r,formatErrorMessage:()=>Ng,formatJsonRpcError:()=>wr,formatJsonRpcRequest:()=>ir,formatJsonRpcResult:()=>Vr,getBigIntRpcId:()=>Vs,getError:()=>Oo,getErrorByCode:()=>To,isHttpUrl:()=>Lo,isJsonRpcError:()=>yt,isJsonRpcPayload:()=>Pu,isJsonRpcRequest:()=>Xi,isJsonRpcResponse:()=>kr,isJsonRpcResult:()=>Ht,isJsonRpcValidationInvalid:()=>LS,isLocalhostUrl:()=>Su,isNodeJs:()=>Cg,isReservedErrorCode:()=>Ro,isServerErrorCode:()=>nS,isValidDefaultRoute:()=>Co,isValidErrorCode:()=>wg,isValidLeadingWildcardRoute:()=>TS,isValidRoute:()=>OS,isValidTrailingWildcardRoute:()=>AS,isValidWildcardRoute:()=>No,isWsUrl:()=>Fo,parseConnectionError:()=>$s,payloadId:()=>Bs,validateJsonRpcError:()=>oS});var yg="PARSE_ERROR",mg="INVALID_REQUEST",vg="METHOD_NOT_FOUND",_g="INVALID_PARAMS",So="INTERNAL_ERROR",Us="SERVER_ERROR",vu=[-32700,-32600,-32601,-32602,-32603],Po=[-32e3,-32099],$r={[yg]:{code:-32700,message:"Parse error"},[mg]:{code:-32600,message:"Invalid Request"},[vg]:{code:-32601,message:"Method not found"},[_g]:{code:-32602,message:"Invalid params"},[So]:{code:-32603,message:"Internal error"},[Us]:{code:-32e3,message:"Server error"}},zs=Us;function nS(n){return n<=Po[0]&&n>=Po[1]}function Ro(n){return vu.includes(n)}function wg(n){return typeof n=="number"}function Oo(n){return Object.keys($r).includes(n)?$r[n]:$r[zs]}function To(n){let e=Object.values($r).find(t=>t.code===n);return e||$r[zs]}function oS(n){if(typeof n.error.code>"u")return{valid:!1,error:"Missing code for JSON-RPC error"};if(typeof n.error.message>"u")return{valid:!1,error:"Missing message for JSON-RPC error"};if(!wg(n.error.code))return{valid:!1,error:`Invalid error code type for JSON-RPC: ${n.error.code}`};if(Ro(n.error.code)){let e=To(n.error.code);if(e.message!==$r[zs].message&&n.error.message===e.message)return{valid:!1,error:`Invalid error code message for JSON-RPC: ${n.error.code}`}}return{valid:!0}}function $s(n,e,t){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):n}var gt={};ai(gt,{isNodeJs:()=>Cg});var Ag=Me(xu());Tt(gt,Me(xu()));var Cg=Ag.isNode;Tt(it,gt);function Bs(n=3){let e=Date.now()*Math.pow(10,n),t=Math.floor(Math.random()*Math.pow(10,n));return e+t}function Vs(n=6){return BigInt(Bs(n))}function ir(n,e,t){return{id:t||Bs(),jsonrpc:"2.0",method:n,params:e}}function Vr(n,e){return{id:n,jsonrpc:"2.0",result:e}}function wr(n,e,t){return{id:n,jsonrpc:"2.0",error:Ng(e,t)}}function Ng(n,e){return typeof n>"u"?Oo(So):(typeof n=="string"&&(n=Object.assign(Object.assign({},Oo(Us)),{message:n})),typeof e<"u"&&(n.data=e),Ro(n.code)&&(n=To(n.code)),n)}function OS(n){return n.includes("*")?No(n):!/\W/g.test(n)}function Co(n){return n==="*"}function No(n){return Co(n)?!0:!(!n.includes("*")||n.split("*").length!==2||n.split("*").filter(e=>e.trim()==="").length!==1)}function TS(n){return!Co(n)&&No(n)&&!n.split("*")[0].trim()}function AS(n){return!Co(n)&&No(n)&&!n.split("*")[1].trim()}var Yi=class{};var Iu=class extends Yi{constructor(e){super()}},Do=class extends Yi{constructor(){super()}},ks=class extends Do{constructor(e){super()}};var CS="^https?:",NS="^wss?:";function DS(n){let e=n.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Dg(n,e){let t=DS(n);return typeof t>"u"?!1:new RegExp(e).test(t)}function Lo(n){return Dg(n,CS)}function Fo(n){return Dg(n,NS)}function Su(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function Pu(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function Xi(n){return Pu(n)&&"method"in n}function kr(n){return Pu(n)&&(Ht(n)||yt(n))}function Ht(n){return"result"in n}function yt(n){return"error"in n}function LS(n){return"error"in n&&n.valid===!1}var Ct=class extends ks{constructor(e){super(e),this.events=new Lg.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}connect(){return m(this,arguments,function*(e=this.connection){yield this.open(e)})}disconnect(){return m(this,null,function*(){yield this.close()})}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}request(e,t){return m(this,null,function*(){return this.requestStrict(ir(e.method,e.params||[],e.id||Vs().toString()),t)})}requestStrict(e,t){return m(this,null,function*(){return new Promise((i,o)=>m(this,null,function*(){if(!this.connection.connected)try{yield this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{yt(c)?o(c.error):i(c.result)});try{yield this.connection.send(e,t)}catch(c){o(c)}}))})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),kr(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}open(){return m(this,arguments,function*(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(yield this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),yield this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))})}close(){return m(this,null,function*(){yield this.connection.close()})}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};var Ug=Me(mr());var FS=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:jg(),jS=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",qg=n=>n.split("?")[0],Mg=10,qS=FS(),jo=class{constructor(e){if(this.url=e,this.events=new Ug.EventEmitter,this.registering=!1,!Fo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}open(){return m(this,arguments,function*(e=this.url){yield this.register(e)})}close(){return m(this,null,function*(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})})}send(e){return m(this,null,function*(){typeof this.socket>"u"&&(this.socket=yield this.register());try{this.socket.send($t(e))}catch(t){this.onError(e.id,t)}})}register(e=this.url){if(!Fo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){let t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,i)=>{let o=new URLSearchParams(e).get("origin"),c=(0,it.isReactNative)()?{headers:{origin:o}}:{rejectUnauthorized:!Su(e)},h=new qS(e,[],c);jS()?h.onerror=f=>{let v=f;i(this.emitError(v.error))}:h.on("error",f=>{i(this.emitError(f))}),h.onopen=()=>{this.onOpen(h),t(h)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;let t=typeof e.data=="string"?er(e.data):e.data;this.events.emit("payload",t)}onError(e,t){let i=this.parseError(t),o=i.message||i.toString(),c=wr(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return $s(e,qg(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Mg&&this.events.setMaxListeners(Mg)}emitError(e){let t=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${qg(this.url)}`));return this.events.emit("register_error",t),t}};var $y=Me(wy()),Hy=Me(Ey());function gR(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var o=0;o<n.length;o++){var c=n.charAt(o),h=c.charCodeAt(0);if(t[h]!==255)throw new TypeError(c+" is ambiguous");t[h]=o}var f=n.length,v=n.charAt(0),y=Math.log(f)/Math.log(256),g=Math.log(256)/Math.log(f);function w(R){if(R instanceof Uint8Array||(ArrayBuffer.isView(R)?R=new Uint8Array(R.buffer,R.byteOffset,R.byteLength):Array.isArray(R)&&(R=Uint8Array.from(R))),!(R instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(R.length===0)return"";for(var j=0,q=0,V=0,J=R.length;V!==J&&R[V]===0;)V++,j++;for(var H=(J-V)*g+1>>>0,z=new Uint8Array(H);V!==J;){for(var ee=R[V],se=0,A=H-1;(ee!==0||se<q)&&A!==-1;A--,se++)ee+=256*z[A]>>>0,z[A]=ee%f>>>0,ee=ee/f>>>0;if(ee!==0)throw new Error("Non-zero carry");q=se,V++}for(var N=H-q;N!==H&&z[N]===0;)N++;for(var re=v.repeat(j);N<H;++N)re+=n.charAt(z[N]);return re}function E(R){if(typeof R!="string")throw new TypeError("Expected String");if(R.length===0)return new Uint8Array;var j=0;if(R[j]!==" "){for(var q=0,V=0;R[j]===v;)q++,j++;for(var J=(R.length-j)*y+1>>>0,H=new Uint8Array(J);R[j];){var z=t[R.charCodeAt(j)];if(z===255)return;for(var ee=0,se=J-1;(z!==0||ee<V)&&se!==-1;se--,ee++)z+=f*H[se]>>>0,H[se]=z%256>>>0,z=z/256>>>0;if(z!==0)throw new Error("Non-zero carry");V=ee,j++}if(R[j]!==" "){for(var A=J-V;A!==J&&H[A]===0;)A++;for(var N=new Uint8Array(q+(J-A)),re=q;A!==J;)N[re++]=H[A++];return N}}}function S(R){var j=E(R);if(j)return j;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:E,decode:S}}var yR=gR,mR=yR,By=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},vR=n=>new TextEncoder().encode(n),_R=n=>new TextDecoder().decode(n),Bu=class{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Vu=class{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Vy(this,e)}},ku=class{constructor(e){this.decoders=e}or(e){return Vy(this,e)}decode(e){let t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Vy=(n,e)=>new ku(Be(Be({},n.decoders||{[n.prefix]:n}),e.decoders||{[e.prefix]:e})),Ku=class{constructor(e,t,i,o){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=o,this.encoder=new Bu(e,t,i),this.decoder=new Vu(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Wo=({name:n,prefix:e,encode:t,decode:i})=>new Ku(n,e,t,i),Zs=({prefix:n,name:e,alphabet:t})=>{let{encode:i,decode:o}=mR(t,e);return Wo({prefix:n,name:e,encode:i,decode:c=>By(o(c))})},wR=(n,e,t,i)=>{let o={};for(let g=0;g<e.length;++g)o[e[g]]=g;let c=n.length;for(;n[c-1]==="=";)--c;let h=new Uint8Array(c*t/8|0),f=0,v=0,y=0;for(let g=0;g<c;++g){let w=o[n[g]];if(w===void 0)throw new SyntaxError(`Non-${i} character`);v=v<<t|w,f+=t,f>=8&&(f-=8,h[y++]=255&v>>f)}if(f>=t||255&v<<8-f)throw new SyntaxError("Unexpected end of data");return h},bR=(n,e,t)=>{let i=e[e.length-1]==="=",o=(1<<t)-1,c="",h=0,f=0;for(let v=0;v<n.length;++v)for(f=f<<8|n[v],h+=8;h>t;)h-=t,c+=e[o&f>>h];if(h&&(c+=e[o&f<<t-h]),i)for(;c.length*t&7;)c+="=";return c},at=({name:n,prefix:e,bitsPerChar:t,alphabet:i})=>Wo({prefix:e,name:n,encode(o){return bR(o,i,t)},decode(o){return wR(o,i,t,n)}}),ER=Wo({prefix:"\0",name:"identity",encode:n=>_R(n),decode:n=>vR(n)}),xR=Object.freeze({__proto__:null,identity:ER}),IR=at({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),SR=Object.freeze({__proto__:null,base2:IR}),PR=at({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),RR=Object.freeze({__proto__:null,base8:PR}),OR=Zs({prefix:"9",name:"base10",alphabet:"0123456789"}),TR=Object.freeze({__proto__:null,base10:OR}),AR=at({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),CR=at({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),NR=Object.freeze({__proto__:null,base16:AR,base16upper:CR}),DR=at({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),LR=at({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),FR=at({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),jR=at({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),qR=at({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),MR=at({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),UR=at({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),zR=at({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$R=at({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),HR=Object.freeze({__proto__:null,base32:DR,base32upper:LR,base32pad:FR,base32padupper:jR,base32hex:qR,base32hexupper:MR,base32hexpad:UR,base32hexpadupper:zR,base32z:$R}),BR=Zs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),VR=Zs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),kR=Object.freeze({__proto__:null,base36:BR,base36upper:VR}),KR=Zs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),GR=Zs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),WR=Object.freeze({__proto__:null,base58btc:KR,base58flickr:GR}),JR=at({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),YR=at({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),XR=at({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),QR=at({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ZR=Object.freeze({__proto__:null,base64:JR,base64pad:YR,base64url:XR,base64urlpad:QR}),ky=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),eO=ky.reduce((n,e,t)=>(n[t]=e,n),[]),tO=ky.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function rO(n){return n.reduce((e,t)=>(e+=eO[t],e),"")}function iO(n){let e=[];for(let t of n){let i=tO[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}var sO=Wo({prefix:"\u{1F680}",name:"base256emoji",encode:rO,decode:iO}),nO=Object.freeze({__proto__:null,base256emoji:sO}),oO=Ky,xy=128,aO=127,cO=~aO,uO=Math.pow(2,31);function Ky(n,e,t){e=e||[],t=t||0;for(var i=t;n>=uO;)e[t++]=n&255|xy,n/=128;for(;n&cO;)e[t++]=n&255|xy,n>>>=7;return e[t]=n|0,Ky.bytes=t-i+1,e}var hO=Gu,lO=128,Iy=127;function Gu(n,i){var t=0,i=i||0,o=0,c=i,h,f=n.length;do{if(c>=f)throw Gu.bytes=0,new RangeError("Could not decode varint");h=n[c++],t+=o<28?(h&Iy)<<o:(h&Iy)*Math.pow(2,o),o+=7}while(h>=lO);return Gu.bytes=c-i,t}var fO=Math.pow(2,7),pO=Math.pow(2,14),dO=Math.pow(2,21),gO=Math.pow(2,28),yO=Math.pow(2,35),mO=Math.pow(2,42),vO=Math.pow(2,49),_O=Math.pow(2,56),wO=Math.pow(2,63),bO=function(n){return n<fO?1:n<pO?2:n<dO?3:n<gO?4:n<yO?5:n<mO?6:n<vO?7:n<_O?8:n<wO?9:10},EO={encode:oO,decode:hO,encodingLength:bO},Gy=EO,Sy=(n,e,t=0)=>(Gy.encode(n,e,t),e),Py=n=>Gy.encodingLength(n),Wu=(n,e)=>{let t=e.byteLength,i=Py(n),o=i+Py(t),c=new Uint8Array(o+t);return Sy(n,c,0),Sy(t,c,i),c.set(e,o),new Ju(n,t,e,c)},Ju=class{constructor(e,t,i,o){this.code=e,this.size=t,this.digest=i,this.bytes=o}},Wy=({name:n,code:e,encode:t})=>new Yu(n,e,t),Yu=class{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?Wu(this.code,t):t.then(i=>Wu(this.code,i))}else throw Error("Unknown type, must be binary type")}},Jy=n=>e=>m(void 0,null,function*(){return new Uint8Array(yield crypto.subtle.digest(n,e))}),xO=Wy({name:"sha2-256",code:18,encode:Jy("SHA-256")}),IO=Wy({name:"sha2-512",code:19,encode:Jy("SHA-512")}),SO=Object.freeze({__proto__:null,sha256:xO,sha512:IO}),Yy=0,PO="identity",Xy=By,RO=n=>Wu(Yy,Xy(n)),OO={code:Yy,name:PO,encode:Xy,digest:RO},TO=Object.freeze({__proto__:null,identity:OO});new TextEncoder,new TextDecoder;var Ry=Be(Be(Be(Be(Be(Be(Be(Be(Be(Be({},xR),SR),RR),TR),NR),HR),kR),WR),ZR),nO);Be(Be({},SO),TO);function Qy(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function AO(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Qy(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Zy(n,e,t,i){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:i}}}var Oy=Zy("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),zu=Zy("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);let e=AO(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),CO=Be({utf8:Oy,"utf-8":Oy,hex:Ry.base16,latin1:zu,ascii:zu,binary:zu},Ry);function NO(n,e="utf8"){let t=CO[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Qy(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}var em="wc",DO=2,lh="core",Wr=`${em}@2:${lh}:`,LO={name:lh,logger:"error"},FO={database:":memory:"},jO="crypto",Ty="client_ed25519_seed",qO=le.ONE_DAY,MO="keychain",UO="0.3",zO="messages",$O="0.3",HO=le.SIX_HOURS,BO="publisher",fh="irn",VO="error",tm="wss://relay.walletconnect.com",Ay="wss://relay.walletconnect.org",kO="relayer",ot={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},KO="_subscription",xr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},GO=le.ONE_SECOND;var WO="2.11.0",JO=1e4,YO="0.3",XO="WALLETCONNECT_CLIENT_ID",Wt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"};var QO="subscription",ZO="0.3",e6=le.FIVE_SECONDS*1e3,t6="pairing",r6="0.3";var Xs={wc_pairingDelete:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:le.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:le.ONE_DAY,prompt:!1,tag:0},res:{ttl:le.ONE_DAY,prompt:!1,tag:0}}},ts={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},nr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},i6="history",s6="0.3",n6="expirer",Nt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},o6="0.3";var $u="verify-api",yi="https://verify.walletconnect.com",Xu="https://verify.walletconnect.org",a6=[yi,Xu],c6="echo",u6="https://echo.walletconnect.com",Qu=class{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=MO,this.version=UO,this.initialized=!1,this.storagePrefix=Wr,this.init=()=>m(this,null,function*(){if(!this.initialized){let i=yield this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}}),this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=(i,o)=>m(this,null,function*(){this.isInitialized(),this.keychain.set(i,o),yield this.persist()}),this.get=i=>{this.isInitialized();let o=this.keychain.get(i);if(typeof o>"u"){let{message:c}=k("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(c)}return o},this.del=i=>m(this,null,function*(){this.isInitialized(),this.keychain.delete(i),yield this.persist()}),this.core=e,this.logger=(0,fe.generateChildLogger)(t,this.name)}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}setKeyChain(e){return m(this,null,function*(){yield this.core.storage.setItem(this.storageKey,Pc(e))})}getKeyChain(){return m(this,null,function*(){let e=yield this.core.storage.getItem(this.storageKey);return typeof e<"u"?Rc(e):void 0})}persist(){return m(this,null,function*(){yield this.setKeyChain(this.keychain)})}isInitialized(){if(!this.initialized){let{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}},Zu=class{constructor(e,t,i){this.core=e,this.logger=t,this.name=jO,this.initialized=!1,this.init=()=>m(this,null,function*(){this.initialized||(yield this.keychain.init(),this.initialized=!0)}),this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=()=>m(this,null,function*(){this.isInitialized();let o=yield this.getClientSeed(),c=mu(o);return Io(c.publicKey)}),this.generateKeyPair=()=>{this.isInitialized();let o=Ep();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=o=>m(this,null,function*(){this.isInitialized();let c=yield this.getClientSeed(),h=mu(c),f=Xn();return yield gg(f,o,qO,h)}),this.generateSharedKey=(o,c,h)=>{this.isInitialized();let f=this.getPrivateKey(o),v=xp(f,c);return this.setSymKey(v,h)},this.setSymKey=(o,c)=>m(this,null,function*(){this.isInitialized();let h=c||Ip(o);return yield this.keychain.set(h,o),h}),this.deleteKeyPair=o=>m(this,null,function*(){this.isInitialized(),yield this.keychain.del(o)}),this.deleteSymKey=o=>m(this,null,function*(){this.isInitialized(),yield this.keychain.del(o)}),this.encode=(o,c,h)=>m(this,null,function*(){this.isInitialized();let f=Tp(h),v=$t(c);if(Sc(f)){let E=f.senderPublicKey,S=f.receiverPublicKey;o=yield this.generateSharedKey(E,S)}let y=this.getSymKey(o),{type:g,senderPublicKey:w}=f;return Pp({type:g,symKey:y,message:v,senderPublicKey:w})}),this.decode=(o,c,h)=>m(this,null,function*(){this.isInitialized();let f=Op(c,h);if(Sc(f)){let v=f.receiverPublicKey,y=f.senderPublicKey;o=yield this.generateSharedKey(v,y)}try{let v=this.getSymKey(o),y=Rp({symKey:v,encoded:c});return er(y)}catch(v){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${yield this.getClientId()}'`),this.logger.error(v)}}),this.getPayloadType=o=>{let c=Ic(o);return Sp(c.type)},this.getPayloadSenderPublicKey=o=>{let c=Ic(o);return c.senderPublicKey?qi(c.senderPublicKey,bp):void 0},this.core=e,this.logger=(0,fe.generateChildLogger)(t,this.name),this.keychain=i||new Qu(this.core,this.logger)}get context(){return(0,fe.getLoggerContext)(this.logger)}setPrivateKey(e,t){return m(this,null,function*(){return yield this.keychain.set(e,t),e})}getPrivateKey(e){return this.keychain.get(e)}getClientSeed(){return m(this,null,function*(){let e="";try{e=this.keychain.get(Ty)}catch{e=Xn(),yield this.keychain.set(Ty,e)}return NO(e,"base16")})}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){let{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}},eh=class extends fo{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=zO,this.version=$O,this.initialized=!1,this.storagePrefix=Wr,this.init=()=>m(this,null,function*(){if(!this.initialized){this.logger.trace("Initialized");try{let i=yield this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}}),this.set=(i,o)=>m(this,null,function*(){this.isInitialized();let c=qr(o),h=this.messages.get(i);return typeof h>"u"&&(h={}),typeof h[c]<"u"||(h[c]=o,this.messages.set(i,h),yield this.persist()),c}),this.get=i=>{this.isInitialized();let o=this.messages.get(i);return typeof o>"u"&&(o={}),o},this.has=(i,o)=>{this.isInitialized();let c=this.get(i),h=qr(o);return typeof c[h]<"u"},this.del=i=>m(this,null,function*(){this.isInitialized(),this.messages.delete(i),yield this.persist()}),this.logger=(0,fe.generateChildLogger)(e,this.name),this.core=t}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}setRelayerMessages(e){return m(this,null,function*(){yield this.core.storage.setItem(this.storageKey,Pc(e))})}getRelayerMessages(){return m(this,null,function*(){let e=yield this.core.storage.getItem(this.storageKey);return typeof e<"u"?Rc(e):void 0})}persist(){return m(this,null,function*(){yield this.setRelayerMessages(this.messages)})}isInitialized(){if(!this.initialized){let{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}},th=class extends po{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Ir.EventEmitter,this.name=BO,this.queue=new Map,this.publishTimeout=(0,le.toMiliseconds)(le.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=(i,o,c)=>m(this,null,function*(){var h;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:o,opts:c}});try{let f=c?.ttl||HO,v=to(c),y=c?.prompt||!1,g=c?.tag||0,w=c?.id||Vs().toString(),E={topic:i,message:o,opts:{ttl:f,relay:v,prompt:y,tag:g,id:w}},S=setTimeout(()=>this.queue.set(w,E),this.publishTimeout);try{yield yield Mi(this.rpcPublish(i,o,f,v,y,g,w),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(w),this.relayer.events.emit(ot.publish,E)}catch(R){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(h=c?.internal)!=null&&h.throwOnFailedPublish)throw this.removeRequestFromQueue(w),R;return}finally{clearTimeout(S)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}}),this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.relayer=e,this.logger=(0,fe.generateChildLogger)(t,this.name),this.registerEventListeners()}get context(){return(0,fe.getLoggerContext)(this.logger)}rpcPublish(e,t,i,o,c,h,f){var v,y,g,w;let E={method:xs(o.protocol).publish,params:{topic:e,message:t,ttl:i,prompt:c,tag:h},id:f};return Zt((v=E.params)==null?void 0:v.prompt)&&((y=E.params)==null||delete y.prompt),Zt((g=E.params)==null?void 0:g.tag)&&((w=E.params)==null||delete w.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:E}),this.relayer.request(E)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(e=>m(this,null,function*(){let{topic:t,message:i,opts:o}=e;yield this.publish(t,i,o)}))}registerEventListeners(){this.relayer.core.heartbeat.on(vi.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(ot.connection_stalled);return}this.checkQueue()}),this.relayer.on(ot.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}},rh=class{constructor(){this.map=new Map,this.set=(e,t)=>{let i=this.get(e);this.exists(e,t)||this.map.set(e,[...i,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;let i=this.get(e);if(!this.exists(e,t))return;let o=i.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}},h6=Object.defineProperty,l6=Object.defineProperties,f6=Object.getOwnPropertyDescriptors,Cy=Object.getOwnPropertySymbols,p6=Object.prototype.hasOwnProperty,d6=Object.prototype.propertyIsEnumerable,Ny=(n,e,t)=>e in n?h6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Qs=(n,e)=>{for(var t in e||(e={}))p6.call(e,t)&&Ny(n,t,e[t]);if(Cy)for(var t of Cy(e))d6.call(e,t)&&Ny(n,t,e[t]);return n},Hu=(n,e)=>l6(n,f6(e)),ih=class extends mo{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new rh,this.events=new Ir.EventEmitter,this.name=QO,this.version=ZO,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Wr,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=()=>m(this,null,function*(){this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=yield this.relayer.core.crypto.getClientId())}),this.subscribe=(i,o)=>m(this,null,function*(){yield this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:o}});try{let c=to(o),h={topic:i,relay:c};this.pending.set(i,h);let f=yield this.rpcSubscribe(i,c);return this.onSubscribe(f,h),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}}),this.unsubscribe=(i,o)=>m(this,null,function*(){yield this.restartToComplete(),this.isInitialized(),typeof o?.id<"u"?yield this.unsubscribeById(i,o.id,o):yield this.unsubscribeByTopic(i,o)}),this.isSubscribed=i=>m(this,null,function*(){return this.topics.includes(i)?!0:yield new Promise((o,c)=>{let h=new le.Watch;h.start(this.pendingSubscriptionWatchLabel);let f=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(f),h.stop(this.pendingSubscriptionWatchLabel),o(!0)),h.elapsed(this.pendingSubscriptionWatchLabel)>=e6&&(clearInterval(f),h.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)}),this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.restart=()=>m(this,null,function*(){this.restartInProgress=!0,yield this.restore(),yield this.reset(),this.restartInProgress=!1}),this.relayer=e,this.logger=(0,fe.generateChildLogger)(t,this.name),this.clientId=""}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let i=!1;try{i=this.getSubscription(e).topic===t}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}unsubscribeByTopic(e,t){return m(this,null,function*(){let i=this.topicMap.get(e);yield Promise.all(i.map(o=>m(this,null,function*(){return yield this.unsubscribeById(e,o,t)})))})}unsubscribeById(e,t,i){return m(this,null,function*(){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}});try{let o=to(i);yield this.rpcUnsubscribe(e,t,o);let c=Ye("USER_DISCONNECTED",`${this.name}, ${e}`);yield this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}})}rpcSubscribe(e,t){return m(this,null,function*(){let i={method:xs(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{yield yield Mi(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(ot.connection_stalled)}return qr(e+this.clientId)})}rpcBatchSubscribe(e){return m(this,null,function*(){if(!e.length)return;let t=e[0].relay,i={method:xs(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return yield yield Mi(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(ot.connection_stalled)}})}rpcUnsubscribe(e,t,i){let o={method:xs(i.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,Hu(Qs({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,Qs({},t)),this.pending.delete(t.topic)})}onUnsubscribe(e,t,i){return m(this,null,function*(){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,i),yield this.relayer.messages.del(e)})}setRelayerSubscriptions(e){return m(this,null,function*(){yield this.relayer.core.storage.setItem(this.storageKey,e)})}getRelayerSubscriptions(){return m(this,null,function*(){return yield this.relayer.core.storage.getItem(this.storageKey)})}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,Qs({},t)),this.topicMap.set(t.topic,e),this.events.emit(Wt.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});let t=this.subscriptions.get(e);if(!t){let{message:i}=k("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});let i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Wt.deleted,Hu(Qs({},i),{reason:t}))}persist(){return m(this,null,function*(){yield this.setRelayerSubscriptions(this.values),this.events.emit(Wt.sync)})}reset(){return m(this,null,function*(){if(this.cached.length){let e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){let i=this.cached.splice(0,this.batchSubscribeTopicsLimit);yield this.batchSubscribe(i)}}this.events.emit(Wt.resubscribed)})}restore(){return m(this,null,function*(){try{let e=yield this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){let{message:t}=k("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}})}batchSubscribe(e){return m(this,null,function*(){if(!e.length)return;let t=yield this.rpcBatchSubscribe(e);vr(t)&&this.onBatchSubscribe(t.map((i,o)=>Hu(Qs({},e[o]),{id:i})))})}onConnect(){return m(this,null,function*(){this.restartInProgress||(yield this.restart(),this.onEnable())})}onDisconnect(){this.onDisable()}checkPending(){return m(this,null,function*(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;let e=[];this.pending.forEach(t=>{e.push(t)}),yield this.batchSubscribe(e)})}registerEventListeners(){this.relayer.core.heartbeat.on(vi.HEARTBEAT_EVENTS.pulse,()=>m(this,null,function*(){yield this.checkPending()})),this.relayer.on(ot.connect,()=>m(this,null,function*(){yield this.onConnect()})),this.relayer.on(ot.disconnect,()=>{this.onDisconnect()}),this.events.on(Wt.created,e=>m(this,null,function*(){let t=Wt.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),yield this.persist()})),this.events.on(Wt.deleted,e=>m(this,null,function*(){let t=Wt.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),yield this.persist()}))}isInitialized(){if(!this.initialized){let{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}restartToComplete(){return m(this,null,function*(){this.restartInProgress&&(yield new Promise(e=>{let t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)}))})}},g6=Object.defineProperty,Dy=Object.getOwnPropertySymbols,y6=Object.prototype.hasOwnProperty,m6=Object.prototype.propertyIsEnumerable,Ly=(n,e,t)=>e in n?g6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,v6=(n,e)=>{for(var t in e||(e={}))y6.call(e,t)&&Ly(n,t,e[t]);if(Dy)for(var t of Dy(e))m6.call(e,t)&&Ly(n,t,e[t]);return n},sh=class extends go{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Ir.EventEmitter,this.name=kO,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=t=>m(this,null,function*(){this.logger.debug("Publishing Request Payload");try{return yield this.toEstablishConnection(),yield this.provider.request(t)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}}),this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(ot.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(ot.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(xr.payload,this.onPayloadHandler),this.provider.on(xr.connect,this.onConnectHandler),this.provider.on(xr.disconnect,this.onDisconnectHandler),this.provider.on(xr.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?(0,fe.generateChildLogger)(e.logger,this.name):(0,fe.pino)((0,fe.getDefaultLoggerOptions)({level:e.logger||VO})),this.messages=new eh(this.logger,e.core),this.subscriber=new ih(this,this.logger),this.publisher=new th(this,this.logger),this.relayUrl=e?.relayUrl||tm,this.projectId=e.projectId,this.bundleId=Np(),this.provider={}}init(){return m(this,null,function*(){this.logger.trace("Initialized"),this.registerEventListeners(),yield this.createProvider(),yield Promise.all([this.messages.init(),this.subscriber.init()]);try{yield this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Ay}...`),yield this.restartTransport(Ay)}this.initialized=!0,setTimeout(()=>m(this,null,function*(){this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),yield this.transportClose(),this.transportExplicitlyClosed=!1)}),JO)})}get context(){return(0,fe.getLoggerContext)(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}publish(e,t,i){return m(this,null,function*(){this.isInitialized(),yield this.publisher.publish(e,t,i),yield this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})})}subscribe(e,t){return m(this,null,function*(){var i;this.isInitialized();let o=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"";if(o)return o;let c,h=f=>{f.topic===e&&(this.subscriber.off(Wt.created,h),c())};return yield Promise.all([new Promise(f=>{c=f,this.subscriber.on(Wt.created,h)}),new Promise(f=>m(this,null,function*(){o=yield this.subscriber.subscribe(e,t),f()}))]),o})}unsubscribe(e,t){return m(this,null,function*(){this.isInitialized(),yield this.subscriber.unsubscribe(e,t)})}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}transportClose(){return m(this,null,function*(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?yield Mi(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&(yield this.provider.disconnect())})}transportOpen(e){return m(this,null,function*(){if(this.transportExplicitlyClosed=!1,yield this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,yield this.transportClose(),yield this.createProvider()),this.connectionAttemptInProgress=!0;try{yield Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(Wt.resubscribed,()=>{t()})}),new Promise((t,i)=>m(this,null,function*(){try{yield Mi(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){i(o);return}t()}))])}catch(t){this.logger.error(t);let i=t;if(!this.isConnectionStalled(i.message))throw t;this.provider.events.emit(xr.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}})}restartTransport(e){return m(this,null,function*(){yield this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,yield this.transportClose(),yield this.createProvider(),yield this.transportOpen())})}confirmOnlineStateOrThrow(){return m(this,null,function*(){if(!(yield Nc()))throw new Error("No internet connection detected. Please restart your network and try again.")})}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}createProvider(){return m(this,null,function*(){this.provider.connection&&this.unregisterProviderListeners();let e=yield this.core.crypto.signJWT(this.relayUrl);this.provider=new Ct(new jo(Lp({sdkVersion:WO,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()})}recordMessageEvent(e){return m(this,null,function*(){let{topic:t,message:i}=e;yield this.messages.set(t,i)})}shouldIgnoreMessageEvent(e){return m(this,null,function*(){let{topic:t,message:i}=e;if(!i||i.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${i}`),!0;if(!(yield this.subscriber.isSubscribed(t)))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;let o=this.messages.has(t,i);return o&&this.logger.debug(`Ignoring duplicate message: ${i}`),o})}onProviderPayload(e){return m(this,null,function*(){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Xi(e)){if(!e.method.endsWith(KO))return;let t=e.params,{topic:i,message:o,publishedAt:c}=t.data,h={topic:i,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(v6({type:"event",event:t.id},h)),this.events.emit(t.id,h),yield this.acknowledgePayload(e),yield this.onMessageEvent(h)}else kr(e)&&this.events.emit(ot.message_ack,e)})}onMessageEvent(e){return m(this,null,function*(){(yield this.shouldIgnoreMessageEvent(e))||(this.events.emit(ot.message,e),yield this.recordMessageEvent(e))})}acknowledgePayload(e){return m(this,null,function*(){let t=Vr(e.id,!0);yield this.provider.connection.send(t)})}unregisterProviderListeners(){this.provider.off(xr.payload,this.onPayloadHandler),this.provider.off(xr.connect,this.onConnectHandler),this.provider.off(xr.disconnect,this.onDisconnectHandler),this.provider.off(xr.error,this.onProviderErrorHandler)}registerEventListeners(){return m(this,null,function*(){this.events.on(ot.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let e=yield Nc();id(t=>m(this,null,function*(){this.initialized&&e!==t&&(e=t,t?yield this.restartTransport().catch(i=>this.logger.error(i)):(this.hasExperiencedNetworkDisruption=!0,yield this.transportClose().catch(i=>this.logger.error(i))))}))})}onProviderDisconnect(){this.events.emit(ot.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(()=>m(this,null,function*(){yield this.restartTransport().catch(e=>this.logger.error(e))}),(0,le.toMiliseconds)(GO)))}isInitialized(){if(!this.initialized){let{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}toEstablishConnection(){return m(this,null,function*(){if(yield this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return yield new Promise(e=>{let t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});yield this.restartTransport()}})}},_6=Object.defineProperty,Fy=Object.getOwnPropertySymbols,w6=Object.prototype.hasOwnProperty,b6=Object.prototype.propertyIsEnumerable,jy=(n,e,t)=>e in n?_6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,qy=(n,e)=>{for(var t in e||(e={}))w6.call(e,t)&&jy(n,t,e[t]);if(Fy)for(var t of Fy(e))b6.call(e,t)&&jy(n,t,e[t]);return n},mi=class extends yo{constructor(e,t,i,o=Wr,c=void 0){super(e,t,i,o),this.core=e,this.logger=t,this.name=i,this.map=new Map,this.version=YO,this.cached=[],this.initialized=!1,this.storagePrefix=Wr,this.init=()=>m(this,null,function*(){this.initialized||(this.logger.trace("Initialized"),yield this.restore(),this.cached.forEach(h=>{this.getKey&&h!==null&&!Zt(h)?this.map.set(this.getKey(h),h):Bp(h)?this.map.set(h.id,h):Vp(h)&&this.map.set(h.topic,h)}),this.cached=[],this.initialized=!0)}),this.set=(h,f)=>m(this,null,function*(){this.isInitialized(),this.map.has(h)?yield this.update(h,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:h,value:f}),this.map.set(h,f),yield this.persist())}),this.get=h=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:h}),this.getData(h)),this.getAll=h=>(this.isInitialized(),h?this.values.filter(f=>Object.keys(h).every(v=>(0,$y.default)(f[v],h[v]))):this.values),this.update=(h,f)=>m(this,null,function*(){this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:h,update:f});let v=qy(qy({},this.getData(h)),f);this.map.set(h,v),yield this.persist()}),this.delete=(h,f)=>m(this,null,function*(){this.isInitialized(),this.map.has(h)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:h,reason:f}),this.map.delete(h),yield this.persist())}),this.logger=(0,fe.generateChildLogger)(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}setDataStore(e){return m(this,null,function*(){yield this.core.storage.setItem(this.storageKey,e)})}getDataStore(){return m(this,null,function*(){return yield this.core.storage.getItem(this.storageKey)})}getData(e){let t=this.map.get(e);if(!t){let{message:i}=k("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return t}persist(){return m(this,null,function*(){yield this.setDataStore(this.values)})}restore(){return m(this,null,function*(){try{let e=yield this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){let{message:t}=k("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}})}isInitialized(){if(!this.initialized){let{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}},nh=class{constructor(e,t){this.core=e,this.logger=t,this.name=t6,this.version=r6,this.events=new Ir.default,this.initialized=!1,this.storagePrefix=Wr,this.ignoredPayloadTypes=[Yn],this.registeredMethods=[],this.init=()=>m(this,null,function*(){this.initialized||(yield this.pairings.init(),yield this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=()=>m(this,null,function*(){this.isInitialized();let i=Xn(),o=yield this.core.crypto.setSymKey(i),c=At(le.FIVE_MINUTES),h={protocol:fh},f={topic:o,expiry:c,relay:h,active:!1},v=Up({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:i,relay:h});return yield this.pairings.set(o,f),yield this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:v}}),this.pair=i=>m(this,null,function*(){this.isInitialized(),this.isValidPair(i);let{topic:o,symKey:c,relay:h}=Oc(i.uri),f;if(this.pairings.keys.includes(o)&&(f=this.pairings.get(o),f.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);let v=At(le.FIVE_MINUTES),y={topic:o,relay:h,expiry:v,active:!1};return yield this.pairings.set(o,y),this.core.expirer.set(o,v),i.activatePairing&&(yield this.activate({topic:o})),this.events.emit(ts.create,y),this.core.crypto.keychain.has(o)||(yield this.core.crypto.setSymKey(c,o),yield this.core.relayer.subscribe(o,{relay:h})),y}),this.activate=o=>m(this,[o],function*({topic:i}){this.isInitialized();let c=At(le.THIRTY_DAYS);yield this.pairings.update(i,{active:!0,expiry:c}),this.core.expirer.set(i,c)}),this.ping=i=>m(this,null,function*(){this.isInitialized(),yield this.isValidPing(i);let{topic:o}=i;if(this.pairings.keys.includes(o)){let c=yield this.sendRequest(o,"wc_pairingPing",{}),{done:h,resolve:f,reject:v}=Mr();this.events.once(Ue("pairing_ping",c),({error:y})=>{y?v(y):f()}),yield h()}}),this.updateExpiry=c=>m(this,[c],function*({topic:i,expiry:o}){this.isInitialized(),yield this.pairings.update(i,{expiry:o})}),this.updateMetadata=c=>m(this,[c],function*({topic:i,metadata:o}){this.isInitialized(),yield this.pairings.update(i,{peerMetadata:o})}),this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=i=>m(this,null,function*(){this.isInitialized(),yield this.isValidDisconnect(i);let{topic:o}=i;this.pairings.keys.includes(o)&&(yield this.sendRequest(o,"wc_pairingDelete",Ye("USER_DISCONNECTED")),yield this.deletePairing(o))}),this.sendRequest=(i,o,c)=>m(this,null,function*(){let h=ir(o,c),f=yield this.core.crypto.encode(i,h),v=Xs[o].req;return this.core.history.set(i,h),this.core.relayer.publish(i,f,v),h.id}),this.sendResult=(i,o,c)=>m(this,null,function*(){let h=Vr(i,c),f=yield this.core.crypto.encode(o,h),v=yield this.core.history.get(o,i),y=Xs[v.request.method].res;yield this.core.relayer.publish(o,f,y),yield this.core.history.resolve(h)}),this.sendError=(i,o,c)=>m(this,null,function*(){let h=wr(i,c),f=yield this.core.crypto.encode(o,h),v=yield this.core.history.get(o,i),y=Xs[v.request.method]?Xs[v.request.method].res:Xs.unregistered_method.res;yield this.core.relayer.publish(o,f,y),yield this.core.history.resolve(h)}),this.deletePairing=(i,o)=>m(this,null,function*(){yield this.core.relayer.unsubscribe(i),yield Promise.all([this.pairings.delete(i,Ye("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),o?Promise.resolve():this.core.expirer.del(i)])}),this.cleanup=()=>m(this,null,function*(){let i=this.pairings.getAll().filter(o=>Qt(o.expiry));yield Promise.all(i.map(o=>this.deletePairing(o.topic)))}),this.onRelayEventRequest=i=>{let{topic:o,payload:c}=i;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=i=>m(this,null,function*(){let{topic:o,payload:c}=i,h=(yield this.core.history.get(o,c.id)).request.method;switch(h){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(h)}}),this.onPairingPingRequest=(i,o)=>m(this,null,function*(){let{id:c}=o;try{this.isValidPing({topic:i}),yield this.sendResult(c,i,!0),this.events.emit(ts.ping,{id:c,topic:i})}catch(h){yield this.sendError(c,i,h),this.logger.error(h)}}),this.onPairingPingResponse=(i,o)=>{let{id:c}=o;setTimeout(()=>{Ht(o)?this.events.emit(Ue("pairing_ping",c),{}):yt(o)&&this.events.emit(Ue("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=(i,o)=>m(this,null,function*(){let{id:c}=o;try{this.isValidDisconnect({topic:i}),yield this.deletePairing(i),this.events.emit(ts.delete,{id:c,topic:i})}catch(h){yield this.sendError(c,i,h),this.logger.error(h)}}),this.onUnknownRpcMethodRequest=(i,o)=>m(this,null,function*(){let{id:c,method:h}=o;try{if(this.registeredMethods.includes(h))return;let f=Ye("WC_METHOD_UNSUPPORTED",h);yield this.sendError(c,i,f),this.logger.error(f)}catch(f){yield this.sendError(c,i,f),this.logger.error(f)}}),this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Ye("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{var o;if(!ht(i)){let{message:h}=k("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(h)}if(!Hp(i.uri)){let{message:h}=k("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(h)}let c=Oc(i.uri);if(!((o=c?.relay)!=null&&o.protocol)){let{message:h}=k("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(h)}if(!(c!=null&&c.symKey)){let{message:h}=k("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(h)}},this.isValidPing=i=>m(this,null,function*(){if(!ht(i)){let{message:c}=k("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(c)}let{topic:o}=i;yield this.isValidPairingTopic(o)}),this.isValidDisconnect=i=>m(this,null,function*(){if(!ht(i)){let{message:c}=k("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(c)}let{topic:o}=i;yield this.isValidPairingTopic(o)}),this.isValidPairingTopic=i=>m(this,null,function*(){if(!Ur(i,!1)){let{message:o}=k("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(o)}if(!this.pairings.keys.includes(i)){let{message:o}=k("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(o)}if(Qt(this.pairings.get(i).expiry)){yield this.deletePairing(i);let{message:o}=k("EXPIRED",`pairing topic: ${i}`);throw new Error(o)}}),this.core=e,this.logger=(0,fe.generateChildLogger)(t,this.name),this.pairings=new mi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,fe.getLoggerContext)(this.logger)}isInitialized(){if(!this.initialized){let{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(ot.message,e=>m(this,null,function*(){let{topic:t,message:i}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;let o=yield this.core.crypto.decode(t,i);try{Xi(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):kr(o)&&(yield this.core.history.resolve(o),yield this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}}))}registerExpirerEvents(){this.core.expirer.on(Nt.expired,e=>m(this,null,function*(){let{topic:t}=Zn(e.target);t&&this.pairings.keys.includes(t)&&(yield this.deletePairing(t,!0),this.events.emit(ts.expire,{topic:t}))}))}},oh=class extends lo{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Ir.EventEmitter,this.name=i6,this.version=s6,this.cached=[],this.initialized=!1,this.storagePrefix=Wr,this.init=()=>m(this,null,function*(){this.initialized||(this.logger.trace("Initialized"),yield this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),this.set=(i,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:o,chainId:c}),this.records.has(o.id))return;let h={id:o.id,topic:i,request:{method:o.method,params:o.params||null},chainId:c,expiry:At(le.THIRTY_DAYS)};this.records.set(h.id,h),this.events.emit(nr.created,h)},this.resolve=i=>m(this,null,function*(){if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;let o=yield this.getRecord(i.id);typeof o.response>"u"&&(o.response=yt(i)?{error:i.error}:{result:i.result},this.records.set(o.id,o),this.events.emit(nr.updated,o))}),this.get=(i,o)=>m(this,null,function*(){return this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:o}),yield this.getRecord(o)}),this.delete=(i,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===i){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(nr.deleted,c)}})},this.exists=(i,o)=>m(this,null,function*(){return this.isInitialized(),this.records.has(o)?(yield this.getRecord(o)).topic===i:!1}),this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.logger=(0,fe.generateChildLogger)(t,this.name)}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;let i={topic:t.topic,request:ir(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(i)}),e}setJsonRpcRecords(e){return m(this,null,function*(){yield this.core.storage.setItem(this.storageKey,e)})}getJsonRpcRecords(){return m(this,null,function*(){return yield this.core.storage.getItem(this.storageKey)})}getRecord(e){this.isInitialized();let t=this.records.get(e);if(!t){let{message:i}=k("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}persist(){return m(this,null,function*(){yield this.setJsonRpcRecords(this.values),this.events.emit(nr.sync)})}restore(){return m(this,null,function*(){try{let e=yield this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){let{message:t}=k("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}})}registerEventListeners(){this.events.on(nr.created,e=>{let t=nr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(nr.updated,e=>{let t=nr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(nr.deleted,e=>{let t=nr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(vi.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{(0,le.toMiliseconds)(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){let{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}},ah=class extends vo{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Ir.EventEmitter,this.name=n6,this.version=o6,this.cached=[],this.initialized=!1,this.storagePrefix=Wr,this.init=()=>m(this,null,function*(){this.initialized||(this.logger.trace("Initialized"),yield this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),this.has=i=>{try{let o=this.formatTarget(i);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(i,o)=>{this.isInitialized();let c=this.formatTarget(i),h={target:c,expiry:o};this.expirations.set(c,h),this.checkExpiry(c,h),this.events.emit(Nt.created,{target:c,expiration:h})},this.get=i=>{this.isInitialized();let o=this.formatTarget(i);return this.getExpiration(o)},this.del=i=>{if(this.isInitialized(),this.has(i)){let o=this.formatTarget(i),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Nt.deleted,{target:o,expiration:c})}},this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.logger=(0,fe.generateChildLogger)(t,this.name)}get context(){return(0,fe.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Fp(e);if(typeof e=="number")return jp(e);let{message:t}=k("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}setExpirations(e){return m(this,null,function*(){yield this.core.storage.setItem(this.storageKey,e)})}getExpirations(){return m(this,null,function*(){return yield this.core.storage.getItem(this.storageKey)})}persist(){return m(this,null,function*(){yield this.setExpirations(this.values),this.events.emit(Nt.sync)})}restore(){return m(this,null,function*(){try{let e=yield this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){let{message:t}=k("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}})}getExpiration(e){let t=this.expirations.get(e);if(!t){let{message:i}=k("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return t}checkExpiry(e,t){let{expiry:i}=t;(0,le.toMiliseconds)(i)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Nt.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(vi.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Nt.created,e=>{let t=Nt.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Nt.expired,e=>{let t=Nt.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Nt.deleted,e=>{let t=Nt.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}}},ch=class extends _o{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=$u,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=i=>m(this,null,function*(){if(this.verifyDisabled||Cp()||!Qn())return;let o=this.getVerifyUrl(i?.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{yield this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Xu;try{yield this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}}),this.register=i=>m(this,null,function*(){this.initialized?this.sendPost(i.attestationId):(this.addToQueue(i.attestationId),yield this.init())}),this.resolve=i=>m(this,null,function*(){if(this.isDevEnv)return"";let o=this.getVerifyUrl(i?.verifyUrl),c;try{c=yield this.fetchAttestation(i.attestationId,o)}catch(h){this.logger.info(`failed to resolve attestation: ${i.attestationId} from url: ${o}`),this.logger.info(h),c=yield this.fetchAttestation(i.attestationId,Xu)}return c}),this.fetchAttestation=(i,o)=>m(this,null,function*(){this.logger.info(`resolving attestation: ${i} from url: ${o}`);let c=this.startAbortTimer(le.ONE_SECOND*2),h=yield fetch(`${o}/attestation/${i}`,{signal:this.abortController.signal});return clearTimeout(c),h.status===200?yield h.json():void 0}),this.addToQueue=i=>{this.queue.push(i)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(i=>this.sendPost(i)),this.queue=[])},this.sendPost=i=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(i,"*"),this.logger.info(`postMessage sent: ${i} ${this.verifyUrl}`)}catch{}},this.createIframe=()=>m(this,null,function*(){let i,o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),i())};yield Promise.race([new Promise(c=>{if(document.getElementById($u))return c();window.addEventListener("message",o);let h=document.createElement("iframe");h.id=$u,h.src=`${this.verifyUrl}/${this.projectId}`,h.style.display="none",document.body.append(h),this.iframe=h,i=c}),new Promise((c,h)=>setTimeout(()=>{window.removeEventListener("message",o),h("verify iframe load timeout")},(0,le.toMiliseconds)(le.FIVE_SECONDS)))])}),this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=i=>{let o=i||yi;return a6.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${yi}`),o=yi),o},this.logger=(0,fe.generateChildLogger)(t,this.name),this.verifyUrl=yi,this.abortController=new AbortController,this.isDevEnv=Ap()&&process.env.IS_VITEST}get context(){return(0,fe.getLoggerContext)(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,le.toMiliseconds)(e))}},uh=class extends wo{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=c6,this.registerDeviceToken=i=>m(this,null,function*(){let{clientId:o,token:c,notificationType:h,enableEncrypted:f=!1}=i,v=`${u6}/${this.projectId}/clients`;yield(0,Hy.default)(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:h,token:c,always_raw:f})})}),this.logger=(0,fe.generateChildLogger)(t,this.context)}},E6=Object.defineProperty,My=Object.getOwnPropertySymbols,x6=Object.prototype.hasOwnProperty,I6=Object.prototype.propertyIsEnumerable,Uy=(n,e,t)=>e in n?E6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,zy=(n,e)=>{for(var t in e||(e={}))x6.call(e,t)&&Uy(n,t,e[t]);if(My)for(var t of My(e))I6.call(e,t)&&Uy(n,t,e[t]);return n},hh=class n extends ho{constructor(e){super(e),this.protocol=em,this.version=DO,this.name=lh,this.events=new Ir.EventEmitter,this.initialized=!1,this.on=(i,o)=>this.events.on(i,o),this.once=(i,o)=>this.events.once(i,o),this.off=(i,o)=>this.events.off(i,o),this.removeListener=(i,o)=>this.events.removeListener(i,o),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||tm,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";let t=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:(0,fe.pino)((0,fe.getDefaultLoggerOptions)({level:e?.logger||LO.logger}));this.logger=(0,fe.generateChildLogger)(t,this.name),this.heartbeat=new vi.HeartBeat,this.crypto=new Zu(this,this.logger,e?.keychain),this.history=new oh(this,this.logger),this.expirer=new ah(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new so(zy(zy({},FO),e?.storageOptions)),this.relayer=new sh({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new nh(this,this.logger),this.verify=new ch(this.projectId||"",this.logger),this.echoClient=new uh(this.projectId||"",this.logger)}static init(e){return m(this,null,function*(){let t=new n(e);yield t.initialize();let i=yield t.crypto.getClientId();return yield t.storage.setItem(XO,i),t})}get context(){return(0,fe.getLoggerContext)(this.logger)}start(){return m(this,null,function*(){this.initialized||(yield this.initialize())})}initialize(){return m(this,null,function*(){this.logger.trace("Initialized");try{yield this.crypto.init(),yield this.history.init(),yield this.expirer.init(),yield this.relayer.init(),yield this.heartbeat.init(),yield this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}})}},rm=hh;var Jr=Me(uo());var Xo=Me(mr()),pe=Me(Es());var om="wc",am=2,cm="client",_h=`${om}@${am}:${cm}:`,ph={name:cm,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"};var im="WALLETCONNECT_DEEPLINK_CHOICE";var S6="proposal";var wh="Proposal expired",P6="session",Jo=pe.SEVEN_DAYS,R6="engine",en={wc_sessionPropose:{req:{ttl:pe.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1104},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1106},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:pe.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:pe.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:pe.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:pe.ONE_DAY,prompt:!1,tag:1112},res:{ttl:pe.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:pe.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:pe.THIRTY_SECONDS,prompt:!1,tag:1115}}},dh={min:pe.FIVE_MINUTES,max:pe.SEVEN_DAYS},Sr={idle:"IDLE",active:"ACTIVE"},O6="request",T6=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"],A6=Object.defineProperty,C6=Object.defineProperties,N6=Object.getOwnPropertyDescriptors,sm=Object.getOwnPropertySymbols,D6=Object.prototype.hasOwnProperty,L6=Object.prototype.propertyIsEnumerable,nm=(n,e,t)=>e in n?A6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Et=(n,e)=>{for(var t in e||(e={}))D6.call(e,t)&&nm(n,t,e[t]);if(sm)for(var t of sm(e))L6.call(e,t)&&nm(n,t,e[t]);return n},tn=(n,e)=>C6(n,N6(e)),gh=class extends Eo{constructor(e){super(e),this.name=R6,this.events=new Xo.default,this.initialized=!1,this.ignoredPayloadTypes=[Yn],this.requestQueue={state:Sr.idle,queue:[]},this.sessionRequestQueue={state:Sr.idle,queue:[]},this.requestQueueDelay=pe.ONE_SECOND,this.init=()=>m(this,null,function*(){this.initialized||(yield this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(en)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,pe.toMiliseconds)(this.requestQueueDelay)))}),this.connect=t=>m(this,null,function*(){yield this.isInitialized();let i=tn(Et({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});yield this.isValidConnect(i);let{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:h,sessionProperties:f,relays:v}=i,y=o,g,w=!1;if(y&&(w=this.client.core.pairing.pairings.get(y).active),!y||!w){let{topic:H,uri:z}=yield this.client.core.pairing.create();y=H,g=z}let E=yield this.client.core.crypto.generateKeyPair(),S=Et({requiredNamespaces:c,optionalNamespaces:h,relays:v??[{protocol:fh}],proposer:{publicKey:E,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:R,resolve:j,done:q}=Mr(pe.FIVE_MINUTES,wh);if(this.events.once(Ue("session_connect"),ee=>m(this,[ee],function*({error:H,session:z}){if(H)R(H);else if(z){z.self.publicKey=E;let se=tn(Et({},z),{requiredNamespaces:z.requiredNamespaces,optionalNamespaces:z.optionalNamespaces});yield this.client.session.set(z.topic,se),yield this.setExpiry(z.topic,z.expiry),y&&(yield this.client.core.pairing.updateMetadata({topic:y,metadata:z.peer.metadata})),j(se)}})),!y){let{message:H}=k("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(H)}let V=yield this.sendRequest({topic:y,method:"wc_sessionPropose",params:S}),J=At(pe.FIVE_MINUTES);return yield this.setProposal(V,Et({id:V,expiry:J},S)),{uri:g,approval:q}}),this.pair=t=>m(this,null,function*(){return yield this.isInitialized(),yield this.client.core.pairing.pair(t)}),this.approve=t=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidApprove(t);let{id:i,relayProtocol:o,namespaces:c,sessionProperties:h}=t,f=this.client.proposal.get(i),{pairingTopic:v,proposer:y,requiredNamespaces:g,optionalNamespaces:w}=f;v=v||"",zi(g)||(g=zp(c,"approve()"));let E=yield this.client.core.crypto.generateKeyPair(),S=y.publicKey,R=yield this.client.core.crypto.generateSharedKey(E,S);v&&i&&(yield this.client.core.pairing.updateMetadata({topic:v,metadata:y.metadata}),yield this.sendResult({id:i,topic:v,result:{relay:{protocol:o??"irn"},responderPublicKey:E}}),yield this.client.proposal.delete(i,Ye("USER_DISCONNECTED")),yield this.client.core.pairing.activate({topic:v}));let j=Et({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:g,optionalNamespaces:w,pairingTopic:v,controller:{publicKey:E,metadata:this.client.metadata},expiry:At(Jo)},h&&{sessionProperties:h});yield this.client.core.relayer.subscribe(R),yield this.sendRequest({topic:R,method:"wc_sessionSettle",params:j,throwOnFailedPublish:!0});let q=tn(Et({},j),{topic:R,pairingTopic:v,acknowledged:!1,self:j.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:E});return yield this.client.session.set(R,q),yield this.setExpiry(R,At(Jo)),{topic:R,acknowledged:()=>new Promise(V=>setTimeout(()=>V(this.client.session.get(R)),500))}}),this.reject=t=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidReject(t);let{id:i,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(i);c&&(yield this.sendError(i,c,o),yield this.client.proposal.delete(i,Ye("USER_DISCONNECTED")))}),this.update=t=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidUpdate(t);let{topic:i,namespaces:o}=t,c=yield this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:h,resolve:f,reject:v}=Mr();return this.events.once(Ue("session_update",c),({error:y})=>{y?v(y):f()}),yield this.client.session.update(i,{namespaces:o}),{acknowledged:h}}),this.extend=t=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidExtend(t);let{topic:i}=t,o=yield this.sendRequest({topic:i,method:"wc_sessionExtend",params:{}}),{done:c,resolve:h,reject:f}=Mr();return this.events.once(Ue("session_extend",o),({error:v})=>{v?f(v):h()}),yield this.setExpiry(i,At(Jo)),{acknowledged:c}}),this.request=t=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidRequest(t);let{chainId:i,request:o,topic:c,expiry:h}=t,f=Bs(),{done:v,resolve:y,reject:g}=Mr(h,"Request expired. Please try again.");return this.events.once(Ue("session_request",f),({error:w,result:E})=>{w?g(w):y(E)}),yield Promise.all([new Promise(w=>m(this,null,function*(){yield this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:o,chainId:i},expiry:h,throwOnFailedPublish:!0}).catch(E=>g(E)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:i,id:f}),w()})),new Promise(w=>m(this,null,function*(){let E=yield Mp(this.client.core.storage,im);qp({id:f,topic:c,wcDeepLink:E}),w()})),v()]).then(w=>w[2])}),this.respond=t=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidRespond(t);let{topic:i,response:o}=t,{id:c}=o;Ht(o)?yield this.sendResult({id:c,topic:i,result:o.result,throwOnFailedPublish:!0}):yt(o)&&(yield this.sendError(c,i,o.error)),this.cleanupAfterResponse(t)}),this.ping=t=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidPing(t);let{topic:i}=t;if(this.client.session.keys.includes(i)){let o=yield this.sendRequest({topic:i,method:"wc_sessionPing",params:{}}),{done:c,resolve:h,reject:f}=Mr();this.events.once(Ue("session_ping",o),({error:v})=>{v?f(v):h()}),yield c()}else this.client.core.pairing.pairings.keys.includes(i)&&(yield this.client.core.pairing.ping({topic:i}))}),this.emit=t=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidEmit(t);let{topic:i,event:o,chainId:c}=t;yield this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:o,chainId:c}})}),this.disconnect=t=>m(this,null,function*(){yield this.isInitialized(),yield this.isValidDisconnect(t);let{topic:i}=t;this.client.session.keys.includes(i)?(yield this.sendRequest({topic:i,method:"wc_sessionDelete",params:Ye("USER_DISCONNECTED"),throwOnFailedPublish:!0}),yield this.deleteSession(i)):yield this.client.core.pairing.disconnect({topic:i})}),this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(i=>$p(i,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=t=>m(this,null,function*(){if(t.pairingTopic)try{let i=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var h,f;return((h=c.peerMetadata)==null?void 0:h.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==i.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),yield Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}}),this.deleteSession=(t,i)=>m(this,null,function*(){let{self:o}=this.client.session.get(t);yield this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,Ye("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&(yield this.client.core.crypto.deleteKeyPair(o.publicKey)),this.client.core.crypto.keychain.has(t)&&(yield this.client.core.crypto.deleteSymKey(t)),i||this.client.core.expirer.del(t),this.client.core.storage.removeItem(im).catch(c=>this.client.logger.warn(c)),this.getPendingSessionRequests().forEach(c=>{c.topic===t&&this.deletePendingSessionRequest(c.id,Ye("USER_DISCONNECTED"))})}),this.deleteProposal=(t,i)=>m(this,null,function*(){yield Promise.all([this.client.proposal.delete(t,Ye("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(t)])}),this.deletePendingSessionRequest=(t,i,o=!1)=>m(this,null,function*(){yield Promise.all([this.client.pendingRequest.delete(t,i),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=Sr.idle)}),this.setExpiry=(t,i)=>m(this,null,function*(){this.client.session.keys.includes(t)&&(yield this.client.session.update(t,{expiry:i})),this.client.core.expirer.set(t,i)}),this.setProposal=(t,i)=>m(this,null,function*(){yield this.client.proposal.set(t,i),this.client.core.expirer.set(t,i.expiry)}),this.setPendingSessionRequest=t=>m(this,null,function*(){let i=en.wc_sessionRequest.req.ttl,{id:o,topic:c,params:h,verifyContext:f}=t;yield this.client.pendingRequest.set(o,{id:o,topic:c,params:h,verifyContext:f}),i&&this.client.core.expirer.set(o,At(i))}),this.sendRequest=t=>m(this,null,function*(){let{topic:i,method:o,params:c,expiry:h,relayRpcId:f,clientRpcId:v,throwOnFailedPublish:y}=t,g=ir(o,c,v);if(Qn()&&T6.includes(o)){let S=qr(JSON.stringify(g));this.client.core.verify.register({attestationId:S})}let w=yield this.client.core.crypto.encode(i,g),E=en[o].req;return h&&(E.ttl=h),f&&(E.id=f),this.client.core.history.set(i,g),y?(E.internal=tn(Et({},E.internal),{throwOnFailedPublish:!0}),yield this.client.core.relayer.publish(i,w,E)):this.client.core.relayer.publish(i,w,E).catch(S=>this.client.logger.error(S)),g.id}),this.sendResult=t=>m(this,null,function*(){let{id:i,topic:o,result:c,throwOnFailedPublish:h}=t,f=Vr(i,c),v=yield this.client.core.crypto.encode(o,f),y=yield this.client.core.history.get(o,i),g=en[y.request.method].res;h?(g.internal=tn(Et({},g.internal),{throwOnFailedPublish:!0}),yield this.client.core.relayer.publish(o,v,g)):this.client.core.relayer.publish(o,v,g).catch(w=>this.client.logger.error(w)),yield this.client.core.history.resolve(f)}),this.sendError=(t,i,o)=>m(this,null,function*(){let c=wr(t,o),h=yield this.client.core.crypto.encode(i,c),f=yield this.client.core.history.get(i,t),v=en[f.request.method].res;this.client.core.relayer.publish(i,h,v),yield this.client.core.history.resolve(c)}),this.cleanup=()=>m(this,null,function*(){let t=[],i=[];this.client.session.getAll().forEach(o=>{Qt(o.expiry)&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Qt(o.expiry)&&i.push(o.id)}),yield Promise.all([...t.map(o=>this.deleteSession(o)),...i.map(o=>this.deleteProposal(o))])}),this.onRelayEventRequest=t=>m(this,null,function*(){this.requestQueue.queue.push(t),yield this.processRequestsQueue()}),this.processRequestsQueue=()=>m(this,null,function*(){if(this.requestQueue.state===Sr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Sr.active;let t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),yield new Promise(i=>setTimeout(i,300))}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=Sr.idle}),this.processRequest=t=>{let{topic:i,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(i,o);case"wc_sessionSettle":return this.onSessionSettleRequest(i,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,o);case"wc_sessionExtend":return this.onSessionExtendRequest(i,o);case"wc_sessionPing":return this.onSessionPingRequest(i,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,o);case"wc_sessionRequest":return this.onSessionRequest(i,o);case"wc_sessionEvent":return this.onSessionEventRequest(i,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=t=>m(this,null,function*(){let{topic:i,payload:o}=t,c=(yield this.client.core.history.get(i,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(i,o);case"wc_sessionSettle":return this.onSessionSettleResponse(i,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,o);case"wc_sessionExtend":return this.onSessionExtendResponse(i,o);case"wc_sessionPing":return this.onSessionPingResponse(i,o);case"wc_sessionRequest":return this.onSessionRequestResponse(i,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}}),this.onRelayEventUnknownPayload=t=>{let{topic:i}=t,{message:o}=k("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=(t,i)=>m(this,null,function*(){let{params:o,id:c}=i;try{this.isValidConnect(Et({},i.params));let h=At(pe.FIVE_MINUTES),f=Et({id:c,pairingTopic:t,expiry:h},o);yield this.setProposal(c,f);let v=qr(JSON.stringify(i)),y=yield this.getVerifyContext(v,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:y})}catch(h){yield this.sendError(c,t,h),this.client.logger.error(h)}}),this.onSessionProposeResponse=(t,i)=>m(this,null,function*(){let{id:o}=i;if(Ht(i)){let{result:c}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});let h=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:h});let f=h.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});let v=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:v});let y=yield this.client.core.crypto.generateSharedKey(f,v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});let g=yield this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:g}),yield this.client.core.pairing.activate({topic:t})}else yt(i)&&(yield this.client.proposal.delete(o,Ye("USER_DISCONNECTED")),this.events.emit(Ue("session_connect"),{error:i.error}))}),this.onSessionSettleRequest=(t,i)=>m(this,null,function*(){let{id:o,params:c}=i;try{this.isValidSessionSettleRequest(c);let{relay:h,controller:f,expiry:v,namespaces:y,requiredNamespaces:g,optionalNamespaces:w,sessionProperties:E,pairingTopic:S}=i.params,R=Et({topic:t,relay:h,expiry:v,namespaces:y,acknowledged:!0,pairingTopic:S,requiredNamespaces:g,optionalNamespaces:w,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},E&&{sessionProperties:E});yield this.sendResult({id:i.id,topic:t,result:!0}),this.events.emit(Ue("session_connect"),{session:R}),this.cleanupDuplicatePairings(R)}catch(h){yield this.sendError(o,t,h),this.client.logger.error(h)}}),this.onSessionSettleResponse=(t,i)=>m(this,null,function*(){let{id:o}=i;Ht(i)?(yield this.client.session.update(t,{acknowledged:!0}),this.events.emit(Ue("session_approve",o),{})):yt(i)&&(yield this.client.session.delete(t,Ye("USER_DISCONNECTED")),this.events.emit(Ue("session_approve",o),{error:i.error}))}),this.onSessionUpdateRequest=(t,i)=>m(this,null,function*(){let{params:o,id:c}=i;try{let h=`${t}_session_update`,f=Is.get(h);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(Et({topic:t},o)),yield this.client.session.update(t,{namespaces:o.namespaces}),yield this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),Is.set(h,c)}catch(h){yield this.sendError(c,t,h),this.client.logger.error(h)}}),this.isRequestOutOfSync=(t,i)=>parseInt(i.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,i)=>{let{id:o}=i;Ht(i)?this.events.emit(Ue("session_update",o),{}):yt(i)&&this.events.emit(Ue("session_update",o),{error:i.error})},this.onSessionExtendRequest=(t,i)=>m(this,null,function*(){let{id:o}=i;try{this.isValidExtend({topic:t}),yield this.setExpiry(t,At(Jo)),yield this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){yield this.sendError(o,t,c),this.client.logger.error(c)}}),this.onSessionExtendResponse=(t,i)=>{let{id:o}=i;Ht(i)?this.events.emit(Ue("session_extend",o),{}):yt(i)&&this.events.emit(Ue("session_extend",o),{error:i.error})},this.onSessionPingRequest=(t,i)=>m(this,null,function*(){let{id:o}=i;try{this.isValidPing({topic:t}),yield this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){yield this.sendError(o,t,c),this.client.logger.error(c)}}),this.onSessionPingResponse=(t,i)=>{let{id:o}=i;setTimeout(()=>{Ht(i)?this.events.emit(Ue("session_ping",o),{}):yt(i)&&this.events.emit(Ue("session_ping",o),{error:i.error})},500)},this.onSessionDeleteRequest=(t,i)=>m(this,null,function*(){let{id:o}=i;try{this.isValidDisconnect({topic:t,reason:i.params}),yield Promise.all([new Promise(c=>{this.client.core.relayer.once(ot.publish,()=>m(this,null,function*(){c(yield this.deleteSession(t))}))}),this.sendResult({id:o,topic:t,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:t})}catch(c){this.client.logger.error(c)}}),this.onSessionRequest=(t,i)=>m(this,null,function*(){let{id:o,params:c}=i;try{this.isValidRequest(Et({topic:t},c));let h=qr(JSON.stringify(ir("wc_sessionRequest",c,o))),f=this.client.session.get(t),v=yield this.getVerifyContext(h,f.peer.metadata),y={id:o,topic:t,params:c,verifyContext:v};yield this.setPendingSessionRequest(y),this.addSessionRequestToSessionRequestQueue(y),this.processSessionRequestQueue()}catch(h){yield this.sendError(o,t,h),this.client.logger.error(h)}}),this.onSessionRequestResponse=(t,i)=>{let{id:o}=i;Ht(i)?this.events.emit(Ue("session_request",o),{result:i.result}):yt(i)&&this.events.emit(Ue("session_request",o),{error:i.error})},this.onSessionEventRequest=(t,i)=>m(this,null,function*(){let{id:o,params:c}=i;try{let h=`${t}_session_event_${c.event.name}`,f=Is.get(h);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(Et({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),Is.set(h,o)}catch(h){yield this.sendError(o,t,h),this.client.logger.error(h)}}),this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Sr.idle,this.processSessionRequestQueue()},(0,pe.toMiliseconds)(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Sr.active){this.client.logger.info("session request queue is already active.");return}let t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Sr.active,this.client.events.emit("session_request",t)}catch(i){this.client.logger.error(i)}},this.onPairingCreated=t=>{if(t.active)return;let i=this.client.proposal.getAll().find(o=>o.pairingTopic===t.topic);i&&this.onSessionProposeRequest(t.topic,ir("wc_sessionPropose",{requiredNamespaces:i.requiredNamespaces,optionalNamespaces:i.optionalNamespaces,relays:i.relays,proposer:i.proposer,sessionProperties:i.sessionProperties},i.id))},this.isValidConnect=t=>m(this,null,function*(){if(!ht(t)){let{message:v}=k("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(v)}let{pairingTopic:i,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:h,relays:f}=t;if(Zt(i)||(yield this.isValidPairingTopic(i)),!Wp(f,!0)){let{message:v}=k("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(v)}!Zt(o)&&zi(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!Zt(c)&&zi(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),Zt(h)||this.validateSessionProps(h,"sessionProperties")}),this.validateNamespaces=(t,i)=>{let o=Kp(t,"connect()",i);if(o)throw new Error(o.message)},this.isValidApprove=t=>m(this,null,function*(){if(!ht(t))throw new Error(k("MISSING_OR_INVALID",`approve() params: ${t}`).message);let{id:i,namespaces:o,relayProtocol:c,sessionProperties:h}=t;yield this.isValidProposalId(i);let f=this.client.proposal.get(i),v=ro(o,"approve()");if(v)throw new Error(v.message);let y=Cc(f.requiredNamespaces,o,"approve()");if(y)throw new Error(y.message);if(!Ur(c,!0)){let{message:g}=k("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(g)}Zt(h)||this.validateSessionProps(h,"sessionProperties")}),this.isValidReject=t=>m(this,null,function*(){if(!ht(t)){let{message:c}=k("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}let{id:i,reason:o}=t;if(yield this.isValidProposalId(i),!Yp(o)){let{message:c}=k("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}}),this.isValidSessionSettleRequest=t=>{if(!ht(t)){let{message:y}=k("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(y)}let{relay:i,controller:o,namespaces:c,expiry:h}=t;if(!Gp(i)){let{message:y}=k("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}let f=kp(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);let v=ro(c,"onSessionSettleRequest()");if(v)throw new Error(v.message);if(Qt(h)){let{message:y}=k("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=t=>m(this,null,function*(){if(!ht(t)){let{message:v}=k("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(v)}let{topic:i,namespaces:o}=t;yield this.isValidSessionTopic(i);let c=this.client.session.get(i),h=ro(o,"update()");if(h)throw new Error(h.message);let f=Cc(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)}),this.isValidExtend=t=>m(this,null,function*(){if(!ht(t)){let{message:o}=k("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}let{topic:i}=t;yield this.isValidSessionTopic(i)}),this.isValidRequest=t=>m(this,null,function*(){if(!ht(t)){let{message:v}=k("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(v)}let{topic:i,request:o,chainId:c,expiry:h}=t;yield this.isValidSessionTopic(i);let{namespaces:f}=this.client.session.get(i);if(!Ac(f,c)){let{message:v}=k("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(v)}if(!Xp(o)){let{message:v}=k("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(v)}if(!ed(f,c,o.method)){let{message:v}=k("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(v)}if(h&&!rd(h,dh)){let{message:v}=k("MISSING_OR_INVALID",`request() expiry: ${h}. Expiry must be a number (in seconds) between ${dh.min} and ${dh.max}`);throw new Error(v)}}),this.isValidRespond=t=>m(this,null,function*(){var i;if(!ht(t)){let{message:h}=k("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(h)}let{topic:o,response:c}=t;try{yield this.isValidSessionTopic(o)}catch(h){throw(i=t?.response)!=null&&i.id&&this.cleanupAfterResponse(t),h}if(!Qp(c)){let{message:h}=k("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(h)}}),this.isValidPing=t=>m(this,null,function*(){if(!ht(t)){let{message:o}=k("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}let{topic:i}=t;yield this.isValidSessionOrPairingTopic(i)}),this.isValidEmit=t=>m(this,null,function*(){if(!ht(t)){let{message:f}=k("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}let{topic:i,event:o,chainId:c}=t;yield this.isValidSessionTopic(i);let{namespaces:h}=this.client.session.get(i);if(!Ac(h,c)){let{message:f}=k("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!Zp(o)){let{message:f}=k("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!td(h,c,o.name)){let{message:f}=k("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}}),this.isValidDisconnect=t=>m(this,null,function*(){if(!ht(t)){let{message:o}=k("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}let{topic:i}=t;yield this.isValidSessionOrPairingTopic(i)}),this.getVerifyContext=(t,i)=>m(this,null,function*(){let o={verified:{verifyUrl:i.verifyUrl||yi,validation:"UNKNOWN",origin:i.url||""}};try{let c=yield this.client.core.verify.resolve({attestationId:t,verifyUrl:i.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(i.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o}),this.validateSessionProps=(t,i)=>{Object.values(t).forEach(o=>{if(!Ur(o,!1)){let{message:c}=k("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}isInitialized(){return m(this,null,function*(){if(!this.initialized){let{message:e}=k("NOT_INITIALIZED",this.name);throw new Error(e)}yield this.client.core.relayer.confirmOnlineStateOrThrow()})}registerRelayerEvents(){this.client.core.relayer.on(ot.message,e=>m(this,null,function*(){let{topic:t,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;let o=yield this.client.core.crypto.decode(t,i);try{Xi(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):kr(o)?(yield this.client.core.history.resolve(o),yield this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}}))}registerExpirerEvents(){this.client.core.expirer.on(Nt.expired,e=>m(this,null,function*(){let{topic:t,id:i}=Zn(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return yield this.deletePendingSessionRequest(i,k("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(yield this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):i&&(yield this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))}))}registerPairingEvents(){this.client.core.pairing.events.on(ts.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!Ur(e,!1)){let{message:t}=k("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){let{message:t}=k("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Qt(this.client.core.pairing.pairings.get(e).expiry)){let{message:t}=k("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}isValidSessionTopic(e){return m(this,null,function*(){if(!Ur(e,!1)){let{message:t}=k("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){let{message:t}=k("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Qt(this.client.session.get(e).expiry)){yield this.deleteSession(e);let{message:t}=k("EXPIRED",`session topic: ${e}`);throw new Error(t)}})}isValidSessionOrPairingTopic(e){return m(this,null,function*(){if(this.client.session.keys.includes(e))yield this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Ur(e,!1)){let{message:t}=k("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{let{message:t}=k("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}})}isValidProposalId(e){return m(this,null,function*(){if(!Jp(e)){let{message:t}=k("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){let{message:t}=k("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Qt(this.client.proposal.get(e).expiry)){yield this.deleteProposal(e);let{message:t}=k("EXPIRED",`proposal id: ${e}`);throw new Error(t)}})}},yh=class extends mi{constructor(e,t){super(e,t,S6,_h),this.core=e,this.logger=t}},mh=class extends mi{constructor(e,t){super(e,t,P6,_h),this.core=e,this.logger=t}},vh=class extends mi{constructor(e,t){super(e,t,O6,_h,i=>i.id),this.core=e,this.logger=t}},Yo=class n extends bo{constructor(e){super(e),this.protocol=om,this.version=am,this.name=ph.name,this.events=new Xo.EventEmitter,this.on=(i,o)=>this.events.on(i,o),this.once=(i,o)=>this.events.once(i,o),this.off=(i,o)=>this.events.off(i,o),this.removeListener=(i,o)=>this.events.removeListener(i,o),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=i=>m(this,null,function*(){try{return yield this.engine.connect(i)}catch(o){throw this.logger.error(o.message),o}}),this.pair=i=>m(this,null,function*(){try{return yield this.engine.pair(i)}catch(o){throw this.logger.error(o.message),o}}),this.approve=i=>m(this,null,function*(){try{return yield this.engine.approve(i)}catch(o){throw this.logger.error(o.message),o}}),this.reject=i=>m(this,null,function*(){try{return yield this.engine.reject(i)}catch(o){throw this.logger.error(o.message),o}}),this.update=i=>m(this,null,function*(){try{return yield this.engine.update(i)}catch(o){throw this.logger.error(o.message),o}}),this.extend=i=>m(this,null,function*(){try{return yield this.engine.extend(i)}catch(o){throw this.logger.error(o.message),o}}),this.request=i=>m(this,null,function*(){try{return yield this.engine.request(i)}catch(o){throw this.logger.error(o.message),o}}),this.respond=i=>m(this,null,function*(){try{return yield this.engine.respond(i)}catch(o){throw this.logger.error(o.message),o}}),this.ping=i=>m(this,null,function*(){try{return yield this.engine.ping(i)}catch(o){throw this.logger.error(o.message),o}}),this.emit=i=>m(this,null,function*(){try{return yield this.engine.emit(i)}catch(o){throw this.logger.error(o.message),o}}),this.disconnect=i=>m(this,null,function*(){try{return yield this.engine.disconnect(i)}catch(o){throw this.logger.error(o.message),o}}),this.find=i=>{try{return this.engine.find(i)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||ph.name,this.metadata=e?.metadata||Dp();let t=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:(0,Jr.pino)((0,Jr.getDefaultLoggerOptions)({level:e?.logger||ph.logger}));this.core=e?.core||new rm(e),this.logger=(0,Jr.generateChildLogger)(t,this.name),this.session=new mh(this.core,this.logger),this.proposal=new yh(this.core,this.logger),this.pendingRequest=new vh(this.core,this.logger),this.engine=new gh(this)}static init(e){return m(this,null,function*(){let t=new n(e);return yield t.initialize(),t})}get context(){return(0,Jr.getLoggerContext)(this.logger)}get pairing(){return this.core.pairing.pairings}initialize(){return m(this,null,function*(){this.logger.trace("Initialized");try{yield this.core.start(),yield this.session.init(),yield this.proposal.init(),yield this.pendingRequest.init(),yield this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}})}};var ta=Me(uo());var dm=Me(mr()),bh=Me(lm());var F6={Accept:"application/json","Content-Type":"application/json"},j6="POST",fm={headers:F6,method:j6},pm=10,rn=class{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new dm.EventEmitter,this.isAvailable=!1,this.registering=!1,!Lo(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}open(){return m(this,arguments,function*(e=this.url){yield this.register(e)})}close(){return m(this,null,function*(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()})}send(e,t){return m(this,null,function*(){this.isAvailable||(yield this.register());try{let i=$t(e),c=yield(yield(0,bh.default)(this.url,Object.assign(Object.assign({},fm),{body:i}))).json();this.onPayload({data:c})}catch(i){this.onError(e.id,i)}})}register(){return m(this,arguments,function*(e=this.url){if(!Lo(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){let t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){let t=$t({id:1,jsonrpc:"2.0",method:"test",params:[]});yield(0,bh.default)(e,Object.assign(Object.assign({},fm),{body:t}))}this.onOpen()}catch(t){let i=this.parseError(t);throw this.events.emit("register_error",i),this.onClose(),i}})}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;let t=typeof e.data=="string"?er(e.data):e.data;this.events.emit("payload",t)}onError(e,t){let i=this.parseError(t),o=i.message||i.toString(),c=wr(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return $s(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>pm&&this.events.setMaxListeners(pm)}},gm=rn;var Yr=gm;var xm=Me(mr());var ym="error",q6="wss://relay.walletconnect.com",M6="wc",U6="universal_provider",mm=`${M6}@2:${U6}:`,z6="https://rpc.walletconnect.com/v1/",Rr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"},sn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Sh={exports:{}};(function(n,e){(function(){var t,i="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",f="Invalid `variable` option passed into `_.template`",v="__lodash_hash_undefined__",y=500,g="__lodash_placeholder__",w=1,E=2,S=4,R=1,j=2,q=1,V=2,J=4,H=8,z=16,ee=32,se=64,A=128,N=256,re=512,P=30,O="...",D=800,U=16,$=1,X=2,_e=3,Ve=1/0,tt=9007199254740991,wi=17976931348623157e292,Se=0/0,me=4294967295,ke=me-1,Ke=me>>>1,ze=[["ary",A],["bind",q],["bindKey",V],["curry",H],["curryRight",z],["flip",re],["partial",ee],["partialRight",se],["rearg",N]],Pe="[object Arguments]",De="[object Array]",Ge="[object AsyncFunction]",xe="[object Boolean]",Te="[object Date]",We="[object DOMException]",Le="[object Error]",Ae="[object Function]",Xe="[object GeneratorFunction]",we="[object Map]",je="[object Number]",Cm="[object Null]",or="[object Object]",Uh="[object Promise]",Nm="[object Proxy]",is="[object RegExp]",Bt="[object Set]",ss="[object String]",on="[object Symbol]",Dm="[object Undefined]",ns="[object WeakMap]",Lm="[object WeakSet]",os="[object ArrayBuffer]",bi="[object DataView]",ia="[object Float32Array]",sa="[object Float64Array]",na="[object Int8Array]",oa="[object Int16Array]",aa="[object Int32Array]",ca="[object Uint8Array]",ua="[object Uint8ClampedArray]",ha="[object Uint16Array]",la="[object Uint32Array]",Fm=/\b__p \+= '';/g,jm=/\b(__p \+=) '' \+/g,qm=/(__e\(.*?\)|\b__t\)) \+\n'';/g,zh=/&(?:amp|lt|gt|quot|#39);/g,$h=/[&<>"']/g,Mm=RegExp(zh.source),Um=RegExp($h.source),zm=/<%-([\s\S]+?)%>/g,$m=/<%([\s\S]+?)%>/g,Hh=/<%=([\s\S]+?)%>/g,Hm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Bm=/^\w*$/,Vm=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,fa=/[\\^$.*+?()[\]{}|]/g,km=RegExp(fa.source),pa=/^\s+/,Km=/\s/,Gm=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Wm=/\{\n\/\* \[wrapped with (.+)\] \*/,Jm=/,? & /,Ym=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Xm=/[()=,{}\[\]\/\s]/,Qm=/\\(\\)?/g,Zm=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Bh=/\w*$/,ev=/^[-+]0x[0-9a-f]+$/i,tv=/^0b[01]+$/i,rv=/^\[object .+?Constructor\]$/,iv=/^0o[0-7]+$/i,sv=/^(?:0|[1-9]\d*)$/,nv=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,an=/($^)/,ov=/['\n\r\u2028\u2029\\]/g,cn="\\ud800-\\udfff",av="\\u0300-\\u036f",cv="\\ufe20-\\ufe2f",uv="\\u20d0-\\u20ff",Vh=av+cv+uv,kh="\\u2700-\\u27bf",Kh="a-z\\xdf-\\xf6\\xf8-\\xff",hv="\\xac\\xb1\\xd7\\xf7",lv="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",fv="\\u2000-\\u206f",pv=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Gh="A-Z\\xc0-\\xd6\\xd8-\\xde",Wh="\\ufe0e\\ufe0f",Jh=hv+lv+fv+pv,da="['\u2019]",dv="["+cn+"]",Yh="["+Jh+"]",un="["+Vh+"]",Xh="\\d+",gv="["+kh+"]",Qh="["+Kh+"]",Zh="[^"+cn+Jh+Xh+kh+Kh+Gh+"]",ga="\\ud83c[\\udffb-\\udfff]",yv="(?:"+un+"|"+ga+")",el="[^"+cn+"]",ya="(?:\\ud83c[\\udde6-\\uddff]){2}",ma="[\\ud800-\\udbff][\\udc00-\\udfff]",Ei="["+Gh+"]",tl="\\u200d",rl="(?:"+Qh+"|"+Zh+")",mv="(?:"+Ei+"|"+Zh+")",il="(?:"+da+"(?:d|ll|m|re|s|t|ve))?",sl="(?:"+da+"(?:D|LL|M|RE|S|T|VE))?",nl=yv+"?",ol="["+Wh+"]?",vv="(?:"+tl+"(?:"+[el,ya,ma].join("|")+")"+ol+nl+")*",_v="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",wv="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",al=ol+nl+vv,bv="(?:"+[gv,ya,ma].join("|")+")"+al,Ev="(?:"+[el+un+"?",un,ya,ma,dv].join("|")+")",xv=RegExp(da,"g"),Iv=RegExp(un,"g"),va=RegExp(ga+"(?="+ga+")|"+Ev+al,"g"),Sv=RegExp([Ei+"?"+Qh+"+"+il+"(?="+[Yh,Ei,"$"].join("|")+")",mv+"+"+sl+"(?="+[Yh,Ei+rl,"$"].join("|")+")",Ei+"?"+rl+"+"+il,Ei+"+"+sl,wv,_v,Xh,bv].join("|"),"g"),Pv=RegExp("["+tl+cn+Vh+Wh+"]"),Rv=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ov=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Tv=-1,Re={};Re[ia]=Re[sa]=Re[na]=Re[oa]=Re[aa]=Re[ca]=Re[ua]=Re[ha]=Re[la]=!0,Re[Pe]=Re[De]=Re[os]=Re[xe]=Re[bi]=Re[Te]=Re[Le]=Re[Ae]=Re[we]=Re[je]=Re[or]=Re[is]=Re[Bt]=Re[ss]=Re[ns]=!1;var Ie={};Ie[Pe]=Ie[De]=Ie[os]=Ie[bi]=Ie[xe]=Ie[Te]=Ie[ia]=Ie[sa]=Ie[na]=Ie[oa]=Ie[aa]=Ie[we]=Ie[je]=Ie[or]=Ie[is]=Ie[Bt]=Ie[ss]=Ie[on]=Ie[ca]=Ie[ua]=Ie[ha]=Ie[la]=!0,Ie[Le]=Ie[Ae]=Ie[ns]=!1;var Av={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Cv={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Nv={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Dv={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Lv=parseFloat,Fv=parseInt,cl=typeof sn=="object"&&sn&&sn.Object===Object&&sn,jv=typeof self=="object"&&self&&self.Object===Object&&self,st=cl||jv||Function("return this")(),_a=e&&!e.nodeType&&e,Qr=_a&&!0&&n&&!n.nodeType&&n,ul=Qr&&Qr.exports===_a,wa=ul&&cl.process,Dt=function(){try{var x=Qr&&Qr.require&&Qr.require("util").types;return x||wa&&wa.binding&&wa.binding("util")}catch{}}(),hl=Dt&&Dt.isArrayBuffer,ll=Dt&&Dt.isDate,fl=Dt&&Dt.isMap,pl=Dt&&Dt.isRegExp,dl=Dt&&Dt.isSet,gl=Dt&&Dt.isTypedArray;function xt(x,C,T){switch(T.length){case 0:return x.call(C);case 1:return x.call(C,T[0]);case 2:return x.call(C,T[0],T[1]);case 3:return x.call(C,T[0],T[1],T[2])}return x.apply(C,T)}function qv(x,C,T,K){for(var te=-1,de=x==null?0:x.length;++te<de;){var Qe=x[te];C(K,Qe,T(Qe),x)}return K}function Lt(x,C){for(var T=-1,K=x==null?0:x.length;++T<K&&C(x[T],T,x)!==!1;);return x}function Mv(x,C){for(var T=x==null?0:x.length;T--&&C(x[T],T,x)!==!1;);return x}function yl(x,C){for(var T=-1,K=x==null?0:x.length;++T<K;)if(!C(x[T],T,x))return!1;return!0}function Or(x,C){for(var T=-1,K=x==null?0:x.length,te=0,de=[];++T<K;){var Qe=x[T];C(Qe,T,x)&&(de[te++]=Qe)}return de}function hn(x,C){var T=x==null?0:x.length;return!!T&&xi(x,C,0)>-1}function ba(x,C,T){for(var K=-1,te=x==null?0:x.length;++K<te;)if(T(C,x[K]))return!0;return!1}function Ce(x,C){for(var T=-1,K=x==null?0:x.length,te=Array(K);++T<K;)te[T]=C(x[T],T,x);return te}function Tr(x,C){for(var T=-1,K=C.length,te=x.length;++T<K;)x[te+T]=C[T];return x}function Ea(x,C,T,K){var te=-1,de=x==null?0:x.length;for(K&&de&&(T=x[++te]);++te<de;)T=C(T,x[te],te,x);return T}function Uv(x,C,T,K){var te=x==null?0:x.length;for(K&&te&&(T=x[--te]);te--;)T=C(T,x[te],te,x);return T}function xa(x,C){for(var T=-1,K=x==null?0:x.length;++T<K;)if(C(x[T],T,x))return!0;return!1}var zv=Ia("length");function $v(x){return x.split("")}function Hv(x){return x.match(Ym)||[]}function ml(x,C,T){var K;return T(x,function(te,de,Qe){if(C(te,de,Qe))return K=de,!1}),K}function ln(x,C,T,K){for(var te=x.length,de=T+(K?1:-1);K?de--:++de<te;)if(C(x[de],de,x))return de;return-1}function xi(x,C,T){return C===C?e_(x,C,T):ln(x,vl,T)}function Bv(x,C,T,K){for(var te=T-1,de=x.length;++te<de;)if(K(x[te],C))return te;return-1}function vl(x){return x!==x}function _l(x,C){var T=x==null?0:x.length;return T?Pa(x,C)/T:Se}function Ia(x){return function(C){return C==null?t:C[x]}}function Sa(x){return function(C){return x==null?t:x[C]}}function wl(x,C,T,K,te){return te(x,function(de,Qe,Ee){T=K?(K=!1,de):C(T,de,Qe,Ee)}),T}function Vv(x,C){var T=x.length;for(x.sort(C);T--;)x[T]=x[T].value;return x}function Pa(x,C){for(var T,K=-1,te=x.length;++K<te;){var de=C(x[K]);de!==t&&(T=T===t?de:T+de)}return T}function Ra(x,C){for(var T=-1,K=Array(x);++T<x;)K[T]=C(T);return K}function kv(x,C){return Ce(C,function(T){return[T,x[T]]})}function bl(x){return x&&x.slice(0,Sl(x)+1).replace(pa,"")}function It(x){return function(C){return x(C)}}function Oa(x,C){return Ce(C,function(T){return x[T]})}function as(x,C){return x.has(C)}function El(x,C){for(var T=-1,K=x.length;++T<K&&xi(C,x[T],0)>-1;);return T}function xl(x,C){for(var T=x.length;T--&&xi(C,x[T],0)>-1;);return T}function Kv(x,C){for(var T=x.length,K=0;T--;)x[T]===C&&++K;return K}var Gv=Sa(Av),Wv=Sa(Cv);function Jv(x){return"\\"+Dv[x]}function Yv(x,C){return x==null?t:x[C]}function Ii(x){return Pv.test(x)}function Xv(x){return Rv.test(x)}function Qv(x){for(var C,T=[];!(C=x.next()).done;)T.push(C.value);return T}function Ta(x){var C=-1,T=Array(x.size);return x.forEach(function(K,te){T[++C]=[te,K]}),T}function Il(x,C){return function(T){return x(C(T))}}function Ar(x,C){for(var T=-1,K=x.length,te=0,de=[];++T<K;){var Qe=x[T];(Qe===C||Qe===g)&&(x[T]=g,de[te++]=T)}return de}function fn(x){var C=-1,T=Array(x.size);return x.forEach(function(K){T[++C]=K}),T}function Zv(x){var C=-1,T=Array(x.size);return x.forEach(function(K){T[++C]=[K,K]}),T}function e_(x,C,T){for(var K=T-1,te=x.length;++K<te;)if(x[K]===C)return K;return-1}function t_(x,C,T){for(var K=T+1;K--;)if(x[K]===C)return K;return K}function Si(x){return Ii(x)?i_(x):zv(x)}function Vt(x){return Ii(x)?s_(x):$v(x)}function Sl(x){for(var C=x.length;C--&&Km.test(x.charAt(C)););return C}var r_=Sa(Nv);function i_(x){for(var C=va.lastIndex=0;va.test(x);)++C;return C}function s_(x){return x.match(va)||[]}function n_(x){return x.match(Sv)||[]}var o_=function x(C){C=C==null?st:Pi.defaults(st.Object(),C,Pi.pick(st,Ov));var T=C.Array,K=C.Date,te=C.Error,de=C.Function,Qe=C.Math,Ee=C.Object,Aa=C.RegExp,a_=C.String,Ft=C.TypeError,pn=T.prototype,c_=de.prototype,Ri=Ee.prototype,dn=C["__core-js_shared__"],gn=c_.toString,ve=Ri.hasOwnProperty,u_=0,Pl=function(){var r=/[^.]+$/.exec(dn&&dn.keys&&dn.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),yn=Ri.toString,h_=gn.call(Ee),l_=st._,f_=Aa("^"+gn.call(ve).replace(fa,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),mn=ul?C.Buffer:t,Cr=C.Symbol,vn=C.Uint8Array,Rl=mn?mn.allocUnsafe:t,_n=Il(Ee.getPrototypeOf,Ee),Ol=Ee.create,Tl=Ri.propertyIsEnumerable,wn=pn.splice,Al=Cr?Cr.isConcatSpreadable:t,cs=Cr?Cr.iterator:t,Zr=Cr?Cr.toStringTag:t,bn=function(){try{var r=si(Ee,"defineProperty");return r({},"",{}),r}catch{}}(),p_=C.clearTimeout!==st.clearTimeout&&C.clearTimeout,d_=K&&K.now!==st.Date.now&&K.now,g_=C.setTimeout!==st.setTimeout&&C.setTimeout,En=Qe.ceil,xn=Qe.floor,Ca=Ee.getOwnPropertySymbols,y_=mn?mn.isBuffer:t,Cl=C.isFinite,m_=pn.join,v_=Il(Ee.keys,Ee),Ze=Qe.max,ct=Qe.min,__=K.now,w_=C.parseInt,Nl=Qe.random,b_=pn.reverse,Na=si(C,"DataView"),us=si(C,"Map"),Da=si(C,"Promise"),Oi=si(C,"Set"),hs=si(C,"WeakMap"),ls=si(Ee,"create"),In=hs&&new hs,Ti={},E_=ni(Na),x_=ni(us),I_=ni(Da),S_=ni(Oi),P_=ni(hs),Sn=Cr?Cr.prototype:t,fs=Sn?Sn.valueOf:t,Dl=Sn?Sn.toString:t;function p(r){if(qe(r)&&!ie(r)&&!(r instanceof ue)){if(r instanceof jt)return r;if(ve.call(r,"__wrapped__"))return Ff(r)}return new jt(r)}var Ai=function(){function r(){}return function(s){if(!Fe(s))return{};if(Ol)return Ol(s);r.prototype=s;var a=new r;return r.prototype=t,a}}();function Pn(){}function jt(r,s){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=t}p.templateSettings={escape:zm,evaluate:$m,interpolate:Hh,variable:"",imports:{_:p}},p.prototype=Pn.prototype,p.prototype.constructor=p,jt.prototype=Ai(Pn.prototype),jt.prototype.constructor=jt;function ue(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=me,this.__views__=[]}function R_(){var r=new ue(this.__wrapped__);return r.__actions__=mt(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=mt(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=mt(this.__views__),r}function O_(){if(this.__filtered__){var r=new ue(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function T_(){var r=this.__wrapped__.value(),s=this.__dir__,a=ie(r),u=s<0,l=a?r.length:0,d=$0(0,l,this.__views__),_=d.start,b=d.end,I=b-_,L=u?b:_-1,F=this.__iteratees__,M=F.length,B=0,G=ct(I,this.__takeCount__);if(!a||!u&&l==I&&G==I)return sf(r,this.__actions__);var Q=[];e:for(;I--&&B<G;){L+=s;for(var oe=-1,Z=r[L];++oe<M;){var ce=F[oe],he=ce.iteratee,Rt=ce.type,pt=he(Z);if(Rt==X)Z=pt;else if(!pt){if(Rt==$)continue e;break e}}Q[B++]=Z}return Q}ue.prototype=Ai(Pn.prototype),ue.prototype.constructor=ue;function ei(r){var s=-1,a=r==null?0:r.length;for(this.clear();++s<a;){var u=r[s];this.set(u[0],u[1])}}function A_(){this.__data__=ls?ls(null):{},this.size=0}function C_(r){var s=this.has(r)&&delete this.__data__[r];return this.size-=s?1:0,s}function N_(r){var s=this.__data__;if(ls){var a=s[r];return a===v?t:a}return ve.call(s,r)?s[r]:t}function D_(r){var s=this.__data__;return ls?s[r]!==t:ve.call(s,r)}function L_(r,s){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=ls&&s===t?v:s,this}ei.prototype.clear=A_,ei.prototype.delete=C_,ei.prototype.get=N_,ei.prototype.has=D_,ei.prototype.set=L_;function ar(r){var s=-1,a=r==null?0:r.length;for(this.clear();++s<a;){var u=r[s];this.set(u[0],u[1])}}function F_(){this.__data__=[],this.size=0}function j_(r){var s=this.__data__,a=Rn(s,r);if(a<0)return!1;var u=s.length-1;return a==u?s.pop():wn.call(s,a,1),--this.size,!0}function q_(r){var s=this.__data__,a=Rn(s,r);return a<0?t:s[a][1]}function M_(r){return Rn(this.__data__,r)>-1}function U_(r,s){var a=this.__data__,u=Rn(a,r);return u<0?(++this.size,a.push([r,s])):a[u][1]=s,this}ar.prototype.clear=F_,ar.prototype.delete=j_,ar.prototype.get=q_,ar.prototype.has=M_,ar.prototype.set=U_;function cr(r){var s=-1,a=r==null?0:r.length;for(this.clear();++s<a;){var u=r[s];this.set(u[0],u[1])}}function z_(){this.size=0,this.__data__={hash:new ei,map:new(us||ar),string:new ei}}function $_(r){var s=Un(this,r).delete(r);return this.size-=s?1:0,s}function H_(r){return Un(this,r).get(r)}function B_(r){return Un(this,r).has(r)}function V_(r,s){var a=Un(this,r),u=a.size;return a.set(r,s),this.size+=a.size==u?0:1,this}cr.prototype.clear=z_,cr.prototype.delete=$_,cr.prototype.get=H_,cr.prototype.has=B_,cr.prototype.set=V_;function ti(r){var s=-1,a=r==null?0:r.length;for(this.__data__=new cr;++s<a;)this.add(r[s])}function k_(r){return this.__data__.set(r,v),this}function K_(r){return this.__data__.has(r)}ti.prototype.add=ti.prototype.push=k_,ti.prototype.has=K_;function kt(r){var s=this.__data__=new ar(r);this.size=s.size}function G_(){this.__data__=new ar,this.size=0}function W_(r){var s=this.__data__,a=s.delete(r);return this.size=s.size,a}function J_(r){return this.__data__.get(r)}function Y_(r){return this.__data__.has(r)}function X_(r,s){var a=this.__data__;if(a instanceof ar){var u=a.__data__;if(!us||u.length<o-1)return u.push([r,s]),this.size=++a.size,this;a=this.__data__=new cr(u)}return a.set(r,s),this.size=a.size,this}kt.prototype.clear=G_,kt.prototype.delete=W_,kt.prototype.get=J_,kt.prototype.has=Y_,kt.prototype.set=X_;function Ll(r,s){var a=ie(r),u=!a&&oi(r),l=!a&&!u&&jr(r),d=!a&&!u&&!l&&Li(r),_=a||u||l||d,b=_?Ra(r.length,a_):[],I=b.length;for(var L in r)(s||ve.call(r,L))&&!(_&&(L=="length"||l&&(L=="offset"||L=="parent")||d&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||fr(L,I)))&&b.push(L);return b}function Fl(r){var s=r.length;return s?r[Va(0,s-1)]:t}function Q_(r,s){return zn(mt(r),ri(s,0,r.length))}function Z_(r){return zn(mt(r))}function La(r,s,a){(a!==t&&!Kt(r[s],a)||a===t&&!(s in r))&&ur(r,s,a)}function ps(r,s,a){var u=r[s];(!(ve.call(r,s)&&Kt(u,a))||a===t&&!(s in r))&&ur(r,s,a)}function Rn(r,s){for(var a=r.length;a--;)if(Kt(r[a][0],s))return a;return-1}function e0(r,s,a,u){return Nr(r,function(l,d,_){s(u,l,a(l),_)}),u}function jl(r,s){return r&&Yt(s,rt(s),r)}function t0(r,s){return r&&Yt(s,_t(s),r)}function ur(r,s,a){s=="__proto__"&&bn?bn(r,s,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[s]=a}function Fa(r,s){for(var a=-1,u=s.length,l=T(u),d=r==null;++a<u;)l[a]=d?t:gc(r,s[a]);return l}function ri(r,s,a){return r===r&&(a!==t&&(r=r<=a?r:a),s!==t&&(r=r>=s?r:s)),r}function qt(r,s,a,u,l,d){var _,b=s&w,I=s&E,L=s&S;if(a&&(_=l?a(r,u,l,d):a(r)),_!==t)return _;if(!Fe(r))return r;var F=ie(r);if(F){if(_=B0(r),!b)return mt(r,_)}else{var M=ut(r),B=M==Ae||M==Xe;if(jr(r))return af(r,b);if(M==or||M==Pe||B&&!l){if(_=I||B?{}:Pf(r),!b)return I?N0(r,t0(_,r)):C0(r,jl(_,r))}else{if(!Ie[M])return l?r:{};_=V0(r,M,b)}}d||(d=new kt);var G=d.get(r);if(G)return G;d.set(r,_),tp(r)?r.forEach(function(Z){_.add(qt(Z,s,a,Z,r,d))}):Zf(r)&&r.forEach(function(Z,ce){_.set(ce,qt(Z,s,a,ce,r,d))});var Q=L?I?tc:ec:I?_t:rt,oe=F?t:Q(r);return Lt(oe||r,function(Z,ce){oe&&(ce=Z,Z=r[ce]),ps(_,ce,qt(Z,s,a,ce,r,d))}),_}function r0(r){var s=rt(r);return function(a){return ql(a,r,s)}}function ql(r,s,a){var u=a.length;if(r==null)return!u;for(r=Ee(r);u--;){var l=a[u],d=s[l],_=r[l];if(_===t&&!(l in r)||!d(_))return!1}return!0}function Ml(r,s,a){if(typeof r!="function")throw new Ft(h);return ws(function(){r.apply(t,a)},s)}function ds(r,s,a,u){var l=-1,d=hn,_=!0,b=r.length,I=[],L=s.length;if(!b)return I;a&&(s=Ce(s,It(a))),u?(d=ba,_=!1):s.length>=o&&(d=as,_=!1,s=new ti(s));e:for(;++l<b;){var F=r[l],M=a==null?F:a(F);if(F=u||F!==0?F:0,_&&M===M){for(var B=L;B--;)if(s[B]===M)continue e;I.push(F)}else d(s,M,u)||I.push(F)}return I}var Nr=ff(Jt),Ul=ff(qa,!0);function i0(r,s){var a=!0;return Nr(r,function(u,l,d){return a=!!s(u,l,d),a}),a}function On(r,s,a){for(var u=-1,l=r.length;++u<l;){var d=r[u],_=s(d);if(_!=null&&(b===t?_===_&&!Pt(_):a(_,b)))var b=_,I=d}return I}function s0(r,s,a,u){var l=r.length;for(a=ne(a),a<0&&(a=-a>l?0:l+a),u=u===t||u>l?l:ne(u),u<0&&(u+=l),u=a>u?0:ip(u);a<u;)r[a++]=s;return r}function zl(r,s){var a=[];return Nr(r,function(u,l,d){s(u,l,d)&&a.push(u)}),a}function nt(r,s,a,u,l){var d=-1,_=r.length;for(a||(a=K0),l||(l=[]);++d<_;){var b=r[d];s>0&&a(b)?s>1?nt(b,s-1,a,u,l):Tr(l,b):u||(l[l.length]=b)}return l}var ja=pf(),$l=pf(!0);function Jt(r,s){return r&&ja(r,s,rt)}function qa(r,s){return r&&$l(r,s,rt)}function Tn(r,s){return Or(s,function(a){return pr(r[a])})}function ii(r,s){s=Lr(s,r);for(var a=0,u=s.length;r!=null&&a<u;)r=r[Xt(s[a++])];return a&&a==u?r:t}function Hl(r,s,a){var u=s(r);return ie(r)?u:Tr(u,a(r))}function lt(r){return r==null?r===t?Dm:Cm:Zr&&Zr in Ee(r)?z0(r):Z0(r)}function Ma(r,s){return r>s}function n0(r,s){return r!=null&&ve.call(r,s)}function o0(r,s){return r!=null&&s in Ee(r)}function a0(r,s,a){return r>=ct(s,a)&&r<Ze(s,a)}function Ua(r,s,a){for(var u=a?ba:hn,l=r[0].length,d=r.length,_=d,b=T(d),I=1/0,L=[];_--;){var F=r[_];_&&s&&(F=Ce(F,It(s))),I=ct(F.length,I),b[_]=!a&&(s||l>=120&&F.length>=120)?new ti(_&&F):t}F=r[0];var M=-1,B=b[0];e:for(;++M<l&&L.length<I;){var G=F[M],Q=s?s(G):G;if(G=a||G!==0?G:0,!(B?as(B,Q):u(L,Q,a))){for(_=d;--_;){var oe=b[_];if(!(oe?as(oe,Q):u(r[_],Q,a)))continue e}B&&B.push(Q),L.push(G)}}return L}function c0(r,s,a,u){return Jt(r,function(l,d,_){s(u,a(l),d,_)}),u}function gs(r,s,a){s=Lr(s,r),r=Af(r,s);var u=r==null?r:r[Xt(Ut(s))];return u==null?t:xt(u,r,a)}function Bl(r){return qe(r)&&lt(r)==Pe}function u0(r){return qe(r)&&lt(r)==os}function h0(r){return qe(r)&&lt(r)==Te}function ys(r,s,a,u,l){return r===s?!0:r==null||s==null||!qe(r)&&!qe(s)?r!==r&&s!==s:l0(r,s,a,u,ys,l)}function l0(r,s,a,u,l,d){var _=ie(r),b=ie(s),I=_?De:ut(r),L=b?De:ut(s);I=I==Pe?or:I,L=L==Pe?or:L;var F=I==or,M=L==or,B=I==L;if(B&&jr(r)){if(!jr(s))return!1;_=!0,F=!1}if(B&&!F)return d||(d=new kt),_||Li(r)?xf(r,s,a,u,l,d):M0(r,s,I,a,u,l,d);if(!(a&R)){var G=F&&ve.call(r,"__wrapped__"),Q=M&&ve.call(s,"__wrapped__");if(G||Q){var oe=G?r.value():r,Z=Q?s.value():s;return d||(d=new kt),l(oe,Z,a,u,d)}}return B?(d||(d=new kt),U0(r,s,a,u,l,d)):!1}function f0(r){return qe(r)&&ut(r)==we}function za(r,s,a,u){var l=a.length,d=l,_=!u;if(r==null)return!d;for(r=Ee(r);l--;){var b=a[l];if(_&&b[2]?b[1]!==r[b[0]]:!(b[0]in r))return!1}for(;++l<d;){b=a[l];var I=b[0],L=r[I],F=b[1];if(_&&b[2]){if(L===t&&!(I in r))return!1}else{var M=new kt;if(u)var B=u(L,F,I,r,s,M);if(!(B===t?ys(F,L,R|j,u,M):B))return!1}}return!0}function Vl(r){if(!Fe(r)||W0(r))return!1;var s=pr(r)?f_:rv;return s.test(ni(r))}function p0(r){return qe(r)&&lt(r)==is}function d0(r){return qe(r)&&ut(r)==Bt}function g0(r){return qe(r)&&Kn(r.length)&&!!Re[lt(r)]}function kl(r){return typeof r=="function"?r:r==null?wt:typeof r=="object"?ie(r)?Wl(r[0],r[1]):Gl(r):dp(r)}function $a(r){if(!_s(r))return v_(r);var s=[];for(var a in Ee(r))ve.call(r,a)&&a!="constructor"&&s.push(a);return s}function y0(r){if(!Fe(r))return Q0(r);var s=_s(r),a=[];for(var u in r)u=="constructor"&&(s||!ve.call(r,u))||a.push(u);return a}function Ha(r,s){return r<s}function Kl(r,s){var a=-1,u=vt(r)?T(r.length):[];return Nr(r,function(l,d,_){u[++a]=s(l,d,_)}),u}function Gl(r){var s=ic(r);return s.length==1&&s[0][2]?Of(s[0][0],s[0][1]):function(a){return a===r||za(a,r,s)}}function Wl(r,s){return nc(r)&&Rf(s)?Of(Xt(r),s):function(a){var u=gc(a,r);return u===t&&u===s?yc(a,r):ys(s,u,R|j)}}function An(r,s,a,u,l){r!==s&&ja(s,function(d,_){if(l||(l=new kt),Fe(d))m0(r,s,_,a,An,u,l);else{var b=u?u(ac(r,_),d,_+"",r,s,l):t;b===t&&(b=d),La(r,_,b)}},_t)}function m0(r,s,a,u,l,d,_){var b=ac(r,a),I=ac(s,a),L=_.get(I);if(L){La(r,a,L);return}var F=d?d(b,I,a+"",r,s,_):t,M=F===t;if(M){var B=ie(I),G=!B&&jr(I),Q=!B&&!G&&Li(I);F=I,B||G||Q?ie(b)?F=b:$e(b)?F=mt(b):G?(M=!1,F=af(I,!0)):Q?(M=!1,F=cf(I,!0)):F=[]:bs(I)||oi(I)?(F=b,oi(b)?F=sp(b):(!Fe(b)||pr(b))&&(F=Pf(I))):M=!1}M&&(_.set(I,F),l(F,I,u,d,_),_.delete(I)),La(r,a,F)}function Jl(r,s){var a=r.length;if(a)return s+=s<0?a:0,fr(s,a)?r[s]:t}function Yl(r,s,a){s.length?s=Ce(s,function(d){return ie(d)?function(_){return ii(_,d.length===1?d[0]:d)}:d}):s=[wt];var u=-1;s=Ce(s,It(Y()));var l=Kl(r,function(d,_,b){var I=Ce(s,function(L){return L(d)});return{criteria:I,index:++u,value:d}});return Vv(l,function(d,_){return A0(d,_,a)})}function v0(r,s){return Xl(r,s,function(a,u){return yc(r,u)})}function Xl(r,s,a){for(var u=-1,l=s.length,d={};++u<l;){var _=s[u],b=ii(r,_);a(b,_)&&ms(d,Lr(_,r),b)}return d}function _0(r){return function(s){return ii(s,r)}}function Ba(r,s,a,u){var l=u?Bv:xi,d=-1,_=s.length,b=r;for(r===s&&(s=mt(s)),a&&(b=Ce(r,It(a)));++d<_;)for(var I=0,L=s[d],F=a?a(L):L;(I=l(b,F,I,u))>-1;)b!==r&&wn.call(b,I,1),wn.call(r,I,1);return r}function Ql(r,s){for(var a=r?s.length:0,u=a-1;a--;){var l=s[a];if(a==u||l!==d){var d=l;fr(l)?wn.call(r,l,1):Ga(r,l)}}return r}function Va(r,s){return r+xn(Nl()*(s-r+1))}function w0(r,s,a,u){for(var l=-1,d=Ze(En((s-r)/(a||1)),0),_=T(d);d--;)_[u?d:++l]=r,r+=a;return _}function ka(r,s){var a="";if(!r||s<1||s>tt)return a;do s%2&&(a+=r),s=xn(s/2),s&&(r+=r);while(s);return a}function ae(r,s){return cc(Tf(r,s,wt),r+"")}function b0(r){return Fl(Fi(r))}function E0(r,s){var a=Fi(r);return zn(a,ri(s,0,a.length))}function ms(r,s,a,u){if(!Fe(r))return r;s=Lr(s,r);for(var l=-1,d=s.length,_=d-1,b=r;b!=null&&++l<d;){var I=Xt(s[l]),L=a;if(I==="__proto__"||I==="constructor"||I==="prototype")return r;if(l!=_){var F=b[I];L=u?u(F,I,b):t,L===t&&(L=Fe(F)?F:fr(s[l+1])?[]:{})}ps(b,I,L),b=b[I]}return r}var Zl=In?function(r,s){return In.set(r,s),r}:wt,x0=bn?function(r,s){return bn(r,"toString",{configurable:!0,enumerable:!1,value:vc(s),writable:!0})}:wt;function I0(r){return zn(Fi(r))}function Mt(r,s,a){var u=-1,l=r.length;s<0&&(s=-s>l?0:l+s),a=a>l?l:a,a<0&&(a+=l),l=s>a?0:a-s>>>0,s>>>=0;for(var d=T(l);++u<l;)d[u]=r[u+s];return d}function S0(r,s){var a;return Nr(r,function(u,l,d){return a=s(u,l,d),!a}),!!a}function Cn(r,s,a){var u=0,l=r==null?u:r.length;if(typeof s=="number"&&s===s&&l<=Ke){for(;u<l;){var d=u+l>>>1,_=r[d];_!==null&&!Pt(_)&&(a?_<=s:_<s)?u=d+1:l=d}return l}return Ka(r,s,wt,a)}function Ka(r,s,a,u){var l=0,d=r==null?0:r.length;if(d===0)return 0;s=a(s);for(var _=s!==s,b=s===null,I=Pt(s),L=s===t;l<d;){var F=xn((l+d)/2),M=a(r[F]),B=M!==t,G=M===null,Q=M===M,oe=Pt(M);if(_)var Z=u||Q;else L?Z=Q&&(u||B):b?Z=Q&&B&&(u||!G):I?Z=Q&&B&&!G&&(u||!oe):G||oe?Z=!1:Z=u?M<=s:M<s;Z?l=F+1:d=F}return ct(d,ke)}function ef(r,s){for(var a=-1,u=r.length,l=0,d=[];++a<u;){var _=r[a],b=s?s(_):_;if(!a||!Kt(b,I)){var I=b;d[l++]=_===0?0:_}}return d}function tf(r){return typeof r=="number"?r:Pt(r)?Se:+r}function St(r){if(typeof r=="string")return r;if(ie(r))return Ce(r,St)+"";if(Pt(r))return Dl?Dl.call(r):"";var s=r+"";return s=="0"&&1/r==-Ve?"-0":s}function Dr(r,s,a){var u=-1,l=hn,d=r.length,_=!0,b=[],I=b;if(a)_=!1,l=ba;else if(d>=o){var L=s?null:j0(r);if(L)return fn(L);_=!1,l=as,I=new ti}else I=s?[]:b;e:for(;++u<d;){var F=r[u],M=s?s(F):F;if(F=a||F!==0?F:0,_&&M===M){for(var B=I.length;B--;)if(I[B]===M)continue e;s&&I.push(M),b.push(F)}else l(I,M,a)||(I!==b&&I.push(M),b.push(F))}return b}function Ga(r,s){return s=Lr(s,r),r=Af(r,s),r==null||delete r[Xt(Ut(s))]}function rf(r,s,a,u){return ms(r,s,a(ii(r,s)),u)}function Nn(r,s,a,u){for(var l=r.length,d=u?l:-1;(u?d--:++d<l)&&s(r[d],d,r););return a?Mt(r,u?0:d,u?d+1:l):Mt(r,u?d+1:0,u?l:d)}function sf(r,s){var a=r;return a instanceof ue&&(a=a.value()),Ea(s,function(u,l){return l.func.apply(l.thisArg,Tr([u],l.args))},a)}function Wa(r,s,a){var u=r.length;if(u<2)return u?Dr(r[0]):[];for(var l=-1,d=T(u);++l<u;)for(var _=r[l],b=-1;++b<u;)b!=l&&(d[l]=ds(d[l]||_,r[b],s,a));return Dr(nt(d,1),s,a)}function nf(r,s,a){for(var u=-1,l=r.length,d=s.length,_={};++u<l;){var b=u<d?s[u]:t;a(_,r[u],b)}return _}function Ja(r){return $e(r)?r:[]}function Ya(r){return typeof r=="function"?r:wt}function Lr(r,s){return ie(r)?r:nc(r,s)?[r]:Lf(ge(r))}var P0=ae;function Fr(r,s,a){var u=r.length;return a=a===t?u:a,!s&&a>=u?r:Mt(r,s,a)}var of=p_||function(r){return st.clearTimeout(r)};function af(r,s){if(s)return r.slice();var a=r.length,u=Rl?Rl(a):new r.constructor(a);return r.copy(u),u}function Xa(r){var s=new r.constructor(r.byteLength);return new vn(s).set(new vn(r)),s}function R0(r,s){var a=s?Xa(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function O0(r){var s=new r.constructor(r.source,Bh.exec(r));return s.lastIndex=r.lastIndex,s}function T0(r){return fs?Ee(fs.call(r)):{}}function cf(r,s){var a=s?Xa(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function uf(r,s){if(r!==s){var a=r!==t,u=r===null,l=r===r,d=Pt(r),_=s!==t,b=s===null,I=s===s,L=Pt(s);if(!b&&!L&&!d&&r>s||d&&_&&I&&!b&&!L||u&&_&&I||!a&&I||!l)return 1;if(!u&&!d&&!L&&r<s||L&&a&&l&&!u&&!d||b&&a&&l||!_&&l||!I)return-1}return 0}function A0(r,s,a){for(var u=-1,l=r.criteria,d=s.criteria,_=l.length,b=a.length;++u<_;){var I=uf(l[u],d[u]);if(I){if(u>=b)return I;var L=a[u];return I*(L=="desc"?-1:1)}}return r.index-s.index}function hf(r,s,a,u){for(var l=-1,d=r.length,_=a.length,b=-1,I=s.length,L=Ze(d-_,0),F=T(I+L),M=!u;++b<I;)F[b]=s[b];for(;++l<_;)(M||l<d)&&(F[a[l]]=r[l]);for(;L--;)F[b++]=r[l++];return F}function lf(r,s,a,u){for(var l=-1,d=r.length,_=-1,b=a.length,I=-1,L=s.length,F=Ze(d-b,0),M=T(F+L),B=!u;++l<F;)M[l]=r[l];for(var G=l;++I<L;)M[G+I]=s[I];for(;++_<b;)(B||l<d)&&(M[G+a[_]]=r[l++]);return M}function mt(r,s){var a=-1,u=r.length;for(s||(s=T(u));++a<u;)s[a]=r[a];return s}function Yt(r,s,a,u){var l=!a;a||(a={});for(var d=-1,_=s.length;++d<_;){var b=s[d],I=u?u(a[b],r[b],b,a,r):t;I===t&&(I=r[b]),l?ur(a,b,I):ps(a,b,I)}return a}function C0(r,s){return Yt(r,sc(r),s)}function N0(r,s){return Yt(r,If(r),s)}function Dn(r,s){return function(a,u){var l=ie(a)?qv:e0,d=s?s():{};return l(a,r,Y(u,2),d)}}function Ci(r){return ae(function(s,a){var u=-1,l=a.length,d=l>1?a[l-1]:t,_=l>2?a[2]:t;for(d=r.length>3&&typeof d=="function"?(l--,d):t,_&&ft(a[0],a[1],_)&&(d=l<3?t:d,l=1),s=Ee(s);++u<l;){var b=a[u];b&&r(s,b,u,d)}return s})}function ff(r,s){return function(a,u){if(a==null)return a;if(!vt(a))return r(a,u);for(var l=a.length,d=s?l:-1,_=Ee(a);(s?d--:++d<l)&&u(_[d],d,_)!==!1;);return a}}function pf(r){return function(s,a,u){for(var l=-1,d=Ee(s),_=u(s),b=_.length;b--;){var I=_[r?b:++l];if(a(d[I],I,d)===!1)break}return s}}function D0(r,s,a){var u=s&q,l=vs(r);function d(){var _=this&&this!==st&&this instanceof d?l:r;return _.apply(u?a:this,arguments)}return d}function df(r){return function(s){s=ge(s);var a=Ii(s)?Vt(s):t,u=a?a[0]:s.charAt(0),l=a?Fr(a,1).join(""):s.slice(1);return u[r]()+l}}function Ni(r){return function(s){return Ea(fp(lp(s).replace(xv,"")),r,"")}}function vs(r){return function(){var s=arguments;switch(s.length){case 0:return new r;case 1:return new r(s[0]);case 2:return new r(s[0],s[1]);case 3:return new r(s[0],s[1],s[2]);case 4:return new r(s[0],s[1],s[2],s[3]);case 5:return new r(s[0],s[1],s[2],s[3],s[4]);case 6:return new r(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new r(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var a=Ai(r.prototype),u=r.apply(a,s);return Fe(u)?u:a}}function L0(r,s,a){var u=vs(r);function l(){for(var d=arguments.length,_=T(d),b=d,I=Di(l);b--;)_[b]=arguments[b];var L=d<3&&_[0]!==I&&_[d-1]!==I?[]:Ar(_,I);if(d-=L.length,d<a)return _f(r,s,Ln,l.placeholder,t,_,L,t,t,a-d);var F=this&&this!==st&&this instanceof l?u:r;return xt(F,this,_)}return l}function gf(r){return function(s,a,u){var l=Ee(s);if(!vt(s)){var d=Y(a,3);s=rt(s),a=function(b){return d(l[b],b,l)}}var _=r(s,a,u);return _>-1?l[d?s[_]:_]:t}}function yf(r){return lr(function(s){var a=s.length,u=a,l=jt.prototype.thru;for(r&&s.reverse();u--;){var d=s[u];if(typeof d!="function")throw new Ft(h);if(l&&!_&&Mn(d)=="wrapper")var _=new jt([],!0)}for(u=_?u:a;++u<a;){d=s[u];var b=Mn(d),I=b=="wrapper"?rc(d):t;I&&oc(I[0])&&I[1]==(A|H|ee|N)&&!I[4].length&&I[9]==1?_=_[Mn(I[0])].apply(_,I[3]):_=d.length==1&&oc(d)?_[b]():_.thru(d)}return function(){var L=arguments,F=L[0];if(_&&L.length==1&&ie(F))return _.plant(F).value();for(var M=0,B=a?s[M].apply(this,L):F;++M<a;)B=s[M].call(this,B);return B}})}function Ln(r,s,a,u,l,d,_,b,I,L){var F=s&A,M=s&q,B=s&V,G=s&(H|z),Q=s&re,oe=B?t:vs(r);function Z(){for(var ce=arguments.length,he=T(ce),Rt=ce;Rt--;)he[Rt]=arguments[Rt];if(G)var pt=Di(Z),Ot=Kv(he,pt);if(u&&(he=hf(he,u,l,G)),d&&(he=lf(he,d,_,G)),ce-=Ot,G&&ce<L){var He=Ar(he,pt);return _f(r,s,Ln,Z.placeholder,a,he,He,b,I,L-ce)}var Gt=M?a:this,gr=B?Gt[r]:r;return ce=he.length,b?he=ew(he,b):Q&&ce>1&&he.reverse(),F&&I<ce&&(he.length=I),this&&this!==st&&this instanceof Z&&(gr=oe||vs(gr)),gr.apply(Gt,he)}return Z}function mf(r,s){return function(a,u){return c0(a,r,s(u),{})}}function Fn(r,s){return function(a,u){var l;if(a===t&&u===t)return s;if(a!==t&&(l=a),u!==t){if(l===t)return u;typeof a=="string"||typeof u=="string"?(a=St(a),u=St(u)):(a=tf(a),u=tf(u)),l=r(a,u)}return l}}function Qa(r){return lr(function(s){return s=Ce(s,It(Y())),ae(function(a){var u=this;return r(s,function(l){return xt(l,u,a)})})})}function jn(r,s){s=s===t?" ":St(s);var a=s.length;if(a<2)return a?ka(s,r):s;var u=ka(s,En(r/Si(s)));return Ii(s)?Fr(Vt(u),0,r).join(""):u.slice(0,r)}function F0(r,s,a,u){var l=s&q,d=vs(r);function _(){for(var b=-1,I=arguments.length,L=-1,F=u.length,M=T(F+I),B=this&&this!==st&&this instanceof _?d:r;++L<F;)M[L]=u[L];for(;I--;)M[L++]=arguments[++b];return xt(B,l?a:this,M)}return _}function vf(r){return function(s,a,u){return u&&typeof u!="number"&&ft(s,a,u)&&(a=u=t),s=dr(s),a===t?(a=s,s=0):a=dr(a),u=u===t?s<a?1:-1:dr(u),w0(s,a,u,r)}}function qn(r){return function(s,a){return typeof s=="string"&&typeof a=="string"||(s=zt(s),a=zt(a)),r(s,a)}}function _f(r,s,a,u,l,d,_,b,I,L){var F=s&H,M=F?_:t,B=F?t:_,G=F?d:t,Q=F?t:d;s|=F?ee:se,s&=~(F?se:ee),s&J||(s&=~(q|V));var oe=[r,s,l,G,M,Q,B,b,I,L],Z=a.apply(t,oe);return oc(r)&&Cf(Z,oe),Z.placeholder=u,Nf(Z,r,s)}function Za(r){var s=Qe[r];return function(a,u){if(a=zt(a),u=u==null?0:ct(ne(u),292),u&&Cl(a)){var l=(ge(a)+"e").split("e"),d=s(l[0]+"e"+(+l[1]+u));return l=(ge(d)+"e").split("e"),+(l[0]+"e"+(+l[1]-u))}return s(a)}}var j0=Oi&&1/fn(new Oi([,-0]))[1]==Ve?function(r){return new Oi(r)}:bc;function wf(r){return function(s){var a=ut(s);return a==we?Ta(s):a==Bt?Zv(s):kv(s,r(s))}}function hr(r,s,a,u,l,d,_,b){var I=s&V;if(!I&&typeof r!="function")throw new Ft(h);var L=u?u.length:0;if(L||(s&=~(ee|se),u=l=t),_=_===t?_:Ze(ne(_),0),b=b===t?b:ne(b),L-=l?l.length:0,s&se){var F=u,M=l;u=l=t}var B=I?t:rc(r),G=[r,s,a,u,l,F,M,d,_,b];if(B&&X0(G,B),r=G[0],s=G[1],a=G[2],u=G[3],l=G[4],b=G[9]=G[9]===t?I?0:r.length:Ze(G[9]-L,0),!b&&s&(H|z)&&(s&=~(H|z)),!s||s==q)var Q=D0(r,s,a);else s==H||s==z?Q=L0(r,s,b):(s==ee||s==(q|ee))&&!l.length?Q=F0(r,s,a,u):Q=Ln.apply(t,G);var oe=B?Zl:Cf;return Nf(oe(Q,G),r,s)}function bf(r,s,a,u){return r===t||Kt(r,Ri[a])&&!ve.call(u,a)?s:r}function Ef(r,s,a,u,l,d){return Fe(r)&&Fe(s)&&(d.set(s,r),An(r,s,t,Ef,d),d.delete(s)),r}function q0(r){return bs(r)?t:r}function xf(r,s,a,u,l,d){var _=a&R,b=r.length,I=s.length;if(b!=I&&!(_&&I>b))return!1;var L=d.get(r),F=d.get(s);if(L&&F)return L==s&&F==r;var M=-1,B=!0,G=a&j?new ti:t;for(d.set(r,s),d.set(s,r);++M<b;){var Q=r[M],oe=s[M];if(u)var Z=_?u(oe,Q,M,s,r,d):u(Q,oe,M,r,s,d);if(Z!==t){if(Z)continue;B=!1;break}if(G){if(!xa(s,function(ce,he){if(!as(G,he)&&(Q===ce||l(Q,ce,a,u,d)))return G.push(he)})){B=!1;break}}else if(!(Q===oe||l(Q,oe,a,u,d))){B=!1;break}}return d.delete(r),d.delete(s),B}function M0(r,s,a,u,l,d,_){switch(a){case bi:if(r.byteLength!=s.byteLength||r.byteOffset!=s.byteOffset)return!1;r=r.buffer,s=s.buffer;case os:return!(r.byteLength!=s.byteLength||!d(new vn(r),new vn(s)));case xe:case Te:case je:return Kt(+r,+s);case Le:return r.name==s.name&&r.message==s.message;case is:case ss:return r==s+"";case we:var b=Ta;case Bt:var I=u&R;if(b||(b=fn),r.size!=s.size&&!I)return!1;var L=_.get(r);if(L)return L==s;u|=j,_.set(r,s);var F=xf(b(r),b(s),u,l,d,_);return _.delete(r),F;case on:if(fs)return fs.call(r)==fs.call(s)}return!1}function U0(r,s,a,u,l,d){var _=a&R,b=ec(r),I=b.length,L=ec(s),F=L.length;if(I!=F&&!_)return!1;for(var M=I;M--;){var B=b[M];if(!(_?B in s:ve.call(s,B)))return!1}var G=d.get(r),Q=d.get(s);if(G&&Q)return G==s&&Q==r;var oe=!0;d.set(r,s),d.set(s,r);for(var Z=_;++M<I;){B=b[M];var ce=r[B],he=s[B];if(u)var Rt=_?u(he,ce,B,s,r,d):u(ce,he,B,r,s,d);if(!(Rt===t?ce===he||l(ce,he,a,u,d):Rt)){oe=!1;break}Z||(Z=B=="constructor")}if(oe&&!Z){var pt=r.constructor,Ot=s.constructor;pt!=Ot&&"constructor"in r&&"constructor"in s&&!(typeof pt=="function"&&pt instanceof pt&&typeof Ot=="function"&&Ot instanceof Ot)&&(oe=!1)}return d.delete(r),d.delete(s),oe}function lr(r){return cc(Tf(r,t,Mf),r+"")}function ec(r){return Hl(r,rt,sc)}function tc(r){return Hl(r,_t,If)}var rc=In?function(r){return In.get(r)}:bc;function Mn(r){for(var s=r.name+"",a=Ti[s],u=ve.call(Ti,s)?a.length:0;u--;){var l=a[u],d=l.func;if(d==null||d==r)return l.name}return s}function Di(r){var s=ve.call(p,"placeholder")?p:r;return s.placeholder}function Y(){var r=p.iteratee||_c;return r=r===_c?kl:r,arguments.length?r(arguments[0],arguments[1]):r}function Un(r,s){var a=r.__data__;return G0(s)?a[typeof s=="string"?"string":"hash"]:a.map}function ic(r){for(var s=rt(r),a=s.length;a--;){var u=s[a],l=r[u];s[a]=[u,l,Rf(l)]}return s}function si(r,s){var a=Yv(r,s);return Vl(a)?a:t}function z0(r){var s=ve.call(r,Zr),a=r[Zr];try{r[Zr]=t;var u=!0}catch{}var l=yn.call(r);return u&&(s?r[Zr]=a:delete r[Zr]),l}var sc=Ca?function(r){return r==null?[]:(r=Ee(r),Or(Ca(r),function(s){return Tl.call(r,s)}))}:Ec,If=Ca?function(r){for(var s=[];r;)Tr(s,sc(r)),r=_n(r);return s}:Ec,ut=lt;(Na&&ut(new Na(new ArrayBuffer(1)))!=bi||us&&ut(new us)!=we||Da&&ut(Da.resolve())!=Uh||Oi&&ut(new Oi)!=Bt||hs&&ut(new hs)!=ns)&&(ut=function(r){var s=lt(r),a=s==or?r.constructor:t,u=a?ni(a):"";if(u)switch(u){case E_:return bi;case x_:return we;case I_:return Uh;case S_:return Bt;case P_:return ns}return s});function $0(r,s,a){for(var u=-1,l=a.length;++u<l;){var d=a[u],_=d.size;switch(d.type){case"drop":r+=_;break;case"dropRight":s-=_;break;case"take":s=ct(s,r+_);break;case"takeRight":r=Ze(r,s-_);break}}return{start:r,end:s}}function H0(r){var s=r.match(Wm);return s?s[1].split(Jm):[]}function Sf(r,s,a){s=Lr(s,r);for(var u=-1,l=s.length,d=!1;++u<l;){var _=Xt(s[u]);if(!(d=r!=null&&a(r,_)))break;r=r[_]}return d||++u!=l?d:(l=r==null?0:r.length,!!l&&Kn(l)&&fr(_,l)&&(ie(r)||oi(r)))}function B0(r){var s=r.length,a=new r.constructor(s);return s&&typeof r[0]=="string"&&ve.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function Pf(r){return typeof r.constructor=="function"&&!_s(r)?Ai(_n(r)):{}}function V0(r,s,a){var u=r.constructor;switch(s){case os:return Xa(r);case xe:case Te:return new u(+r);case bi:return R0(r,a);case ia:case sa:case na:case oa:case aa:case ca:case ua:case ha:case la:return cf(r,a);case we:return new u;case je:case ss:return new u(r);case is:return O0(r);case Bt:return new u;case on:return T0(r)}}function k0(r,s){var a=s.length;if(!a)return r;var u=a-1;return s[u]=(a>1?"& ":"")+s[u],s=s.join(a>2?", ":" "),r.replace(Gm,`{
/* [wrapped with `+s+`] */
`)}function K0(r){return ie(r)||oi(r)||!!(Al&&r&&r[Al])}function fr(r,s){var a=typeof r;return s=s??tt,!!s&&(a=="number"||a!="symbol"&&sv.test(r))&&r>-1&&r%1==0&&r<s}function ft(r,s,a){if(!Fe(a))return!1;var u=typeof s;return(u=="number"?vt(a)&&fr(s,a.length):u=="string"&&s in a)?Kt(a[s],r):!1}function nc(r,s){if(ie(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||Pt(r)?!0:Bm.test(r)||!Hm.test(r)||s!=null&&r in Ee(s)}function G0(r){var s=typeof r;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?r!=="__proto__":r===null}function oc(r){var s=Mn(r),a=p[s];if(typeof a!="function"||!(s in ue.prototype))return!1;if(r===a)return!0;var u=rc(a);return!!u&&r===u[0]}function W0(r){return!!Pl&&Pl in r}var J0=dn?pr:xc;function _s(r){var s=r&&r.constructor,a=typeof s=="function"&&s.prototype||Ri;return r===a}function Rf(r){return r===r&&!Fe(r)}function Of(r,s){return function(a){return a==null?!1:a[r]===s&&(s!==t||r in Ee(a))}}function Y0(r){var s=Vn(r,function(u){return a.size===y&&a.clear(),u}),a=s.cache;return s}function X0(r,s){var a=r[1],u=s[1],l=a|u,d=l<(q|V|A),_=u==A&&a==H||u==A&&a==N&&r[7].length<=s[8]||u==(A|N)&&s[7].length<=s[8]&&a==H;if(!(d||_))return r;u&q&&(r[2]=s[2],l|=a&q?0:J);var b=s[3];if(b){var I=r[3];r[3]=I?hf(I,b,s[4]):b,r[4]=I?Ar(r[3],g):s[4]}return b=s[5],b&&(I=r[5],r[5]=I?lf(I,b,s[6]):b,r[6]=I?Ar(r[5],g):s[6]),b=s[7],b&&(r[7]=b),u&A&&(r[8]=r[8]==null?s[8]:ct(r[8],s[8])),r[9]==null&&(r[9]=s[9]),r[0]=s[0],r[1]=l,r}function Q0(r){var s=[];if(r!=null)for(var a in Ee(r))s.push(a);return s}function Z0(r){return yn.call(r)}function Tf(r,s,a){return s=Ze(s===t?r.length-1:s,0),function(){for(var u=arguments,l=-1,d=Ze(u.length-s,0),_=T(d);++l<d;)_[l]=u[s+l];l=-1;for(var b=T(s+1);++l<s;)b[l]=u[l];return b[s]=a(_),xt(r,this,b)}}function Af(r,s){return s.length<2?r:ii(r,Mt(s,0,-1))}function ew(r,s){for(var a=r.length,u=ct(s.length,a),l=mt(r);u--;){var d=s[u];r[u]=fr(d,a)?l[d]:t}return r}function ac(r,s){if(!(s==="constructor"&&typeof r[s]=="function")&&s!="__proto__")return r[s]}var Cf=Df(Zl),ws=g_||function(r,s){return st.setTimeout(r,s)},cc=Df(x0);function Nf(r,s,a){var u=s+"";return cc(r,k0(u,tw(H0(u),a)))}function Df(r){var s=0,a=0;return function(){var u=__(),l=U-(u-a);if(a=u,l>0){if(++s>=D)return arguments[0]}else s=0;return r.apply(t,arguments)}}function zn(r,s){var a=-1,u=r.length,l=u-1;for(s=s===t?u:s;++a<s;){var d=Va(a,l),_=r[d];r[d]=r[a],r[a]=_}return r.length=s,r}var Lf=Y0(function(r){var s=[];return r.charCodeAt(0)===46&&s.push(""),r.replace(Vm,function(a,u,l,d){s.push(l?d.replace(Qm,"$1"):u||a)}),s});function Xt(r){if(typeof r=="string"||Pt(r))return r;var s=r+"";return s=="0"&&1/r==-Ve?"-0":s}function ni(r){if(r!=null){try{return gn.call(r)}catch{}try{return r+""}catch{}}return""}function tw(r,s){return Lt(ze,function(a){var u="_."+a[0];s&a[1]&&!hn(r,u)&&r.push(u)}),r.sort()}function Ff(r){if(r instanceof ue)return r.clone();var s=new jt(r.__wrapped__,r.__chain__);return s.__actions__=mt(r.__actions__),s.__index__=r.__index__,s.__values__=r.__values__,s}function rw(r,s,a){(a?ft(r,s,a):s===t)?s=1:s=Ze(ne(s),0);var u=r==null?0:r.length;if(!u||s<1)return[];for(var l=0,d=0,_=T(En(u/s));l<u;)_[d++]=Mt(r,l,l+=s);return _}function iw(r){for(var s=-1,a=r==null?0:r.length,u=0,l=[];++s<a;){var d=r[s];d&&(l[u++]=d)}return l}function sw(){var r=arguments.length;if(!r)return[];for(var s=T(r-1),a=arguments[0],u=r;u--;)s[u-1]=arguments[u];return Tr(ie(a)?mt(a):[a],nt(s,1))}var nw=ae(function(r,s){return $e(r)?ds(r,nt(s,1,$e,!0)):[]}),ow=ae(function(r,s){var a=Ut(s);return $e(a)&&(a=t),$e(r)?ds(r,nt(s,1,$e,!0),Y(a,2)):[]}),aw=ae(function(r,s){var a=Ut(s);return $e(a)&&(a=t),$e(r)?ds(r,nt(s,1,$e,!0),t,a):[]});function cw(r,s,a){var u=r==null?0:r.length;return u?(s=a||s===t?1:ne(s),Mt(r,s<0?0:s,u)):[]}function uw(r,s,a){var u=r==null?0:r.length;return u?(s=a||s===t?1:ne(s),s=u-s,Mt(r,0,s<0?0:s)):[]}function hw(r,s){return r&&r.length?Nn(r,Y(s,3),!0,!0):[]}function lw(r,s){return r&&r.length?Nn(r,Y(s,3),!0):[]}function fw(r,s,a,u){var l=r==null?0:r.length;return l?(a&&typeof a!="number"&&ft(r,s,a)&&(a=0,u=l),s0(r,s,a,u)):[]}function jf(r,s,a){var u=r==null?0:r.length;if(!u)return-1;var l=a==null?0:ne(a);return l<0&&(l=Ze(u+l,0)),ln(r,Y(s,3),l)}function qf(r,s,a){var u=r==null?0:r.length;if(!u)return-1;var l=u-1;return a!==t&&(l=ne(a),l=a<0?Ze(u+l,0):ct(l,u-1)),ln(r,Y(s,3),l,!0)}function Mf(r){var s=r==null?0:r.length;return s?nt(r,1):[]}function pw(r){var s=r==null?0:r.length;return s?nt(r,Ve):[]}function dw(r,s){var a=r==null?0:r.length;return a?(s=s===t?1:ne(s),nt(r,s)):[]}function gw(r){for(var s=-1,a=r==null?0:r.length,u={};++s<a;){var l=r[s];u[l[0]]=l[1]}return u}function Uf(r){return r&&r.length?r[0]:t}function yw(r,s,a){var u=r==null?0:r.length;if(!u)return-1;var l=a==null?0:ne(a);return l<0&&(l=Ze(u+l,0)),xi(r,s,l)}function mw(r){var s=r==null?0:r.length;return s?Mt(r,0,-1):[]}var vw=ae(function(r){var s=Ce(r,Ja);return s.length&&s[0]===r[0]?Ua(s):[]}),_w=ae(function(r){var s=Ut(r),a=Ce(r,Ja);return s===Ut(a)?s=t:a.pop(),a.length&&a[0]===r[0]?Ua(a,Y(s,2)):[]}),ww=ae(function(r){var s=Ut(r),a=Ce(r,Ja);return s=typeof s=="function"?s:t,s&&a.pop(),a.length&&a[0]===r[0]?Ua(a,t,s):[]});function bw(r,s){return r==null?"":m_.call(r,s)}function Ut(r){var s=r==null?0:r.length;return s?r[s-1]:t}function Ew(r,s,a){var u=r==null?0:r.length;if(!u)return-1;var l=u;return a!==t&&(l=ne(a),l=l<0?Ze(u+l,0):ct(l,u-1)),s===s?t_(r,s,l):ln(r,vl,l,!0)}function xw(r,s){return r&&r.length?Jl(r,ne(s)):t}var Iw=ae(zf);function zf(r,s){return r&&r.length&&s&&s.length?Ba(r,s):r}function Sw(r,s,a){return r&&r.length&&s&&s.length?Ba(r,s,Y(a,2)):r}function Pw(r,s,a){return r&&r.length&&s&&s.length?Ba(r,s,t,a):r}var Rw=lr(function(r,s){var a=r==null?0:r.length,u=Fa(r,s);return Ql(r,Ce(s,function(l){return fr(l,a)?+l:l}).sort(uf)),u});function Ow(r,s){var a=[];if(!(r&&r.length))return a;var u=-1,l=[],d=r.length;for(s=Y(s,3);++u<d;){var _=r[u];s(_,u,r)&&(a.push(_),l.push(u))}return Ql(r,l),a}function uc(r){return r==null?r:b_.call(r)}function Tw(r,s,a){var u=r==null?0:r.length;return u?(a&&typeof a!="number"&&ft(r,s,a)?(s=0,a=u):(s=s==null?0:ne(s),a=a===t?u:ne(a)),Mt(r,s,a)):[]}function Aw(r,s){return Cn(r,s)}function Cw(r,s,a){return Ka(r,s,Y(a,2))}function Nw(r,s){var a=r==null?0:r.length;if(a){var u=Cn(r,s);if(u<a&&Kt(r[u],s))return u}return-1}function Dw(r,s){return Cn(r,s,!0)}function Lw(r,s,a){return Ka(r,s,Y(a,2),!0)}function Fw(r,s){var a=r==null?0:r.length;if(a){var u=Cn(r,s,!0)-1;if(Kt(r[u],s))return u}return-1}function jw(r){return r&&r.length?ef(r):[]}function qw(r,s){return r&&r.length?ef(r,Y(s,2)):[]}function Mw(r){var s=r==null?0:r.length;return s?Mt(r,1,s):[]}function Uw(r,s,a){return r&&r.length?(s=a||s===t?1:ne(s),Mt(r,0,s<0?0:s)):[]}function zw(r,s,a){var u=r==null?0:r.length;return u?(s=a||s===t?1:ne(s),s=u-s,Mt(r,s<0?0:s,u)):[]}function $w(r,s){return r&&r.length?Nn(r,Y(s,3),!1,!0):[]}function Hw(r,s){return r&&r.length?Nn(r,Y(s,3)):[]}var Bw=ae(function(r){return Dr(nt(r,1,$e,!0))}),Vw=ae(function(r){var s=Ut(r);return $e(s)&&(s=t),Dr(nt(r,1,$e,!0),Y(s,2))}),kw=ae(function(r){var s=Ut(r);return s=typeof s=="function"?s:t,Dr(nt(r,1,$e,!0),t,s)});function Kw(r){return r&&r.length?Dr(r):[]}function Gw(r,s){return r&&r.length?Dr(r,Y(s,2)):[]}function Ww(r,s){return s=typeof s=="function"?s:t,r&&r.length?Dr(r,t,s):[]}function hc(r){if(!(r&&r.length))return[];var s=0;return r=Or(r,function(a){if($e(a))return s=Ze(a.length,s),!0}),Ra(s,function(a){return Ce(r,Ia(a))})}function $f(r,s){if(!(r&&r.length))return[];var a=hc(r);return s==null?a:Ce(a,function(u){return xt(s,t,u)})}var Jw=ae(function(r,s){return $e(r)?ds(r,s):[]}),Yw=ae(function(r){return Wa(Or(r,$e))}),Xw=ae(function(r){var s=Ut(r);return $e(s)&&(s=t),Wa(Or(r,$e),Y(s,2))}),Qw=ae(function(r){var s=Ut(r);return s=typeof s=="function"?s:t,Wa(Or(r,$e),t,s)}),Zw=ae(hc);function eb(r,s){return nf(r||[],s||[],ps)}function tb(r,s){return nf(r||[],s||[],ms)}var rb=ae(function(r){var s=r.length,a=s>1?r[s-1]:t;return a=typeof a=="function"?(r.pop(),a):t,$f(r,a)});function Hf(r){var s=p(r);return s.__chain__=!0,s}function ib(r,s){return s(r),r}function $n(r,s){return s(r)}var sb=lr(function(r){var s=r.length,a=s?r[0]:0,u=this.__wrapped__,l=function(d){return Fa(d,r)};return s>1||this.__actions__.length||!(u instanceof ue)||!fr(a)?this.thru(l):(u=u.slice(a,+a+(s?1:0)),u.__actions__.push({func:$n,args:[l],thisArg:t}),new jt(u,this.__chain__).thru(function(d){return s&&!d.length&&d.push(t),d}))});function nb(){return Hf(this)}function ob(){return new jt(this.value(),this.__chain__)}function ab(){this.__values__===t&&(this.__values__=rp(this.value()));var r=this.__index__>=this.__values__.length,s=r?t:this.__values__[this.__index__++];return{done:r,value:s}}function cb(){return this}function ub(r){for(var s,a=this;a instanceof Pn;){var u=Ff(a);u.__index__=0,u.__values__=t,s?l.__wrapped__=u:s=u;var l=u;a=a.__wrapped__}return l.__wrapped__=r,s}function hb(){var r=this.__wrapped__;if(r instanceof ue){var s=r;return this.__actions__.length&&(s=new ue(this)),s=s.reverse(),s.__actions__.push({func:$n,args:[uc],thisArg:t}),new jt(s,this.__chain__)}return this.thru(uc)}function lb(){return sf(this.__wrapped__,this.__actions__)}var fb=Dn(function(r,s,a){ve.call(r,a)?++r[a]:ur(r,a,1)});function pb(r,s,a){var u=ie(r)?yl:i0;return a&&ft(r,s,a)&&(s=t),u(r,Y(s,3))}function db(r,s){var a=ie(r)?Or:zl;return a(r,Y(s,3))}var gb=gf(jf),yb=gf(qf);function mb(r,s){return nt(Hn(r,s),1)}function vb(r,s){return nt(Hn(r,s),Ve)}function _b(r,s,a){return a=a===t?1:ne(a),nt(Hn(r,s),a)}function Bf(r,s){var a=ie(r)?Lt:Nr;return a(r,Y(s,3))}function Vf(r,s){var a=ie(r)?Mv:Ul;return a(r,Y(s,3))}var wb=Dn(function(r,s,a){ve.call(r,a)?r[a].push(s):ur(r,a,[s])});function bb(r,s,a,u){r=vt(r)?r:Fi(r),a=a&&!u?ne(a):0;var l=r.length;return a<0&&(a=Ze(l+a,0)),Gn(r)?a<=l&&r.indexOf(s,a)>-1:!!l&&xi(r,s,a)>-1}var Eb=ae(function(r,s,a){var u=-1,l=typeof s=="function",d=vt(r)?T(r.length):[];return Nr(r,function(_){d[++u]=l?xt(s,_,a):gs(_,s,a)}),d}),xb=Dn(function(r,s,a){ur(r,a,s)});function Hn(r,s){var a=ie(r)?Ce:Kl;return a(r,Y(s,3))}function Ib(r,s,a,u){return r==null?[]:(ie(s)||(s=s==null?[]:[s]),a=u?t:a,ie(a)||(a=a==null?[]:[a]),Yl(r,s,a))}var Sb=Dn(function(r,s,a){r[a?0:1].push(s)},function(){return[[],[]]});function Pb(r,s,a){var u=ie(r)?Ea:wl,l=arguments.length<3;return u(r,Y(s,4),a,l,Nr)}function Rb(r,s,a){var u=ie(r)?Uv:wl,l=arguments.length<3;return u(r,Y(s,4),a,l,Ul)}function Ob(r,s){var a=ie(r)?Or:zl;return a(r,kn(Y(s,3)))}function Tb(r){var s=ie(r)?Fl:b0;return s(r)}function Ab(r,s,a){(a?ft(r,s,a):s===t)?s=1:s=ne(s);var u=ie(r)?Q_:E0;return u(r,s)}function Cb(r){var s=ie(r)?Z_:I0;return s(r)}function Nb(r){if(r==null)return 0;if(vt(r))return Gn(r)?Si(r):r.length;var s=ut(r);return s==we||s==Bt?r.size:$a(r).length}function Db(r,s,a){var u=ie(r)?xa:S0;return a&&ft(r,s,a)&&(s=t),u(r,Y(s,3))}var Lb=ae(function(r,s){if(r==null)return[];var a=s.length;return a>1&&ft(r,s[0],s[1])?s=[]:a>2&&ft(s[0],s[1],s[2])&&(s=[s[0]]),Yl(r,nt(s,1),[])}),Bn=d_||function(){return st.Date.now()};function Fb(r,s){if(typeof s!="function")throw new Ft(h);return r=ne(r),function(){if(--r<1)return s.apply(this,arguments)}}function kf(r,s,a){return s=a?t:s,s=r&&s==null?r.length:s,hr(r,A,t,t,t,t,s)}function Kf(r,s){var a;if(typeof s!="function")throw new Ft(h);return r=ne(r),function(){return--r>0&&(a=s.apply(this,arguments)),r<=1&&(s=t),a}}var lc=ae(function(r,s,a){var u=q;if(a.length){var l=Ar(a,Di(lc));u|=ee}return hr(r,u,s,a,l)}),Gf=ae(function(r,s,a){var u=q|V;if(a.length){var l=Ar(a,Di(Gf));u|=ee}return hr(s,u,r,a,l)});function Wf(r,s,a){s=a?t:s;var u=hr(r,H,t,t,t,t,t,s);return u.placeholder=Wf.placeholder,u}function Jf(r,s,a){s=a?t:s;var u=hr(r,z,t,t,t,t,t,s);return u.placeholder=Jf.placeholder,u}function Yf(r,s,a){var u,l,d,_,b,I,L=0,F=!1,M=!1,B=!0;if(typeof r!="function")throw new Ft(h);s=zt(s)||0,Fe(a)&&(F=!!a.leading,M="maxWait"in a,d=M?Ze(zt(a.maxWait)||0,s):d,B="trailing"in a?!!a.trailing:B);function G(He){var Gt=u,gr=l;return u=l=t,L=He,_=r.apply(gr,Gt),_}function Q(He){return L=He,b=ws(ce,s),F?G(He):_}function oe(He){var Gt=He-I,gr=He-L,gp=s-Gt;return M?ct(gp,d-gr):gp}function Z(He){var Gt=He-I,gr=He-L;return I===t||Gt>=s||Gt<0||M&&gr>=d}function ce(){var He=Bn();if(Z(He))return he(He);b=ws(ce,oe(He))}function he(He){return b=t,B&&u?G(He):(u=l=t,_)}function Rt(){b!==t&&of(b),L=0,u=I=l=b=t}function pt(){return b===t?_:he(Bn())}function Ot(){var He=Bn(),Gt=Z(He);if(u=arguments,l=this,I=He,Gt){if(b===t)return Q(I);if(M)return of(b),b=ws(ce,s),G(I)}return b===t&&(b=ws(ce,s)),_}return Ot.cancel=Rt,Ot.flush=pt,Ot}var jb=ae(function(r,s){return Ml(r,1,s)}),qb=ae(function(r,s,a){return Ml(r,zt(s)||0,a)});function Mb(r){return hr(r,re)}function Vn(r,s){if(typeof r!="function"||s!=null&&typeof s!="function")throw new Ft(h);var a=function(){var u=arguments,l=s?s.apply(this,u):u[0],d=a.cache;if(d.has(l))return d.get(l);var _=r.apply(this,u);return a.cache=d.set(l,_)||d,_};return a.cache=new(Vn.Cache||cr),a}Vn.Cache=cr;function kn(r){if(typeof r!="function")throw new Ft(h);return function(){var s=arguments;switch(s.length){case 0:return!r.call(this);case 1:return!r.call(this,s[0]);case 2:return!r.call(this,s[0],s[1]);case 3:return!r.call(this,s[0],s[1],s[2])}return!r.apply(this,s)}}function Ub(r){return Kf(2,r)}var zb=P0(function(r,s){s=s.length==1&&ie(s[0])?Ce(s[0],It(Y())):Ce(nt(s,1),It(Y()));var a=s.length;return ae(function(u){for(var l=-1,d=ct(u.length,a);++l<d;)u[l]=s[l].call(this,u[l]);return xt(r,this,u)})}),fc=ae(function(r,s){var a=Ar(s,Di(fc));return hr(r,ee,t,s,a)}),Xf=ae(function(r,s){var a=Ar(s,Di(Xf));return hr(r,se,t,s,a)}),$b=lr(function(r,s){return hr(r,N,t,t,t,s)});function Hb(r,s){if(typeof r!="function")throw new Ft(h);return s=s===t?s:ne(s),ae(r,s)}function Bb(r,s){if(typeof r!="function")throw new Ft(h);return s=s==null?0:Ze(ne(s),0),ae(function(a){var u=a[s],l=Fr(a,0,s);return u&&Tr(l,u),xt(r,this,l)})}function Vb(r,s,a){var u=!0,l=!0;if(typeof r!="function")throw new Ft(h);return Fe(a)&&(u="leading"in a?!!a.leading:u,l="trailing"in a?!!a.trailing:l),Yf(r,s,{leading:u,maxWait:s,trailing:l})}function kb(r){return kf(r,1)}function Kb(r,s){return fc(Ya(s),r)}function Gb(){if(!arguments.length)return[];var r=arguments[0];return ie(r)?r:[r]}function Wb(r){return qt(r,S)}function Jb(r,s){return s=typeof s=="function"?s:t,qt(r,S,s)}function Yb(r){return qt(r,w|S)}function Xb(r,s){return s=typeof s=="function"?s:t,qt(r,w|S,s)}function Qb(r,s){return s==null||ql(r,s,rt(s))}function Kt(r,s){return r===s||r!==r&&s!==s}var Zb=qn(Ma),e1=qn(function(r,s){return r>=s}),oi=Bl(function(){return arguments}())?Bl:function(r){return qe(r)&&ve.call(r,"callee")&&!Tl.call(r,"callee")},ie=T.isArray,t1=hl?It(hl):u0;function vt(r){return r!=null&&Kn(r.length)&&!pr(r)}function $e(r){return qe(r)&&vt(r)}function r1(r){return r===!0||r===!1||qe(r)&&lt(r)==xe}var jr=y_||xc,i1=ll?It(ll):h0;function s1(r){return qe(r)&&r.nodeType===1&&!bs(r)}function n1(r){if(r==null)return!0;if(vt(r)&&(ie(r)||typeof r=="string"||typeof r.splice=="function"||jr(r)||Li(r)||oi(r)))return!r.length;var s=ut(r);if(s==we||s==Bt)return!r.size;if(_s(r))return!$a(r).length;for(var a in r)if(ve.call(r,a))return!1;return!0}function o1(r,s){return ys(r,s)}function a1(r,s,a){a=typeof a=="function"?a:t;var u=a?a(r,s):t;return u===t?ys(r,s,t,a):!!u}function pc(r){if(!qe(r))return!1;var s=lt(r);return s==Le||s==We||typeof r.message=="string"&&typeof r.name=="string"&&!bs(r)}function c1(r){return typeof r=="number"&&Cl(r)}function pr(r){if(!Fe(r))return!1;var s=lt(r);return s==Ae||s==Xe||s==Ge||s==Nm}function Qf(r){return typeof r=="number"&&r==ne(r)}function Kn(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=tt}function Fe(r){var s=typeof r;return r!=null&&(s=="object"||s=="function")}function qe(r){return r!=null&&typeof r=="object"}var Zf=fl?It(fl):f0;function u1(r,s){return r===s||za(r,s,ic(s))}function h1(r,s,a){return a=typeof a=="function"?a:t,za(r,s,ic(s),a)}function l1(r){return ep(r)&&r!=+r}function f1(r){if(J0(r))throw new te(c);return Vl(r)}function p1(r){return r===null}function d1(r){return r==null}function ep(r){return typeof r=="number"||qe(r)&&lt(r)==je}function bs(r){if(!qe(r)||lt(r)!=or)return!1;var s=_n(r);if(s===null)return!0;var a=ve.call(s,"constructor")&&s.constructor;return typeof a=="function"&&a instanceof a&&gn.call(a)==h_}var dc=pl?It(pl):p0;function g1(r){return Qf(r)&&r>=-tt&&r<=tt}var tp=dl?It(dl):d0;function Gn(r){return typeof r=="string"||!ie(r)&&qe(r)&&lt(r)==ss}function Pt(r){return typeof r=="symbol"||qe(r)&&lt(r)==on}var Li=gl?It(gl):g0;function y1(r){return r===t}function m1(r){return qe(r)&&ut(r)==ns}function v1(r){return qe(r)&&lt(r)==Lm}var _1=qn(Ha),w1=qn(function(r,s){return r<=s});function rp(r){if(!r)return[];if(vt(r))return Gn(r)?Vt(r):mt(r);if(cs&&r[cs])return Qv(r[cs]());var s=ut(r),a=s==we?Ta:s==Bt?fn:Fi;return a(r)}function dr(r){if(!r)return r===0?r:0;if(r=zt(r),r===Ve||r===-Ve){var s=r<0?-1:1;return s*wi}return r===r?r:0}function ne(r){var s=dr(r),a=s%1;return s===s?a?s-a:s:0}function ip(r){return r?ri(ne(r),0,me):0}function zt(r){if(typeof r=="number")return r;if(Pt(r))return Se;if(Fe(r)){var s=typeof r.valueOf=="function"?r.valueOf():r;r=Fe(s)?s+"":s}if(typeof r!="string")return r===0?r:+r;r=bl(r);var a=tv.test(r);return a||iv.test(r)?Fv(r.slice(2),a?2:8):ev.test(r)?Se:+r}function sp(r){return Yt(r,_t(r))}function b1(r){return r?ri(ne(r),-tt,tt):r===0?r:0}function ge(r){return r==null?"":St(r)}var E1=Ci(function(r,s){if(_s(s)||vt(s)){Yt(s,rt(s),r);return}for(var a in s)ve.call(s,a)&&ps(r,a,s[a])}),np=Ci(function(r,s){Yt(s,_t(s),r)}),Wn=Ci(function(r,s,a,u){Yt(s,_t(s),r,u)}),x1=Ci(function(r,s,a,u){Yt(s,rt(s),r,u)}),I1=lr(Fa);function S1(r,s){var a=Ai(r);return s==null?a:jl(a,s)}var P1=ae(function(r,s){r=Ee(r);var a=-1,u=s.length,l=u>2?s[2]:t;for(l&&ft(s[0],s[1],l)&&(u=1);++a<u;)for(var d=s[a],_=_t(d),b=-1,I=_.length;++b<I;){var L=_[b],F=r[L];(F===t||Kt(F,Ri[L])&&!ve.call(r,L))&&(r[L]=d[L])}return r}),R1=ae(function(r){return r.push(t,Ef),xt(op,t,r)});function O1(r,s){return ml(r,Y(s,3),Jt)}function T1(r,s){return ml(r,Y(s,3),qa)}function A1(r,s){return r==null?r:ja(r,Y(s,3),_t)}function C1(r,s){return r==null?r:$l(r,Y(s,3),_t)}function N1(r,s){return r&&Jt(r,Y(s,3))}function D1(r,s){return r&&qa(r,Y(s,3))}function L1(r){return r==null?[]:Tn(r,rt(r))}function F1(r){return r==null?[]:Tn(r,_t(r))}function gc(r,s,a){var u=r==null?t:ii(r,s);return u===t?a:u}function j1(r,s){return r!=null&&Sf(r,s,n0)}function yc(r,s){return r!=null&&Sf(r,s,o0)}var q1=mf(function(r,s,a){s!=null&&typeof s.toString!="function"&&(s=yn.call(s)),r[s]=a},vc(wt)),M1=mf(function(r,s,a){s!=null&&typeof s.toString!="function"&&(s=yn.call(s)),ve.call(r,s)?r[s].push(a):r[s]=[a]},Y),U1=ae(gs);function rt(r){return vt(r)?Ll(r):$a(r)}function _t(r){return vt(r)?Ll(r,!0):y0(r)}function z1(r,s){var a={};return s=Y(s,3),Jt(r,function(u,l,d){ur(a,s(u,l,d),u)}),a}function $1(r,s){var a={};return s=Y(s,3),Jt(r,function(u,l,d){ur(a,l,s(u,l,d))}),a}var H1=Ci(function(r,s,a){An(r,s,a)}),op=Ci(function(r,s,a,u){An(r,s,a,u)}),B1=lr(function(r,s){var a={};if(r==null)return a;var u=!1;s=Ce(s,function(d){return d=Lr(d,r),u||(u=d.length>1),d}),Yt(r,tc(r),a),u&&(a=qt(a,w|E|S,q0));for(var l=s.length;l--;)Ga(a,s[l]);return a});function V1(r,s){return ap(r,kn(Y(s)))}var k1=lr(function(r,s){return r==null?{}:v0(r,s)});function ap(r,s){if(r==null)return{};var a=Ce(tc(r),function(u){return[u]});return s=Y(s),Xl(r,a,function(u,l){return s(u,l[0])})}function K1(r,s,a){s=Lr(s,r);var u=-1,l=s.length;for(l||(l=1,r=t);++u<l;){var d=r==null?t:r[Xt(s[u])];d===t&&(u=l,d=a),r=pr(d)?d.call(r):d}return r}function G1(r,s,a){return r==null?r:ms(r,s,a)}function W1(r,s,a,u){return u=typeof u=="function"?u:t,r==null?r:ms(r,s,a,u)}var cp=wf(rt),up=wf(_t);function J1(r,s,a){var u=ie(r),l=u||jr(r)||Li(r);if(s=Y(s,4),a==null){var d=r&&r.constructor;l?a=u?new d:[]:Fe(r)?a=pr(d)?Ai(_n(r)):{}:a={}}return(l?Lt:Jt)(r,function(_,b,I){return s(a,_,b,I)}),a}function Y1(r,s){return r==null?!0:Ga(r,s)}function X1(r,s,a){return r==null?r:rf(r,s,Ya(a))}function Q1(r,s,a,u){return u=typeof u=="function"?u:t,r==null?r:rf(r,s,Ya(a),u)}function Fi(r){return r==null?[]:Oa(r,rt(r))}function Z1(r){return r==null?[]:Oa(r,_t(r))}function eE(r,s,a){return a===t&&(a=s,s=t),a!==t&&(a=zt(a),a=a===a?a:0),s!==t&&(s=zt(s),s=s===s?s:0),ri(zt(r),s,a)}function tE(r,s,a){return s=dr(s),a===t?(a=s,s=0):a=dr(a),r=zt(r),a0(r,s,a)}function rE(r,s,a){if(a&&typeof a!="boolean"&&ft(r,s,a)&&(s=a=t),a===t&&(typeof s=="boolean"?(a=s,s=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&s===t?(r=0,s=1):(r=dr(r),s===t?(s=r,r=0):s=dr(s)),r>s){var u=r;r=s,s=u}if(a||r%1||s%1){var l=Nl();return ct(r+l*(s-r+Lv("1e-"+((l+"").length-1))),s)}return Va(r,s)}var iE=Ni(function(r,s,a){return s=s.toLowerCase(),r+(a?hp(s):s)});function hp(r){return mc(ge(r).toLowerCase())}function lp(r){return r=ge(r),r&&r.replace(nv,Gv).replace(Iv,"")}function sE(r,s,a){r=ge(r),s=St(s);var u=r.length;a=a===t?u:ri(ne(a),0,u);var l=a;return a-=s.length,a>=0&&r.slice(a,l)==s}function nE(r){return r=ge(r),r&&Um.test(r)?r.replace($h,Wv):r}function oE(r){return r=ge(r),r&&km.test(r)?r.replace(fa,"\\$&"):r}var aE=Ni(function(r,s,a){return r+(a?"-":"")+s.toLowerCase()}),cE=Ni(function(r,s,a){return r+(a?" ":"")+s.toLowerCase()}),uE=df("toLowerCase");function hE(r,s,a){r=ge(r),s=ne(s);var u=s?Si(r):0;if(!s||u>=s)return r;var l=(s-u)/2;return jn(xn(l),a)+r+jn(En(l),a)}function lE(r,s,a){r=ge(r),s=ne(s);var u=s?Si(r):0;return s&&u<s?r+jn(s-u,a):r}function fE(r,s,a){r=ge(r),s=ne(s);var u=s?Si(r):0;return s&&u<s?jn(s-u,a)+r:r}function pE(r,s,a){return a||s==null?s=0:s&&(s=+s),w_(ge(r).replace(pa,""),s||0)}function dE(r,s,a){return(a?ft(r,s,a):s===t)?s=1:s=ne(s),ka(ge(r),s)}function gE(){var r=arguments,s=ge(r[0]);return r.length<3?s:s.replace(r[1],r[2])}var yE=Ni(function(r,s,a){return r+(a?"_":"")+s.toLowerCase()});function mE(r,s,a){return a&&typeof a!="number"&&ft(r,s,a)&&(s=a=t),a=a===t?me:a>>>0,a?(r=ge(r),r&&(typeof s=="string"||s!=null&&!dc(s))&&(s=St(s),!s&&Ii(r))?Fr(Vt(r),0,a):r.split(s,a)):[]}var vE=Ni(function(r,s,a){return r+(a?" ":"")+mc(s)});function _E(r,s,a){return r=ge(r),a=a==null?0:ri(ne(a),0,r.length),s=St(s),r.slice(a,a+s.length)==s}function wE(r,s,a){var u=p.templateSettings;a&&ft(r,s,a)&&(s=t),r=ge(r),s=Wn({},s,u,bf);var l=Wn({},s.imports,u.imports,bf),d=rt(l),_=Oa(l,d),b,I,L=0,F=s.interpolate||an,M="__p += '",B=Aa((s.escape||an).source+"|"+F.source+"|"+(F===Hh?Zm:an).source+"|"+(s.evaluate||an).source+"|$","g"),G="//# sourceURL="+(ve.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Tv+"]")+`
`;r.replace(B,function(Z,ce,he,Rt,pt,Ot){return he||(he=Rt),M+=r.slice(L,Ot).replace(ov,Jv),ce&&(b=!0,M+=`' +
__e(`+ce+`) +
'`),pt&&(I=!0,M+=`';
`+pt+`;
__p += '`),he&&(M+=`' +
((__t = (`+he+`)) == null ? '' : __t) +
'`),L=Ot+Z.length,Z}),M+=`';
`;var Q=ve.call(s,"variable")&&s.variable;if(!Q)M=`with (obj) {
`+M+`
}
`;else if(Xm.test(Q))throw new te(f);M=(I?M.replace(Fm,""):M).replace(jm,"$1").replace(qm,"$1;"),M="function("+(Q||"obj")+`) {
`+(Q?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(b?", __e = _.escape":"")+(I?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+M+`return __p
}`;var oe=pp(function(){return de(d,G+"return "+M).apply(t,_)});if(oe.source=M,pc(oe))throw oe;return oe}function bE(r){return ge(r).toLowerCase()}function EE(r){return ge(r).toUpperCase()}function xE(r,s,a){if(r=ge(r),r&&(a||s===t))return bl(r);if(!r||!(s=St(s)))return r;var u=Vt(r),l=Vt(s),d=El(u,l),_=xl(u,l)+1;return Fr(u,d,_).join("")}function IE(r,s,a){if(r=ge(r),r&&(a||s===t))return r.slice(0,Sl(r)+1);if(!r||!(s=St(s)))return r;var u=Vt(r),l=xl(u,Vt(s))+1;return Fr(u,0,l).join("")}function SE(r,s,a){if(r=ge(r),r&&(a||s===t))return r.replace(pa,"");if(!r||!(s=St(s)))return r;var u=Vt(r),l=El(u,Vt(s));return Fr(u,l).join("")}function PE(r,s){var a=P,u=O;if(Fe(s)){var l="separator"in s?s.separator:l;a="length"in s?ne(s.length):a,u="omission"in s?St(s.omission):u}r=ge(r);var d=r.length;if(Ii(r)){var _=Vt(r);d=_.length}if(a>=d)return r;var b=a-Si(u);if(b<1)return u;var I=_?Fr(_,0,b).join(""):r.slice(0,b);if(l===t)return I+u;if(_&&(b+=I.length-b),dc(l)){if(r.slice(b).search(l)){var L,F=I;for(l.global||(l=Aa(l.source,ge(Bh.exec(l))+"g")),l.lastIndex=0;L=l.exec(F);)var M=L.index;I=I.slice(0,M===t?b:M)}}else if(r.indexOf(St(l),b)!=b){var B=I.lastIndexOf(l);B>-1&&(I=I.slice(0,B))}return I+u}function RE(r){return r=ge(r),r&&Mm.test(r)?r.replace(zh,r_):r}var OE=Ni(function(r,s,a){return r+(a?" ":"")+s.toUpperCase()}),mc=df("toUpperCase");function fp(r,s,a){return r=ge(r),s=a?t:s,s===t?Xv(r)?n_(r):Hv(r):r.match(s)||[]}var pp=ae(function(r,s){try{return xt(r,t,s)}catch(a){return pc(a)?a:new te(a)}}),TE=lr(function(r,s){return Lt(s,function(a){a=Xt(a),ur(r,a,lc(r[a],r))}),r});function AE(r){var s=r==null?0:r.length,a=Y();return r=s?Ce(r,function(u){if(typeof u[1]!="function")throw new Ft(h);return[a(u[0]),u[1]]}):[],ae(function(u){for(var l=-1;++l<s;){var d=r[l];if(xt(d[0],this,u))return xt(d[1],this,u)}})}function CE(r){return r0(qt(r,w))}function vc(r){return function(){return r}}function NE(r,s){return r==null||r!==r?s:r}var DE=yf(),LE=yf(!0);function wt(r){return r}function _c(r){return kl(typeof r=="function"?r:qt(r,w))}function FE(r){return Gl(qt(r,w))}function jE(r,s){return Wl(r,qt(s,w))}var qE=ae(function(r,s){return function(a){return gs(a,r,s)}}),ME=ae(function(r,s){return function(a){return gs(r,a,s)}});function wc(r,s,a){var u=rt(s),l=Tn(s,u);a==null&&!(Fe(s)&&(l.length||!u.length))&&(a=s,s=r,r=this,l=Tn(s,rt(s)));var d=!(Fe(a)&&"chain"in a)||!!a.chain,_=pr(r);return Lt(l,function(b){var I=s[b];r[b]=I,_&&(r.prototype[b]=function(){var L=this.__chain__;if(d||L){var F=r(this.__wrapped__),M=F.__actions__=mt(this.__actions__);return M.push({func:I,args:arguments,thisArg:r}),F.__chain__=L,F}return I.apply(r,Tr([this.value()],arguments))})}),r}function UE(){return st._===this&&(st._=l_),this}function bc(){}function zE(r){return r=ne(r),ae(function(s){return Jl(s,r)})}var $E=Qa(Ce),HE=Qa(yl),BE=Qa(xa);function dp(r){return nc(r)?Ia(Xt(r)):_0(r)}function VE(r){return function(s){return r==null?t:ii(r,s)}}var kE=vf(),KE=vf(!0);function Ec(){return[]}function xc(){return!1}function GE(){return{}}function WE(){return""}function JE(){return!0}function YE(r,s){if(r=ne(r),r<1||r>tt)return[];var a=me,u=ct(r,me);s=Y(s),r-=me;for(var l=Ra(u,s);++a<r;)s(a);return l}function XE(r){return ie(r)?Ce(r,Xt):Pt(r)?[r]:mt(Lf(ge(r)))}function QE(r){var s=++u_;return ge(r)+s}var ZE=Fn(function(r,s){return r+s},0),ex=Za("ceil"),tx=Fn(function(r,s){return r/s},1),rx=Za("floor");function ix(r){return r&&r.length?On(r,wt,Ma):t}function sx(r,s){return r&&r.length?On(r,Y(s,2),Ma):t}function nx(r){return _l(r,wt)}function ox(r,s){return _l(r,Y(s,2))}function ax(r){return r&&r.length?On(r,wt,Ha):t}function cx(r,s){return r&&r.length?On(r,Y(s,2),Ha):t}var ux=Fn(function(r,s){return r*s},1),hx=Za("round"),lx=Fn(function(r,s){return r-s},0);function fx(r){return r&&r.length?Pa(r,wt):0}function px(r,s){return r&&r.length?Pa(r,Y(s,2)):0}return p.after=Fb,p.ary=kf,p.assign=E1,p.assignIn=np,p.assignInWith=Wn,p.assignWith=x1,p.at=I1,p.before=Kf,p.bind=lc,p.bindAll=TE,p.bindKey=Gf,p.castArray=Gb,p.chain=Hf,p.chunk=rw,p.compact=iw,p.concat=sw,p.cond=AE,p.conforms=CE,p.constant=vc,p.countBy=fb,p.create=S1,p.curry=Wf,p.curryRight=Jf,p.debounce=Yf,p.defaults=P1,p.defaultsDeep=R1,p.defer=jb,p.delay=qb,p.difference=nw,p.differenceBy=ow,p.differenceWith=aw,p.drop=cw,p.dropRight=uw,p.dropRightWhile=hw,p.dropWhile=lw,p.fill=fw,p.filter=db,p.flatMap=mb,p.flatMapDeep=vb,p.flatMapDepth=_b,p.flatten=Mf,p.flattenDeep=pw,p.flattenDepth=dw,p.flip=Mb,p.flow=DE,p.flowRight=LE,p.fromPairs=gw,p.functions=L1,p.functionsIn=F1,p.groupBy=wb,p.initial=mw,p.intersection=vw,p.intersectionBy=_w,p.intersectionWith=ww,p.invert=q1,p.invertBy=M1,p.invokeMap=Eb,p.iteratee=_c,p.keyBy=xb,p.keys=rt,p.keysIn=_t,p.map=Hn,p.mapKeys=z1,p.mapValues=$1,p.matches=FE,p.matchesProperty=jE,p.memoize=Vn,p.merge=H1,p.mergeWith=op,p.method=qE,p.methodOf=ME,p.mixin=wc,p.negate=kn,p.nthArg=zE,p.omit=B1,p.omitBy=V1,p.once=Ub,p.orderBy=Ib,p.over=$E,p.overArgs=zb,p.overEvery=HE,p.overSome=BE,p.partial=fc,p.partialRight=Xf,p.partition=Sb,p.pick=k1,p.pickBy=ap,p.property=dp,p.propertyOf=VE,p.pull=Iw,p.pullAll=zf,p.pullAllBy=Sw,p.pullAllWith=Pw,p.pullAt=Rw,p.range=kE,p.rangeRight=KE,p.rearg=$b,p.reject=Ob,p.remove=Ow,p.rest=Hb,p.reverse=uc,p.sampleSize=Ab,p.set=G1,p.setWith=W1,p.shuffle=Cb,p.slice=Tw,p.sortBy=Lb,p.sortedUniq=jw,p.sortedUniqBy=qw,p.split=mE,p.spread=Bb,p.tail=Mw,p.take=Uw,p.takeRight=zw,p.takeRightWhile=$w,p.takeWhile=Hw,p.tap=ib,p.throttle=Vb,p.thru=$n,p.toArray=rp,p.toPairs=cp,p.toPairsIn=up,p.toPath=XE,p.toPlainObject=sp,p.transform=J1,p.unary=kb,p.union=Bw,p.unionBy=Vw,p.unionWith=kw,p.uniq=Kw,p.uniqBy=Gw,p.uniqWith=Ww,p.unset=Y1,p.unzip=hc,p.unzipWith=$f,p.update=X1,p.updateWith=Q1,p.values=Fi,p.valuesIn=Z1,p.without=Jw,p.words=fp,p.wrap=Kb,p.xor=Yw,p.xorBy=Xw,p.xorWith=Qw,p.zip=Zw,p.zipObject=eb,p.zipObjectDeep=tb,p.zipWith=rb,p.entries=cp,p.entriesIn=up,p.extend=np,p.extendWith=Wn,wc(p,p),p.add=ZE,p.attempt=pp,p.camelCase=iE,p.capitalize=hp,p.ceil=ex,p.clamp=eE,p.clone=Wb,p.cloneDeep=Yb,p.cloneDeepWith=Xb,p.cloneWith=Jb,p.conformsTo=Qb,p.deburr=lp,p.defaultTo=NE,p.divide=tx,p.endsWith=sE,p.eq=Kt,p.escape=nE,p.escapeRegExp=oE,p.every=pb,p.find=gb,p.findIndex=jf,p.findKey=O1,p.findLast=yb,p.findLastIndex=qf,p.findLastKey=T1,p.floor=rx,p.forEach=Bf,p.forEachRight=Vf,p.forIn=A1,p.forInRight=C1,p.forOwn=N1,p.forOwnRight=D1,p.get=gc,p.gt=Zb,p.gte=e1,p.has=j1,p.hasIn=yc,p.head=Uf,p.identity=wt,p.includes=bb,p.indexOf=yw,p.inRange=tE,p.invoke=U1,p.isArguments=oi,p.isArray=ie,p.isArrayBuffer=t1,p.isArrayLike=vt,p.isArrayLikeObject=$e,p.isBoolean=r1,p.isBuffer=jr,p.isDate=i1,p.isElement=s1,p.isEmpty=n1,p.isEqual=o1,p.isEqualWith=a1,p.isError=pc,p.isFinite=c1,p.isFunction=pr,p.isInteger=Qf,p.isLength=Kn,p.isMap=Zf,p.isMatch=u1,p.isMatchWith=h1,p.isNaN=l1,p.isNative=f1,p.isNil=d1,p.isNull=p1,p.isNumber=ep,p.isObject=Fe,p.isObjectLike=qe,p.isPlainObject=bs,p.isRegExp=dc,p.isSafeInteger=g1,p.isSet=tp,p.isString=Gn,p.isSymbol=Pt,p.isTypedArray=Li,p.isUndefined=y1,p.isWeakMap=m1,p.isWeakSet=v1,p.join=bw,p.kebabCase=aE,p.last=Ut,p.lastIndexOf=Ew,p.lowerCase=cE,p.lowerFirst=uE,p.lt=_1,p.lte=w1,p.max=ix,p.maxBy=sx,p.mean=nx,p.meanBy=ox,p.min=ax,p.minBy=cx,p.stubArray=Ec,p.stubFalse=xc,p.stubObject=GE,p.stubString=WE,p.stubTrue=JE,p.multiply=ux,p.nth=xw,p.noConflict=UE,p.noop=bc,p.now=Bn,p.pad=hE,p.padEnd=lE,p.padStart=fE,p.parseInt=pE,p.random=rE,p.reduce=Pb,p.reduceRight=Rb,p.repeat=dE,p.replace=gE,p.result=K1,p.round=hx,p.runInContext=x,p.sample=Tb,p.size=Nb,p.snakeCase=yE,p.some=Db,p.sortedIndex=Aw,p.sortedIndexBy=Cw,p.sortedIndexOf=Nw,p.sortedLastIndex=Dw,p.sortedLastIndexBy=Lw,p.sortedLastIndexOf=Fw,p.startCase=vE,p.startsWith=_E,p.subtract=lx,p.sum=fx,p.sumBy=px,p.template=wE,p.times=YE,p.toFinite=dr,p.toInteger=ne,p.toLength=ip,p.toLower=bE,p.toNumber=zt,p.toSafeInteger=b1,p.toString=ge,p.toUpper=EE,p.trim=xE,p.trimEnd=IE,p.trimStart=SE,p.truncate=PE,p.unescape=RE,p.uniqueId=QE,p.upperCase=OE,p.upperFirst=mc,p.each=Bf,p.eachRight=Vf,p.first=Uf,wc(p,function(){var r={};return Jt(p,function(s,a){ve.call(p.prototype,a)||(r[a]=s)}),r}(),{chain:!1}),p.VERSION=i,Lt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){p[r].placeholder=p}),Lt(["drop","take"],function(r,s){ue.prototype[r]=function(a){a=a===t?1:Ze(ne(a),0);var u=this.__filtered__&&!s?new ue(this):this.clone();return u.__filtered__?u.__takeCount__=ct(a,u.__takeCount__):u.__views__.push({size:ct(a,me),type:r+(u.__dir__<0?"Right":"")}),u},ue.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Lt(["filter","map","takeWhile"],function(r,s){var a=s+1,u=a==$||a==_e;ue.prototype[r]=function(l){var d=this.clone();return d.__iteratees__.push({iteratee:Y(l,3),type:a}),d.__filtered__=d.__filtered__||u,d}}),Lt(["head","last"],function(r,s){var a="take"+(s?"Right":"");ue.prototype[r]=function(){return this[a](1).value()[0]}}),Lt(["initial","tail"],function(r,s){var a="drop"+(s?"":"Right");ue.prototype[r]=function(){return this.__filtered__?new ue(this):this[a](1)}}),ue.prototype.compact=function(){return this.filter(wt)},ue.prototype.find=function(r){return this.filter(r).head()},ue.prototype.findLast=function(r){return this.reverse().find(r)},ue.prototype.invokeMap=ae(function(r,s){return typeof r=="function"?new ue(this):this.map(function(a){return gs(a,r,s)})}),ue.prototype.reject=function(r){return this.filter(kn(Y(r)))},ue.prototype.slice=function(r,s){r=ne(r);var a=this;return a.__filtered__&&(r>0||s<0)?new ue(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),s!==t&&(s=ne(s),a=s<0?a.dropRight(-s):a.take(s-r)),a)},ue.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},ue.prototype.toArray=function(){return this.take(me)},Jt(ue.prototype,function(r,s){var a=/^(?:filter|find|map|reject)|While$/.test(s),u=/^(?:head|last)$/.test(s),l=p[u?"take"+(s=="last"?"Right":""):s],d=u||/^find/.test(s);l&&(p.prototype[s]=function(){var _=this.__wrapped__,b=u?[1]:arguments,I=_ instanceof ue,L=b[0],F=I||ie(_),M=function(ce){var he=l.apply(p,Tr([ce],b));return u&&B?he[0]:he};F&&a&&typeof L=="function"&&L.length!=1&&(I=F=!1);var B=this.__chain__,G=!!this.__actions__.length,Q=d&&!B,oe=I&&!G;if(!d&&F){_=oe?_:new ue(this);var Z=r.apply(_,b);return Z.__actions__.push({func:$n,args:[M],thisArg:t}),new jt(Z,B)}return Q&&oe?r.apply(this,b):(Z=this.thru(M),Q?u?Z.value()[0]:Z.value():Z)})}),Lt(["pop","push","shift","sort","splice","unshift"],function(r){var s=pn[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",u=/^(?:pop|shift)$/.test(r);p.prototype[r]=function(){var l=arguments;if(u&&!this.__chain__){var d=this.value();return s.apply(ie(d)?d:[],l)}return this[a](function(_){return s.apply(ie(_)?_:[],l)})}}),Jt(ue.prototype,function(r,s){var a=p[s];if(a){var u=a.name+"";ve.call(Ti,u)||(Ti[u]=[]),Ti[u].push({name:s,func:a})}}),Ti[Ln(t,V).name]=[{name:"wrapper",func:t}],ue.prototype.clone=R_,ue.prototype.reverse=O_,ue.prototype.value=T_,p.prototype.at=sb,p.prototype.chain=nb,p.prototype.commit=ob,p.prototype.next=ab,p.prototype.plant=ub,p.prototype.reverse=hb,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=lb,p.prototype.first=p.prototype.head,cs&&(p.prototype[cs]=cb),p},Pi=o_();Qr?((Qr.exports=Pi)._=Pi,_a._=Pi):st._=Pi}).call(sn)})(Sh,Sh.exports);var $6=Object.defineProperty,H6=Object.defineProperties,B6=Object.getOwnPropertyDescriptors,vm=Object.getOwnPropertySymbols,V6=Object.prototype.hasOwnProperty,k6=Object.prototype.propertyIsEnumerable,_m=(n,e,t)=>e in n?$6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Zo=(n,e)=>{for(var t in e||(e={}))V6.call(e,t)&&_m(n,t,e[t]);if(vm)for(var t of vm(e))k6.call(e,t)&&_m(n,t,e[t]);return n},K6=(n,e)=>H6(n,B6(e));function Xr(n,e,t){var i;let o=_p(n);return((i=e.rpcMap)==null?void 0:i[o.reference])||`${z6}?chainId=${o.namespace}:${o.reference}&projectId=${t}`}function _i(n){return n.includes(":")?n.split(":")[1]:n}function Im(n){return n.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function G6(n,e){let t=Object.keys(e.namespaces).filter(o=>o.includes(n));if(!t.length)return[];let i=[];return t.forEach(o=>{let c=e.namespaces[o].accounts;i.push(...c)}),i}function W6(n={},e={}){let t=wm(n),i=wm(e);return Sh.exports.merge(t,i)}function wm(n){var e,t,i,o;let c={};if(!zi(n))return c;for(let[h,f]of Object.entries(n)){let v=Tc(h)?[h]:f.chains,y=f.methods||[],g=f.events||[],w=f.rpcMap||{},E=Ui(h);c[E]=K6(Zo(Zo({},c[E]),f),{chains:eo(v,(e=c[E])==null?void 0:e.chains),methods:eo(y,(t=c[E])==null?void 0:t.methods),events:eo(g,(i=c[E])==null?void 0:i.events),rpcMap:Zo(Zo({},w),(o=c[E])==null?void 0:o.rpcMap)})}return c}function J6(n){return n.includes(":")?n.split(":")[2]:n}function Y6(n){let e={};for(let[t,i]of Object.entries(n)){let o=i.methods||[],c=i.events||[],h=i.accounts||[],f=Tc(t)?[t]:i.chains?i.chains:Im(i.accounts);e[t]={chains:f,methods:o,events:c,accounts:h}}return e}function Eh(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}var Sm={},Ne=n=>Sm[n],xh=(n,e)=>{Sm[n]=e},Ph=class{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){let e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let o=_i(t);e[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||Xr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ct(new Yr(i,Ne("disableProviderPing")))}},Rh=class{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Ne("events"),this.client=Ne("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}request(e){return m(this,null,function*(){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return yield this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?yield this.client.request(e):this.getHttpProvider().request(e.request)})}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){let i=t||Xr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ct(new rn(i,Ne("disableProviderPing")))}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let o=parseInt(_i(t));e[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){let e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}handleSwitchChain(e){return m(this,null,function*(){var t,i;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;let c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))yield this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(i=this.namespace.chains)==null?void 0:i[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null})}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}},Oh=class{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let o=_i(t);e[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||Xr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ct(new Yr(i,Ne("disableProviderPing")))}},Th=class{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let o=_i(t);e[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||Xr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ct(new Yr(i,Ne("disableProviderPing")))}},Ah=class{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{let i=this.getCardanoRPCUrl(t),o=_i(t);e[o]=this.createHttpProvider(o,i)}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){let t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||this.getCardanoRPCUrl(e);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ct(new Yr(i,Ne("disableProviderPing")))}},Ch=class{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let o=_i(t);e[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||Xr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ct(new Yr(i,Ne("disableProviderPing")))}},Nh=class{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let o=_i(t);e[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||Xr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new Ct(new Yr(i,Ne("disableProviderPing")))}},Dh=class{constructor(e){this.name="near",this.namespace=e.namespace,this.events=Ne("events"),this.client=Ne("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){let i=t||Xr(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||Xr(e,this.namespace);return typeof i>"u"?void 0:new Ct(new Yr(i,Ne("disableProviderPing")))}},X6=Object.defineProperty,Q6=Object.defineProperties,Z6=Object.getOwnPropertyDescriptors,bm=Object.getOwnPropertySymbols,eT=Object.prototype.hasOwnProperty,tT=Object.prototype.propertyIsEnumerable,Em=(n,e,t)=>e in n?X6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ea=(n,e)=>{for(var t in e||(e={}))eT.call(e,t)&&Em(n,t,e[t]);if(bm)for(var t of bm(e))tT.call(e,t)&&Em(n,t,e[t]);return n},Ih=(n,e)=>Q6(n,Z6(e)),Lh=class n{constructor(e){this.events=new xm.default,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:(0,ta.pino)((0,ta.getDefaultLoggerOptions)({level:e?.logger||ym})),this.disableProviderPing=e?.disableProviderPing||!1}static init(e){return m(this,null,function*(){let t=new n(e);return yield t.initialize(),t})}request(e,t){return m(this,null,function*(){let[i,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return yield this.getProvider(i).request({request:ea({},e),chainId:`${i}:${o}`,topic:this.session.topic})})}sendAsync(e,t,i){let o=new Date().getTime();this.request(e,i).then(c=>t(null,Vr(o,c))).catch(c=>t(c,void 0))}enable(){return m(this,null,function*(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||(yield this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties})),yield this.requestAccounts()})}disconnect(){return m(this,null,function*(){var e;if(!this.session)throw new Error("Please call connect() before enable()");yield this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Ye("USER_DISCONNECTED")}),yield this.cleanup()})}connect(e){return m(this,null,function*(){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),yield this.cleanupPendingPairings(),!e.skipPairing)return yield this.pair(e.pairingTopic)})}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}pair(e){return m(this,null,function*(){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");let{uri:i,approval:o}=yield this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});i&&(this.uri=i,this.events.emit("display_uri",i)),yield o().then(c=>{this.session=c,this.namespaces||(this.namespaces=Y6(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==wh)throw c;t++})}while(!this.session);return this.onConnect(),this.session})}setDefaultChain(e,t){try{if(!this.session)return;let[i,o]=this.validateChain(e);this.getProvider(i).setDefaultChain(o,t)}catch(i){if(!/Please call connect/.test(i.message))throw i}}cleanupPendingPairings(){return m(this,arguments,function*(e={}){this.logger.info("Cleaning up inactive pairings...");let t=this.client.pairing.getAll();if(vr(t)){for(let i of t)e.deletePairings?this.client.core.expirer.set(i.topic,0):yield this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}})}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}checkStorage(){return m(this,null,function*(){if(this.namespaces=yield this.getFromStore("namespaces"),this.optionalNamespaces=(yield this.getFromStore("optionalNamespaces"))||{},this.client.session.length){let e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}})}initialize(){return m(this,null,function*(){this.logger.trace("Initialized"),yield this.createClient(),yield this.checkStorage(),this.registerEventListeners()})}createClient(){return m(this,null,function*(){this.client=this.providerOpts.client||(yield Yo.init({logger:this.providerOpts.logger||ym,relayUrl:this.providerOpts.relayUrl||q6,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name})),this.logger.trace("SignClient Initialized")})}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");let e=[...new Set(Object.keys(this.session.namespaces).map(t=>Ui(t)))];xh("client",this.client),xh("events",this.events),xh("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;let i=G6(t,this.session),o=Im(i),c=W6(this.namespaces,this.optionalNamespaces),h=Ih(ea({},c[t]),{accounts:i,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new Rh({namespace:h});break;case"solana":this.rpcProviders[t]=new Oh({namespace:h});break;case"cosmos":this.rpcProviders[t]=new Th({namespace:h});break;case"polkadot":this.rpcProviders[t]=new Ph({namespace:h});break;case"cip34":this.rpcProviders[t]=new Ah({namespace:h});break;case"elrond":this.rpcProviders[t]=new Ch({namespace:h});break;case"multiversx":this.rpcProviders[t]=new Nh({namespace:h});break;case"near":this.rpcProviders[t]=new Dh({namespace:h});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{let{params:t}=e,{event:i}=t;if(i.name==="accountsChanged"){let o=i.data;o&&vr(o)&&this.events.emit("accountsChanged",o.map(J6))}else if(i.name==="chainChanged"){let o=t.chainId,c=t.event.data,h=Ui(o),f=Eh(o)!==Eh(c)?`${h}:${Eh(c)}`:o;this.onChainChanged(f)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var i;let{namespaces:o}=t,c=(i=this.client)==null?void 0:i.session.get(e);this.session=Ih(ea({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",e=>m(this,null,function*(){yield this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Ih(ea({},Ye("USER_DISCONNECTED")),{data:e.topic}))})),this.on(Rr.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){let{namespaces:t,optionalNamespaces:i,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),i&&Object.keys(i).length&&(this.optionalNamespaces=i),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",i)}validateChain(e){let[t,i]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,i];if(t&&!Object.keys(this.namespaces||{}).map(h=>Ui(h)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&i)return[t,i];let o=Ui(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}requestAccounts(){return m(this,null,function*(){let[e]=this.validateChain();return yield this.getProvider(e).requestAccounts()})}onChainChanged(e,t=!1){var i;if(!this.namespaces)return;let[o,c]=this.validateChain(e);t||this.getProvider(o).setDefaultChain(c),((i=this.namespaces[o])!=null?i:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}cleanup(){return m(this,null,function*(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),yield this.cleanupPendingPairings({deletePairings:!0})})}persist(e,t){this.client.core.storage.setItem(`${mm}/${e}`,t)}getFromStore(e){return m(this,null,function*(){return yield this.client.core.storage.getItem(`${mm}/${e}`)})}},Pm=Lh;var rT="wc",iT="ethereum_provider",sT=`${rT}@2:${iT}:`,nT="https://rpc.walletconnect.com/v1/",jh=["eth_sendTransaction","personal_sign"],oT=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],qh=["chainChanged","accountsChanged"],aT=["chainChanged","accountsChanged","message","disconnect","connect"],cT=Object.defineProperty,uT=Object.defineProperties,hT=Object.getOwnPropertyDescriptors,Rm=Object.getOwnPropertySymbols,lT=Object.prototype.hasOwnProperty,fT=Object.prototype.propertyIsEnumerable,Om=(n,e,t)=>e in n?cT(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,nn=(n,e)=>{for(var t in e||(e={}))lT.call(e,t)&&Om(n,t,e[t]);if(Rm)for(var t of Rm(e))fT.call(e,t)&&Om(n,t,e[t]);return n},Tm=(n,e)=>uT(n,hT(e));function ra(n){return Number(n[0].split(":")[1])}function Fh(n){return`0x${n.toString(16)}`}function pT(n){let{chains:e,optionalChains:t,methods:i,optionalMethods:o,events:c,optionalEvents:h,rpcMap:f}=n;if(!vr(e))throw new Error("Invalid chains");let v={chains:e,methods:i||jh,events:c||qh,rpcMap:nn({},e.length?{[ra(e)]:f[ra(e)]}:{})},y=c?.filter(S=>!qh.includes(S)),g=i?.filter(S=>!jh.includes(S));if(!t&&!h&&!o&&!(y!=null&&y.length)&&!(g!=null&&g.length))return{required:e.length?v:void 0};let w=y?.length&&g?.length||!t,E={chains:[...new Set(w?v.chains.concat(t||[]):t)],methods:[...new Set(v.methods.concat(o!=null&&o.length?o:oT))],events:[...new Set(v.events.concat(h!=null&&h.length?h:aT))],rpcMap:f};return{required:e.length?v:void 0,optional:t.length?E:void 0}}var Mh=class n{constructor(){this.events=new Am.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=sT,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static init(e){return m(this,null,function*(){let t=new n;return yield t.initialize(e),t})}request(e){return m(this,null,function*(){return yield this.signer.request(e,this.formatChainId(this.chainId))})}sendAsync(e,t){this.signer.sendAsync(e,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}enable(){return m(this,null,function*(){return this.session||(yield this.connect()),yield this.request({method:"eth_requestAccounts"})})}connect(e){return m(this,null,function*(){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);let{required:t,optional:i}=pT(this.rpc);try{let o=yield new Promise((h,f)=>m(this,null,function*(){var v;this.rpc.showQrModal&&((v=this.modal)==null||v.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),yield this.signer.connect(Tm(nn({namespaces:nn({},t&&{[this.namespace]:t})},i&&{optionalNamespaces:{[this.namespace]:i}}),{pairingTopic:e?.pairingTopic})).then(y=>{h(y)}).catch(y=>{f(new Error(y.message))})}));if(!o)return;let c=wp(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:Fh(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}})}disconnect(){return m(this,null,function*(){this.session&&(yield this.signer.disconnect()),this.reset()})}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{let{params:t}=e,{event:i}=t;i.name==="accountsChanged"?(this.accounts=this.parseAccounts(i.data),this.events.emit("accountsChanged",this.accounts)):i.name==="chainChanged"?this.setChainId(this.formatChainId(i.data)):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{let t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",Fh(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Tm(nn({},Ye("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,i;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(i=this.modal)==null||i.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){let t=e.filter(i=>this.isCompatibleChainId(i)).map(i=>this.parseChainId(i));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",Fh(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){let t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){let[t,i,o]=e.split(":");return{chainId:`${t}:${i}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,i;let o=(t=e?.chains)!=null?t:[],c=(i=e?.optionalChains)!=null?i:[],h=o.concat(c);if(!h.length)throw new Error("No chains specified in either `chains` or `optionalChains`");let f=o.length?e?.methods||jh:[],v=o.length?e?.events||qh:[],y=e?.optionalMethods||[],g=e?.optionalEvents||[],w=e?.rpcMap||this.buildRpcMap(h,e.projectId),E=e?.qrModalOptions||void 0;return{chains:o?.map(S=>this.formatChainId(S)),optionalChains:c.map(S=>this.formatChainId(S)),methods:f,events:v,optionalMethods:y,optionalEvents:g,rpcMap:w,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:E,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){let i={};return e.forEach(o=>{i[o]=this.getRpcUrl(o,t)}),i}initialize(e){return m(this,null,function*(){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?ra(this.rpc.chains):ra(this.rpc.optionalChains),this.signer=yield Pm.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),yield this.loadPersistedSession(),this.rpc.showQrModal){let t;try{let{WalletConnectModal:i}=yield import("./chunk-HVMRU62E.js");t=i}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(nn({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(i){throw this.signer.logger.error(i),new Error("Could not generate WalletConnectModal Instance")}}})}loadConnectOpts(e){if(!e)return;let{chains:t,optionalChains:i,rpcMap:o}=e;t&&vr(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=o?.[c]||this.getRpcUrl(c)})),i&&vr(i)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=i?.map(c=>this.formatChainId(c)),i.forEach(c=>{this.rpc.rpcMap[c]=o?.[c]||this.getRpcUrl(c)}))}getRpcUrl(e,t){var i;return((i=this.rpc.rpcMap)==null?void 0:i[e])||`${nT}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}loadPersistedSession(){return m(this,null,function*(){if(!this.session)return;let e=yield this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t?.accounts),this.setAccounts(t?.accounts)})}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}},DA=Mh;export{DA as EthereumProvider,aT as OPTIONAL_EVENTS,oT as OPTIONAL_METHODS,qh as REQUIRED_EVENTS,jh as REQUIRED_METHODS,Mh as default};
