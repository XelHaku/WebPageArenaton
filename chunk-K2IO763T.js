var G=Symbol(),N=Symbol();var T=Object.getPrototypeOf,L=new WeakMap,_=s=>s&&(L.has(s)?L.get(s):T(s)===Object.prototype||T(s)===Array.prototype);var z=s=>_(s)&&s[N]||null,W=(s,a=!0)=>{L.set(s,a)};var K=s=>typeof s=="object"&&s!==null,p=new WeakMap,R=new WeakSet,$=(s=Object.is,a=(t,y)=>new Proxy(t,y),m=t=>K(t)&&!R.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer),O=t=>{switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t}},l=new WeakMap,u=(t,y,g=O)=>{let i=l.get(t);if(i?.[0]===y)return i[1];let f=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));return W(f,!0),l.set(t,[y,f]),Reflect.ownKeys(t).forEach(j=>{if(Object.getOwnPropertyDescriptor(f,j))return;let h=Reflect.get(t,j),P={value:h,enumerable:!0,configurable:!0};if(R.has(h))W(h,!1);else if(h instanceof Promise)delete P.value,P.get=()=>g(h);else if(p.has(h)){let[c,M]=p.get(h);P.value=u(c,M(),g)}Object.defineProperty(f,j,P)}),Object.preventExtensions(f)},b=new WeakMap,d=[1,1],A=t=>{if(!K(t))throw new Error("object required");let y=b.get(t);if(y)return y;let g=d[0],i=new Set,f=(n,r=++d[0])=>{g!==r&&(g=r,i.forEach(e=>e(n,r)))},j=d[1],h=(n=++d[1])=>(j!==n&&!i.size&&(j=n,c.forEach(([r])=>{let e=r[1](n);e>g&&(g=e)})),g),P=n=>(r,e)=>{let o=[...r];o[1]=[n,...o[1]],f(o,e)},c=new Map,M=(n,r)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&c.has(n))throw new Error("prop listener already exists");if(i.size){let e=r[3](P(n));c.set(n,[r,e])}else c.set(n,[r])},V=n=>{var r;let e=c.get(n);e&&(c.delete(n),(r=e[1])==null||r.call(e))},U=n=>(i.add(n),i.size===1&&c.forEach(([e,o],E)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&o)throw new Error("remove already exists");let v=e[3](P(E));c.set(E,[e,v])}),()=>{i.delete(n),i.size===0&&c.forEach(([e,o],E)=>{o&&(o(),c.set(E,[e]))})}),k=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t)),S=a(k,{deleteProperty(n,r){let e=Reflect.get(n,r);V(r);let o=Reflect.deleteProperty(n,r);return o&&f(["delete",[r],e]),o},set(n,r,e,o){let E=Reflect.has(n,r),v=Reflect.get(n,r,o);if(E&&(s(v,e)||b.has(e)&&s(v,b.get(e))))return!0;V(r),K(e)&&(e=z(e)||e);let D=e;if(e instanceof Promise)e.then(w=>{e.status="fulfilled",e.value=w,f(["resolve",[r],w])}).catch(w=>{e.status="rejected",e.reason=w,f(["reject",[r],w])});else{!p.has(e)&&m(e)&&(D=A(e));let w=!R.has(D)&&p.get(D);w&&M(r,w)}return Reflect.set(n,r,D,o),f(["set",[r],e,v]),!0}});b.set(t,S);let F=[k,h,u,U];return p.set(S,F),Reflect.ownKeys(t).forEach(n=>{let r=Object.getOwnPropertyDescriptor(t,n);"value"in r&&(S[n]=t[n],delete r.value,delete r.writable),Object.defineProperty(k,n,r)}),S})=>[A,p,R,s,a,m,O,l,u,b,d],[q]=$();function X(s={}){return q(s)}function Y(s,a,m){let O=p.get(s);(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!O&&console.warn("Please use proxy object");let l,u=[],b=O[3],d=!1,t=b(y=>{if(u.push(y),m){a(u.splice(0));return}l||(l=Promise.resolve().then(()=>{l=void 0,d&&a(u.splice(0))}))});return d=!0,()=>{d=!1,t()}}function Z(s,a){let m=p.get(s);(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!m&&console.warn("Please use proxy object");let[O,l,u]=m;return u(O,l(),a)}function x(s){return R.add(s),s}export{X as a,Y as b,Z as c,x as d};
